<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="hexo-theme" content="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.33.1" theme-name="Stellar" theme-version="1.33.1"><meta name="generator" content="Hexo 7.3.0"><meta http-equiv="x-dns-prefetch-control" content="on"><link rel="preconnect" href="https://gcore.jsdelivr.net" crossorigin><link rel="preconnect" href="https://unpkg.com" crossorigin><link rel="preconnect" href="https://cdn.bootcdn.net" crossorigin><meta name="renderer" content="webkit"><meta name="force-rendering" content="webkit"><meta http-equiv="X-UA-Compatible" content="IE=Edge,chrome=1"><meta name="HandheldFriendly" content="True"><meta name="mobile-web-app-capable" content="yes"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000"><meta name="theme-color" content="#f9fafb"><title>ERP系统开发实训笔记 - Sky Blog</title><meta name="description" content="ERP 系统开发实训笔记 笔记按照前后端的实现时间编写  代码开源地址 前端：客户管理系统前端 后端：客户管理系统后端  Day1 环境初始化  后端搭建  1.项目环境搭建 1）idea 初始化 类型选择 Maven，jdk 选 17 idea 可以自动安装 Java 包，不要去手动下载 . 下面这个 Springboot 要求选择 3.0.2！！！ . 2）依赖下载 下载太慢了？看这个配置阿"><meta property="og:type" content="website"><meta property="og:title" content="ERP系统开发实训笔记"><meta property="og:url" content="http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0/"><meta property="og:site_name" content="Sky Blog"><meta property="og:description" content="ERP 系统开发实训笔记 笔记按照前后端的实现时间编写  代码开源地址 前端：客户管理系统前端 后端：客户管理系统后端  Day1 环境初始化  后端搭建  1.项目环境搭建 1）idea 初始化 类型选择 Maven，jdk 选 17 idea 可以自动安装 Java 包，不要去手动下载 . 下面这个 Springboot 要求选择 3.0.2！！！ . 2）依赖下载 下载太慢了？看这个配置阿"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2025-05-12T14:32:26.000Z"><meta property="article:modified_time" content="2025-05-12T14:32:26.000Z"><meta property="article:author" content="Skyforever"><meta property="article:tag" content="软件开发&#x2F;项目实训"><meta name="twitter:card" content="summary"><meta name="keywords" content=""><link rel="stylesheet" href="/css/main.css?v=1.33.1"><link rel="shortcut icon" href="https://image.skyforever.top/blog/2025/08/c25707b5a37360e74c54764d71d1724c.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Website","@id":"http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0/","author":{"@type":"Person","name":"Skyforever","sameAs":[]},"name":"ERP系统开发实训笔记","description":" ERP 系统开发实训笔记\n笔记按照前后端的实现时间编写\n 代码开源地址\n前端：客户管理系统前端\n后端：客户管理系统后端\n Day1 环境初始化\n 后端搭建\n 1.项目环境搭建\n1）idea 初始化\n类型选择 Maven，jdk 选 17\nidea 可以自动安装 Java 包，不要去手动下载\n.\n下面这个 Springboot 要求选择 3.0.2！！！\n.\n2）依赖下载\n下载太慢了？看这个...","url":"http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0/"}</script></head><body><div class="l_body content" id="start" layout="page" type="tech"><aside class="l_left"><div class="sidebg"></div><div class="leftbar-container"><header class="header"><div class="logo-wrap"><div class="icon"><img no-lazy class="icon" src="/images/icons/cloud.png" onerror="javascript:this.classList.add('error');this.src='https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/image/2659360.svg';"></div><a class="title" href="/"><div class="main">Sky Blog</div><div class="sub normal cap">记录走下的每一步</div><div class="sub hover cap" style="opacity:0">Write by Skyforever</div></a></div></header><div class="nav-area"><nav class="menu dis-select"><a class="nav-item" title="博客" href="/"><span>博客</span></a><a class="nav-item" title="项目" href="/wiki/"><span>项目</span></a><a class="nav-item" title="笔记" href="/notebooks/"><span>笔记</span></a></nav></div><div class="widgets"><div class="search-wrapper" id="search-wrapper"><form class="search-form"><a class="search-button" onclick="document.getElementById(&quot;search-input&quot;).focus();"><svg t="1705074644177" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1560" width="200" height="200"><path d="M1008.839137 935.96571L792.364903 719.491476a56.783488 56.783488 0 0 0-80.152866 0 358.53545 358.53545 0 1 1 100.857314-335.166073 362.840335 362.840335 0 0 1-3.689902 170.145468 51.248635 51.248635 0 1 0 99.217358 26.444296 462.057693 462.057693 0 1 0-158.255785 242.303546l185.930047 185.725053a51.248635 51.248635 0 0 0 72.568068 0 51.248635 51.248635 0 0 0 0-72.978056z" p-id="1561"></path><path d="M616.479587 615.969233a50.428657 50.428657 0 0 0-61.498362-5.534852 174.655348 174.655348 0 0 1-177.525271 3.484907 49.403684 49.403684 0 0 0-58.833433 6.76482l-3.074918 2.869923a49.403684 49.403684 0 0 0 8.609771 78.10292 277.767601 277.767601 0 0 0 286.992355-5.739847 49.403684 49.403684 0 0 0 8.404776-76.667958z" p-id="1562"></path></svg></a><input type="text" class="search-input" id="search-input" data-filter="/note/college" placeholder="在 大学 中搜索"></form><div id="search-result"></div><div class="search-no-result">没有找到内容！</div></div><widget class="widget-wrapper post-list"><div class="widget-header dis-select"><span class="name">标签</span></div><div class="widget-body fs14 tag-tree"><div class="tag-subtree leaf-tag expanded" data-tag=""><a class="link" href="/note/college/"><span class="toc-text">所有笔记 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree parent-tag expanded" data-tag="编程语言"><a class="link" href="/note/college/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/"><span class="toc-text"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>编程语言 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a><div class="tag-subtree leaf-tag expanded" data-tag="编程语言/c++"><a class="link" href="/note/college/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/c++/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>C++ </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree leaf-tag expanded" data-tag="编程语言/c语言"><a class="link" href="/note/college/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/c%E8%AF%AD%E8%A8%80/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>C语言 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree leaf-tag expanded" data-tag="编程语言/java"><a class="link" href="/note/college/tags/%E7%BC%96%E7%A8%8B%E8%AF%AD%E8%A8%80/java/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>Java </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div></div><div class="tag-subtree parent-tag expanded" data-tag="计算机科学"><a class="link" href="/note/college/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/"><span class="toc-text"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>计算机科学 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a><div class="tag-subtree leaf-tag expanded" data-tag="计算机科学/操作系统"><a class="link" href="/note/college/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>操作系统 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree leaf-tag expanded" data-tag="计算机科学/数据库"><a class="link" href="/note/college/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>数据库 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree leaf-tag expanded" data-tag="计算机科学/计算机网络"><a class="link" href="/note/college/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>计算机网络 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div><div class="tag-subtree leaf-tag expanded" data-tag="计算机科学/认证考试"><a class="link" href="/note/college/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%A7%91%E5%AD%A6/%E8%AE%A4%E8%AF%81%E8%80%83%E8%AF%95/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>认证考试 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div></div><div class="tag-subtree parent-tag expanded" data-tag="软件开发"><a class="link" href="/note/college/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/"><span class="toc-text"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>软件开发 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a><div class="tag-subtree leaf-tag expanded" data-tag="软件开发/项目实训"><a class="link" href="/note/college/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%AE%AD/"><span class="toc-text" style="padding-left:.875rem"><span class="tagcon"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="currentColor" d="m14.092 10.75l-.75 2.5H9.908l.75-2.5z"/><path fill="currentColor" fill-rule="evenodd" d="M3.464 3.464C2 4.93 2 7.286 2 12s0 7.071 1.464 8.535C4.93 22 7.286 22 12 22s7.071 0 8.535-1.465C22 19.072 22 16.714 22 12s0-7.071-1.465-8.536C19.072 2 16.714 2 12 2S4.929 2 3.464 3.464m7.752 2.818a.75.75 0 0 1 .502.934l-.61 2.034h3.434l.74-2.465a.75.75 0 0 1 1.436.43l-.61 2.035H18a.75.75 0 0 1 0 1.5h-2.342l-.75 2.5H17a.75.75 0 0 1 0 1.5h-2.542l-.74 2.465a.75.75 0 0 1-1.436-.43l.61-2.035H9.458l-.74 2.465a.75.75 0 1 1-1.436-.43l.61-2.035H6a.75.75 0 0 1 0-1.5h2.342l.75-2.5H7a.75.75 0 0 1 0-1.5h2.542l.74-2.465a.75.75 0 0 1 .934-.503" clip-rule="evenodd"/></svg></span>项目实训 </span><span class="toc-text tag-switcher-wrapper"><span class="tag-switcher"></span></a></div></div></div></widget><widget class="widget-wrapper recent post-list"><div class="widget-header dis-select"><span class="name">最近更新</span></div><div class="widget-body fs14"><a class="item title" href="/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0/"><span class="title">ERP系统开发实训笔记</span></a><a class="item title" href="/data/notebooks/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BA%8C%E7%BA%A7%E5%85%AC%E5%85%B1%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E7%82%B9%E8%80%83%E7%82%B9%E6%95%B4%E7%90%86/"><span class="title">计算机二级公共基础知识点考点整理</span></a><a class="item title" href="/data/notebooks/%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%BA%8C%E7%BA%A7C%E8%AF%AD%E8%A8%80%E5%A4%8D%E4%B9%A0/"><span class="title">计算机二级C语言复习</span></a><a class="item title" href="/data/notebooks/C++%E5%A4%8D%E4%B9%A0/"><span class="title">C++复习</span></a><a class="item title" href="/data/notebooks/%E5%8D%8E%E4%B8%BAICT%E7%BD%91%E7%BB%9C%E8%B5%9B%E9%81%93%E5%88%9D%E7%BA%A7%E7%9F%A5%E8%AF%86%E7%82%B9%E6%B1%87%E6%80%BB%E7%AC%94%E8%AE%B0/"><span class="title">华为ICT网络赛道初级知识点汇总笔记</span></a><a class="item title" href="/data/notebooks/Java%E5%A4%8D%E4%B9%A0/"><span class="title">Java复习</span></a><a class="item title" href="/data/notebooks/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%A4%8D%E4%B9%A0/"><span class="title">数据库复习</span></a><a class="item title" href="/data/notebooks/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%85%A5%E9%97%A8/"><span class="title">操作系统入门</span></a></div></widget></div><footer class="footer dis-select"><div class="social-wrap"><a class="social" href="https://github.com/zhangwei43721" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/08a41b181ce68.svg"></a><a class="social" href="https://music.163.com/#/user/home?id=1654800754" target="_blank" rel="external nofollow noopener noreferrer"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/3845874.svg"></a></div></footer></div></aside><div class="l_main" id="main"><div class="article banner top"><div class="content"><div class="top bread-nav footnote"><div class="left"><div class="flex-row" id="breadcrumb"><a class="cap breadcrumb" href="/">主页</a> <span class="sep"></span> <a class="cap breadcrumb" href="/notebooks/">笔记本</a> <span class="sep"></span> <a class="cap breadcrumb" href="/note/college/">大学</a></div><div class="flex-row" id="post-meta"><span class="text created">更新于：<time datetime="2025-05-12T14:32:26.000Z">2025-05-12</time></span><span class="sep updated"></span><span class="text updated">发布于：<time datetime="2025-05-12T14:32:26.000Z">2025-05-12</time></span></div></div></div><div class="bottom only-title"><div class="text-area"><h1 class="text title"><span>ERP系统开发实训笔记</span></h1></div></div></div></div><article class="md-text content"><h1 id="erp-系统开发实训笔记"><a class="markdownIt-Anchor" href="#erp-系统开发实训笔记"></a> ERP 系统开发实训笔记</h1><p>笔记按照前后端的实现时间编写</p><h2 id="代码开源地址"><a class="markdownIt-Anchor" href="#代码开源地址"></a> 代码开源地址</h2><p><strong>前端</strong>：<a target="_blank" rel="noopener" href="https://github.com/zhangwei43721/erpfront">客户管理系统前端</a></p><p><strong>后端：</strong><a target="_blank" rel="noopener" href="https://github.com/zhangwei43721/erpfront-Api">客户管理系统后端</a></p><h2 id="day1-环境初始化"><a class="markdownIt-Anchor" href="#day1-环境初始化"></a> Day1 环境初始化</h2><h3 id="后端搭建"><a class="markdownIt-Anchor" href="#后端搭建"></a> 后端搭建</h3><h4 id="1项目环境搭建"><a class="markdownIt-Anchor" href="#1项目环境搭建"></a> 1.项目环境搭建</h4><p><strong>1）idea 初始化</strong></p><p>类型选择 Maven，jdk 选 17</p><p>idea 可以自动安装 Java 包，不要去手动下载</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512110354082.webp" alt="image-20250512110354082" style="zoom:50%">.</p><p><strong>下面这个 Springboot 要求选择 3.0.2</strong>！！！</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512105214481.webp" alt="image-20250512105214481" style="zoom:50%">.</p><p><strong>2）依赖下载</strong></p><p>下载太慢了？看这个配置阿里云镜像的教程，不要像老师一样手动安装配置 maven</p><p><a target="_blank" rel="noopener" href="https://developer.aliyun.com/article/1122553">IDEA 自带 Maven 添加阿里镜像</a></p><p><strong>3）配置工程</strong></p><p>application.properties 文件配置如下</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">spring.application.name=demo</span></span><br><span class="line"><span class="comment"># 应用服务web访问端口</span></span><br><span class="line"><span class="string">server.port=8080</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># mysql信息</span></span><br><span class="line"><span class="string">spring.datasource.url=jdbc:mysql://localhost:3306/erp?useUnicode=true&amp;characterEncoding=utf8&amp;serverTimezone=UTC</span></span><br><span class="line"><span class="string">spring.datasource.username=root</span></span><br><span class="line"><span class="string">spring.datasource.password=134679</span></span><br><span class="line"><span class="string">spring.datasource.driver-class-name=com.mysql.cj.jdbc.Driver</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 指定mybatis的mapper文件 (XML文件路径)</span></span><br><span class="line"><span class="string">mybatis.mapper-locations=classpath*:mapper/**/*Mapper.xml</span></span><br><span class="line"><span class="comment"># 或者如果您使用Java配置Mapper (指定Mapper接口所在的包)</span></span><br><span class="line"><span class="comment"># mybatis.type-aliases-package=com.example.demo.mapper</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># MyBatis 日志配置</span></span><br><span class="line"><span class="string">mybatis.configuration.log-impl=org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure><p><strong>4）配置 Maven</strong></p><p>确保 pom.xml 有以下依赖：</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- web --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 数据库驱动 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- lombok --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 测试 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mybatis测试 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis.spring.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.0.4<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- mysql驱动 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.33<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--mybatisPlus--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.5.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>5）安装插件</strong></p><p><a target="_blank" rel="noopener" href="https://www.jb51.net/program/287643222.htm">IDEA 插件之 mybatisx 插件使用教程</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/alisystemsoftware/p/18828097">如何在 IntelliJ IDEA 中安装通义灵码 - AI 编程助手提升开发效率</a></p><p><strong>6）中文乱码问题</strong></p><p>直接在文件-设置里搜索 utf-8，把文件编码的三个位置都调成 utf-8 就行</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512115826612.webp" alt="image-20250512115826612" style="zoom:50%">.</p><h4 id="2配置数据库"><a class="markdownIt-Anchor" href="#2配置数据库"></a> 2.配置数据库</h4><p>先<a target="_blank" rel="noopener" href="https://www.cnblogs.com/qingmuchuanqi48/p/11541477.html">使用 navicat 创建数据库</a></p><p>往数据库里新建以下表，这些表是需求分析后分析出来的</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_after_sales` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;服务单号 (主键)&#x27;</span>,</span><br><span class="line">  `cust_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;关联的客户ID (关联t_customer.id)&#x27;</span>,</span><br><span class="line">  `question` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后问题类型或简述&#x27;</span>,</span><br><span class="line">  `state` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后处理状态 (如：待处理、处理中、已解决)&#x27;</span>,</span><br><span class="line">  `record` <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后处理过程或回访记录详情&#x27;</span>,</span><br><span class="line">  `level` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;问题严重性或优先级 (可用于内部评估)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;售后服务记录表 (客户服务)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_customer` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;客户ID (主键)&#x27;</span>,</span><br><span class="line">  `cust_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户名称或公司名称&#x27;</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户联系地址&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户联系电话&#x27;</span>,</span><br><span class="line">  `cust_type` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户类型或分组 (如：所属行业、区域)&#x27;</span>,</span><br><span class="line">  `grade` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户等级 (评估客户价值)&#x27;</span>,</span><br><span class="line">  `his_total` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;历史交易总额 (用于客户价值分析)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">6</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;客户信息表 (客户档案)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_item` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;商品ID (主键)&#x27;</span>,</span><br><span class="line">  `item_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品名称&#x27;</span>,</span><br><span class="line">  `price` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品单价&#x27;</span>,</span><br><span class="line">  `item_date` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品生产日期或上架日期&#x27;</span>,</span><br><span class="line">  `hot_title` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;促销活动标题或描述&#x27;</span>,</span><br><span class="line">  `facturer` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;生产厂家或品牌商&#x27;</span>,</span><br><span class="line">  `store` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品当前库存数量&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;商品信息表 (产品库)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_menu` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID (主键)&#x27;</span>,</span><br><span class="line">  `label` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;导航名称&#x27;</span>,</span><br><span class="line">  `component` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;子id&#x27;</span>,</span><br><span class="line">  `pid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;父id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">10</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;前端菜单表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_order` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;订单ID (主键)&#x27;</span>,</span><br><span class="line">  `cust_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;下单客户ID (关联t_customer.id)&#x27;</span>,</span><br><span class="line">  `item_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;购买的商品ID (关联t_item.id)&#x27;</span>,</span><br><span class="line">  `order_date` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单创建日期和时间&#x27;</span>,</span><br><span class="line">  `state` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单状态 (如：待付款、待发货、已完成)&#x27;</span>,</span><br><span class="line">  `pay` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;支付方式 (如：支付宝、微信、银行卡)&#x27;</span>,</span><br><span class="line">  `pay_money` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单实际支付金额&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;订单信息表 (交易记录)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_sell_jh` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;机会或计划ID (主键)&#x27;</span>,</span><br><span class="line">  `custid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;关联的客户ID&#x27;</span>,</span><br><span class="line">  `channel_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;销售机会来源渠道ID (可关联渠道表)&#x27;</span>,</span><br><span class="line">  `money` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;预计成交金额&#x27;</span>,</span><br><span class="line">  `now_step` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;当前销售阶段 (如：初步接触、报价、签约)&#x27;</span>,</span><br><span class="line">  `emp_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;负责该机会的销售员工ID&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">14</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;销售机会/计划表 (销售过程管理)&#x27;</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>然后在 idea 里新加一个数据源</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512141132624.webp" alt="image-20250512141132624" style="zoom:50%">.</p><p>填写用户名，密码，数据库名</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512141232466.webp" alt="image-20250512141232466" style="zoom:50%">.</p><h4 id="3用-mybatiesx-生成三个层级代码"><a class="markdownIt-Anchor" href="#3用-mybatiesx-生成三个层级代码"></a> 3.用 mybatiesx 生成三个层级代码</h4><p>使用步骤：</p><p>1、安装 MybatisX 插件；<a target="_blank" rel="noopener" href="https://www.jb51.net/program/287643222.htm">IDEA 插件之 mybatisx 插件使用教程</a></p><p>2、idea 的 database 连接数据库；</p><p>3、数据库表上右键，点击 MybatisX-Generator；</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/2e4b4c348bc99d985c2374e784a033a1.webp" alt="mybaties">。</p><p>4、 进行生成代码的配置，按自己的项目项目修改如图三个位置的路径，配置完成后点击 Next</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512153234110.webp" alt="image-20250512153234110" style="zoom:50%">.</p><p>下面是老师的截图：</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/ca7e5585b088d1b49373f7bc82125089.webp" alt="image-20250512203334327">.</p><p>5.按照下面的截图调整</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512153434395.webp" alt="image-20250512153434395" style="zoom:67%">.</p><p>6.运行代码，看有什么问题</p><p>注意启动类要添加扫描 mapper 的代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@MapperScan(&quot;com.example.demo.mapper&quot;)</span><span class="comment">//添加这句话</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DemoApplication</span> &#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        SpringApplication.run(DemoApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="4写测试代码测试增删改查是否正常"><a class="markdownIt-Anchor" href="#4写测试代码测试增删改查是否正常"></a> 4.写测试代码测试增删改查是否正常</h4><p><strong>1）mapper 测试</strong></p><p>右键括号内-&gt;生成-&gt;测试</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512221906921.webp" alt="image-20250512221906921" style="zoom:50%">.</p><p>就会生成对应测试，修改对应测试方法即可</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/059560d2646fee70dc8f4fe8df32a400.webp" alt="image-20250512222029620">.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.update.UpdateWrapper;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserMapperTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*添加用户信息*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setUsername(<span class="string">&quot;testUser&quot;</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;test@example.com&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;password123&quot;</span>);</span><br><span class="line">        userMapper.insert(user);</span><br><span class="line">        userId = user.getId();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*查询单条用户信息*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getOne</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userMapper.selectById(userId);</span><br><span class="line">        System.out.println(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*查询用户集合*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getList</span><span class="params">()</span> &#123;</span><br><span class="line">        UpdateWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;testUser&quot;</span>);</span><br><span class="line">        List&lt;User&gt; users = userMapper.selectList(wrapper);</span><br><span class="line">        <span class="keyword">for</span> (User u : users) &#123;</span><br><span class="line">            System.out.println(u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*修改用户信息*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateUser</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(userId);</span><br><span class="line">        user.setUsername(<span class="string">&quot;updatedUser&quot;</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;updated@example.com&quot;</span>);</span><br><span class="line">        userMapper.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*删除用户信息*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUser</span><span class="params">()</span> &#123;</span><br><span class="line">        userMapper.deleteById(userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2）service 测试</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.core.conditions.query.QueryWrapper;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.pojo.User;</span><br><span class="line"><span class="keyword">import</span> org.junit.jupiter.api.Test;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.boot.test.context.SpringBootTest;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">UserServiceTest</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer userId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">contextLoads</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*测试数据库添加*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">saveUserService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setUsername(<span class="string">&quot;testUser&quot;</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;test@example.com&quot;</span>);</span><br><span class="line">        user.setPhone(<span class="string">&quot;1234567890&quot;</span>);</span><br><span class="line">        user.setPassword(<span class="string">&quot;password123&quot;</span>);</span><br><span class="line">        userService.saveOrUpdate(user);</span><br><span class="line">        userId = user.getId();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*测试单条查询*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getOneService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> userService.getById(userId);</span><br><span class="line">        System.out.println(<span class="string">&quot;user=&quot;</span> + user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*测试多条查询*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">getListService</span><span class="params">()</span> &#123;</span><br><span class="line">        QueryWrapper&lt;User&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;username&quot;</span>, <span class="string">&quot;testUser&quot;</span>);</span><br><span class="line">        List&lt;User&gt; list = userService.list(wrapper);</span><br><span class="line">        <span class="keyword">for</span> (User u : list) &#123;</span><br><span class="line">            System.out.println(u);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*测试修改*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">updateUserService</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">User</span> <span class="variable">user</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line">        user.setId(userId);</span><br><span class="line">        user.setUsername(<span class="string">&quot;updatedUser&quot;</span>);</span><br><span class="line">        user.setEmail(<span class="string">&quot;updated@example.com&quot;</span>);</span><br><span class="line">        userService.updateById(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*测试删除*/</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteUserService</span><span class="params">()</span> &#123;</span><br><span class="line">        userService.removeById(userId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="5实现基本代码"><a class="markdownIt-Anchor" href="#5实现基本代码"></a> 5.实现基本代码</h4><p><strong>1）对客户管理系统做需求分析，写出以下表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_after_sales` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;服务单号 (主键)&#x27;</span>,</span><br><span class="line">  `cust_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;关联的客户ID (关联t_customer.id)&#x27;</span>,</span><br><span class="line">  `question` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后问题类型或简述&#x27;</span>,</span><br><span class="line">  `state` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后处理状态 (如：待处理、处理中、已解决)&#x27;</span>,</span><br><span class="line">  `record` <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;售后处理过程或回访记录详情&#x27;</span>,</span><br><span class="line">  `level` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;问题严重性或优先级 (可用于内部评估)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;售后服务记录表 (客户服务)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_customer` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;客户ID (主键)&#x27;</span>,</span><br><span class="line">  `cust_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户名称或公司名称&#x27;</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户联系地址&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户联系电话&#x27;</span>,</span><br><span class="line">  `cust_type` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户类型或分组 (如：所属行业、区域)&#x27;</span>,</span><br><span class="line">  `grade` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;客户等级 (评估客户价值)&#x27;</span>,</span><br><span class="line">  `his_total` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;历史交易总额 (用于客户价值分析)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;客户信息表 (客户档案)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_item` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;商品ID (主键)&#x27;</span>,</span><br><span class="line">  `item_name` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品名称&#x27;</span>,</span><br><span class="line">  `price` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品单价&#x27;</span>,</span><br><span class="line">  `item_date` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品生产日期或上架日期&#x27;</span>,</span><br><span class="line">  `hot_title` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;促销活动标题或描述&#x27;</span>,</span><br><span class="line">  `facturer` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;生产厂家或品牌商&#x27;</span>,</span><br><span class="line">  `store` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品当前库存数量&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;商品信息表 (产品库)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_order` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;订单ID (主键)&#x27;</span>,</span><br><span class="line">  `cust_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;下单客户ID (关联t_customer.id)&#x27;</span>,</span><br><span class="line">  `item_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;购买的商品ID (关联t_item.id)&#x27;</span>,</span><br><span class="line">  `order_date` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单创建日期和时间&#x27;</span>,</span><br><span class="line">  `state` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单状态 (如：待付款、待发货、已完成)&#x27;</span>,</span><br><span class="line">  `pay` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;支付方式 (如：支付宝、微信、银行卡)&#x27;</span>,</span><br><span class="line">  `pay_money` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;订单实际支付金额&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;订单信息表 (交易记录)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_sell_jh` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;机会或计划ID (主键)&#x27;</span>,</span><br><span class="line">  `custid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;关联的客户ID&#x27;</span>,</span><br><span class="line">  `channel_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;销售机会来源渠道ID (可关联渠道表)&#x27;</span>,</span><br><span class="line">  `money` <span class="keyword">double</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;预计成交金额&#x27;</span>,</span><br><span class="line">  `now_step` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;当前销售阶段 (如：初步接触、报价、签约)&#x27;</span>,</span><br><span class="line">  `emp_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;负责该机会的销售员工ID&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;销售机会/计划表 (销售过程管理)&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>2）在数据库里创建以上表后，再去 idea 里通过 mybatiesx 生成表格对应的增删改查代码</strong></p><h3 id="上面学了什么内容"><a class="markdownIt-Anchor" href="#上面学了什么内容"></a> 上面学了什么内容？</h3><p>指导你如何从零开始搭建一个基于 <strong>Spring Boot</strong> 框架的后端 Java 项目，并使用 <strong>MyBatis-Plus</strong> 作为数据访问层框架，连接 <strong>MySQL</strong> 数据库</p><h4 id="mybatis-plus-代码用法"><a class="markdownIt-Anchor" href="#mybatis-plus-代码用法"></a> <strong>MyBatis-Plus 代码用法</strong></h4><ol><li><p><strong>Mapper 层 (<code>UserMapper</code>)：</strong></p><ul><li>MyBatis-Plus 会为你的每个数据库表生成一个对应的 Mapper 接口（例如 <code>UserMapper</code> 对应 <code>t_user</code> 表，尽管 <code>t_user</code> 表的创建 SQL 未在文档中给出，但测试代码中使用了 <code>User</code> 类和 <code>UserMapper</code>，可以推断）。</li><li>这个 Mapper 接口通常会继承 MyBatis-Plus 提供的 <code>BaseMapper&lt;Entity&gt;</code> 接口，这里的 <code>Entity</code> 就是对应数据库表的 Java 类（例如 <code>User</code>）。</li><li>通过继承 <code>BaseMapper</code>，你的 Mapper 接口会<strong>自动拥有</strong>许多常用的 CRUD 方法，你无需自己编写这些方法的 SQL。</li><li>文档中 <code>UserMapperTest</code> 测试代码展示了如何使用这些自动拥有的方法：<ul><li><code>userMapper.insert(user)</code>: <strong>插入</strong>一条数据到数据库。</li><li><code>userMapper.selectById(userId)</code>: 根据主键 ID <strong>查询</strong>单条数据。</li><li><code>userMapper.selectList(wrapper)</code>: 根据条件 <strong>查询</strong>多条数据。这里的 <code>wrapper</code> (如 <code>UpdateWrapper</code> 或 <code>QueryWrapper</code>) 是 MyBatis-Plus 提供的用于构建查询条件的工具。</li><li><code>userMapper.updateById(user)</code>: 根据 Entity 对象的主键 ID <strong>更新</strong>数据。</li><li><code>userMapper.deleteById(userId)</code>: 根据主键 ID <strong>删除</strong>数据。</li></ul></li><li><strong>核心用法：</strong> 你不再需要写 XML 文件或注解来定义基本的 CRUD SQL，直接调用继承自 <code>BaseMapper</code> 的方法即可完成数据库操作。</li></ul></li><li><p><strong>Service 层 (<code>UserService</code>)：</strong></p><ul><li>MyBatis-Plus 同样提供了一个 <code>IService&lt;Entity&gt;</code> 接口。MyBatisX 插件通常会生成一个对应的 Service 接口（例如 <code>UserService</code>）和其实现类（例如 <code>UserServiceImpl</code>），Service 接口通常会继承 <code>IService&lt;Entity&gt;</code>。</li><li>Service 层封装了更高级的业务逻辑，它可能会调用一个或多个 Mapper 方法来完成一个更复杂的业务操作。</li><li>继承 <code>IService</code> 后，你的 Service 接口会<strong>自动拥有</strong>许多常用的 Service 层方法，它们底层调用了对应的 Mapper 方法，并可能包含事务管理等功能。</li><li>文档中 <code>UserServiceTest</code> 测试代码展示了如何使用这些方法：<ul><li><code>userService.saveOrUpdate(user)</code>: 保存或更新数据。如果 <code>user</code> 对象有 ID 则更新，没有 ID 则插入。</li><li><code>userService.getById(userId)</code>: 根据 ID 查询单条数据。</li><li><code>userService.list(wrapper)</code>: 根据条件查询多条数据。</li><li><code>userService.updateById(user)</code>: 根据 ID 更新数据。</li><li><code>userService.removeById(userId)</code>: 根据 ID 删除数据。</li></ul></li><li><strong>核心用法：</strong> Service 层提供了比 Mapper 层更高层级的操作方法，通常用于处理业务逻辑，MyBatis-Plus 也为 Service 层提供了很多基础方法，进一步简化了开发。</li></ul></li></ol><h4 id="后端代码分层解释"><a class="markdownIt-Anchor" href="#后端代码分层解释"></a> 后端代码分层解释</h4><ol><li><strong>Entity 层 (也被称为 POJO 层 或 Domain 层)</strong><ul><li><strong>功能：</strong> 这一层包含对应数据库表的 Java 类（例如文档中测试代码里的 <code>User</code> 类）。每个类的属性对应数据库表的字段。这些类主要用于<strong>封装数据</strong>，在不同的层之间传递数据。它们通常是简单的 Java Bean，包含私有属性和公有的 getter/setter 方法（使用 Lombok 注解的**@Data**可以进一步简化这些）。</li><li><strong>文档中的体现：</strong> 测试代码中出现了 <code>com.example.demo.pojo.User</code> 类，这就是 Entity 层的一个例子。</li></ul></li><li><strong>Mapper 层 (也被称为 DAO 层 - Data Access Object)</strong><ul><li><strong>功能：</strong> 这一层是<strong>数据访问层</strong>，直接负责与数据库进行交互。它定义了对数据库执行各种操作的方法（如插入、删除、更新、查询）。MyBatis-Plus 的 Mapper 接口通常继承 <code>BaseMapper</code>，从而自动获得基础的 CRUD 能力。这个层只关注<strong>如何存取数据</strong>，不包含业务逻辑。</li><li><strong>文档中的体现：</strong> <code>UserMapperTest</code> 使用了 <code>UserMapper</code> 接口，并调用了它的方法。 <code>@MapperScan(&quot;com.example.demo.mapper&quot;)</code> 也表明存在一个 <code>mapper</code> 包存放 Mapper 接口。</li></ul></li><li><strong>Service 层</strong><ul><li><strong>功能：</strong> 这一层是<strong>业务逻辑层</strong>。它封装了具体的业务处理流程。Service 层的方法会调用一个或多个 Mapper 层的方法来完成一个完整的业务功能。例如，“注册用户”这个业务可能需要先调用 Mapper 插入用户数据，然后调用另一个 Mapper 插入用户的默认设置。Service 层是协调数据访问和实现业务规则的地方。它不直接与数据库交互，而是通过调用 Mapper 来实现。MyBatis-Plus 的 Service 接口通常继承 <code>IService</code>，提供了一些常用的业务方法。</li><li><strong>文档中的体现：</strong> <code>UserServiceTest</code> 使用了 <code>UserService</code> 接口，并调用了它的方法。这表明存在一个 Service 层来处理用户相关的业务操作。</li></ul></li></ol><p><strong>4. Controller 层 (也被称为 Web 层)</strong></p><ul><li><strong>功能：</strong> 这一层是应用程序的<strong>入口点</strong>，直接处理来自客户端（比如浏览器、手机 App、其他服务）的 HTTP 请求。<ul><li>它负责接收请求参数。</li><li>它根据请求的 URL 找到对应的处理方法。</li><li>它调用 <strong>Service 层</strong>的方法来执行具体的业务逻辑。</li><li>它处理 Service 层返回的结果。</li><li>它准备并返回响应给客户端（通常是 JSON 格式的数据，或者是一个网页）。</li><li><strong>重要的原则是：</strong> Controller 层应该尽可能“薄”，它只负责接收请求、调用 Service、返回响应，<strong>不应该包含复杂的业务逻辑</strong>。业务逻辑应该全部放在 Service 层。</li></ul></li></ul><h3 id="前端搭建"><a class="markdownIt-Anchor" href="#前端搭建"></a> 前端搭建</h3><h4 id="1安装-nodejs"><a class="markdownIt-Anchor" href="#1安装-nodejs"></a> 1.安装 Node.js</h4><p>下载地址：<a target="_blank" rel="noopener" href="https://nodejs.cn/en/download">下载 Node.js-Node.js 中文网</a></p><p><strong>1）配置镜像</strong></p><p>参考：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/hopeblaze/articles/18605774">npm 最新国内镜像源设置 2025</a></p><ol><li><p>以管理员身份进入命令窗口。</p></li><li><p>执行以下命令为 npm 配置国内镜像：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></li><li><p>命令执行完毕后，可用以下命令检测配置：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure></li></ol><p><strong>2）安装 Vue 脚手架</strong></p><p>执行以下命令全局安装 Vue CLI：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g @vue/cli</span><br></pre></td></tr></table></figure><blockquote><p>[!CAUTION]</p><p>如果安装失败，需要关掉终端再进入，才能让镜像配置生效</p></blockquote><p><strong>3）创建 Vue 工程</strong></p><ol><li><p>进入到工程所在的目录。</p></li><li><p>执行以下命令创建 Vue 项目，注意 projectName 改为你的前端项目名：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vue create erpfront</span><br></pre></td></tr></table></figure></li><li><p>选择第三个手动配置</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/258ad63eb422190912f35c6527536fa9.webp" alt="image-20250513101516892"></p></li><li><p><strong>按下空格</strong>选择 router，取消选择 liner，按 enter 进行下一步<img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/19066f71c1069150fe3ee3bc68aabf88.webp" alt="image-20250513101557175"></p></li><li><p>版本选择 3.x，询问 y/n 全部填 n</p></li><li><p>这个位置选择最后一个</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/f163b879aec79f0a87cb1a1e5cad10a2.webp" alt="image-20250513101834113"></p></li></ol><h4 id="2根据工程下面的-readme-文档启动项目"><a class="markdownIt-Anchor" href="#2根据工程下面的-readme-文档启动项目"></a> 2.根据工程下面的 readme 文档启动项目</h4><p>运行这两个命令</p><p><strong>1）安装依赖</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn install</span><br></pre></td></tr></table></figure><p><strong>2）编译并启动开发服务器</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yarn serve</span><br></pre></td></tr></table></figure><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250512212219711.webp" alt="image-20250512212219711" style="zoom:50%">.</p><h4 id="3配置需要的包"><a class="markdownIt-Anchor" href="#3配置需要的包"></a> 3.配置需要的包</h4><p><strong>1）安装 element-plus</strong></p><p><a target="_blank" rel="noopener" href="https://element-plus.org/zh-CN/guide/installation.html#%E4%BD%BF%E7%94%A8%E5%8C%85%E7%AE%A1%E7%90%86%E5%99%A8">官方文档-安装教程</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install element-plus --save</span><br></pre></td></tr></table></figure><p><strong>2）安装 axios</strong></p><p><a target="_blank" rel="noopener" href="https://www.axios-http.cn/docs/intro">axios 官方文档</a></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install axios</span><br></pre></td></tr></table></figure><h3 id="上面学了什么内容-2"><a class="markdownIt-Anchor" href="#上面学了什么内容-2"></a> 上面学了什么内容？</h3><ul><li>前端项目主要代码在 src 文件夹里。</li><li>在 src 里面，main.js 是程序的启动点，App.vue 是最外层的页面框架。</li><li>src 下面还有几个子文件夹：<ul><li>assets 放图片等资源。</li><li>components 放页面里重复使用的小模块。</li><li>router 放页面跳转（路由）的设置。</li><li>views 放组成整个页面的大模块。</li></ul></li><li>node_modules 放项目用到的各种第三方库。</li><li>public 放一些直接复制到最终项目里的文件。</li><li>其他文件是项目配置和依赖管理文件。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">📦 project-root (项目根目录 - 截图中最顶层)</span><br><span class="line"> ├─ 📂 node_modules (存放项目依赖库的文件夹)</span><br><span class="line"> ├─ 📂 <span class="keyword">public</span> (存放不需要打包处理的静态资源的文件夹)</span><br><span class="line"> ├─ 📂 src (存放项目核心源代码的文件夹，这是重点)</span><br><span class="line"> │   ├─ 📂 assets (放在 src/ 下面的一个子文件夹，存放需要打包的静态资源，如图片、字体等)</span><br><span class="line"> │   ├─ 📂 components (放在 src/ 下面的一个子文件夹，存放可复用的、小的 Vue 组件)</span><br><span class="line"> │   │   └─ 📄 HelloWorld.vue (一个示例组件文件)</span><br><span class="line"> │   ├─ 📂 router (放在 src/ 下面的一个子文件夹，存放前端路由配置相关的文件)</span><br><span class="line"> │   │   └─ 📄 index.js (通常是路由定义文件)</span><br><span class="line"> │   ├─ 📂 views (放在 src/ 下面的一个子文件夹，存放页面级别的 Vue 组件)</span><br><span class="line"> │   │   ├─ 📄 AddCustomer.vue (添加客户页面)</span><br><span class="line"> │   │   ├─ 📄 AddSellJh.vue (添加销售机会页面)</span><br><span class="line"> │   │   ├─ 📄 ListAfterSale.vue (售后列表页面)</span><br><span class="line"> │   │   ├─ 📄 ListCustomer.vue (客户列表页面)</span><br><span class="line"> │   │   ├─ 📄 ListCustOrder.vue (客户订单列表页面)</span><br><span class="line"> │   │   └─ 📄 ListSellJh.vue (销售机会列表页面)</span><br><span class="line"> │   ├─ 📄 App.vue (直接放在 src/ 下面的文件，整个应用的根组件)</span><br><span class="line"> │   └─ 📄 main.js (直接放在 src/ 下面的文件，整个应用的入口文件，负责初始化 Vue)</span><br><span class="line"> ├─ 📄 .gitignore (Git 版本控制忽略文件)</span><br><span class="line"> ├─ 📄 babel.config.js (Babel 配置文件，用于 JavaScript 编译)</span><br><span class="line"> ├─ 📄 jsconfig.json (JavaScript 项目配置)</span><br><span class="line"> ├─ 📄 <span class="keyword">package</span>-lock.json (记录安装依赖时的精确版本信息)</span><br><span class="line"> ├─ 📄 <span class="keyword">package</span>.json (项目信息和依赖列表文件)</span><br><span class="line"> ├─ 📄 README.md (项目说明文件)</span><br><span class="line"> ├─ 📄 vue.config.js (Vue CLI 项目自定义配置文件)</span><br><span class="line"> └─ 📄 yarn.lock (Yarn 依赖管理器的锁文件)</span><br></pre></td></tr></table></figure><h2 id="day2-菜单功能"><a class="markdownIt-Anchor" href="#day2-菜单功能"></a> Day2 菜单功能</h2><h3 id="后端实现"><a class="markdownIt-Anchor" href="#后端实现"></a> 后端实现</h3><h4 id="对前端提供-menu-参数"><a class="markdownIt-Anchor" href="#对前端提供-menu-参数"></a> 对前端提供 menu 参数</h4><p><strong>1）新建 menu 表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_menu` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID (主键)&#x27;</span>,</span><br><span class="line">  `label` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;导航名称&#x27;</span>,</span><br><span class="line">  `component` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;子id&#x27;</span>,</span><br><span class="line">  `pid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;父id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">10</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;前端菜单表&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>2）对表插入数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">insert  into</span> `t_menus`(`id`,`label`,`component`,`pid`) <span class="keyword">values</span> (<span class="number">1</span>,<span class="string">&#x27;客户管理&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">0</span>),(<span class="number">2</span>,<span class="string">&#x27;添加客户&#x27;</span>,<span class="number">0</span>,<span class="number">1</span>),(<span class="number">3</span>,<span class="string">&#x27;查询客户&#x27;</span>,<span class="number">1</span>,<span class="number">1</span>),(<span class="number">4</span>,<span class="string">&#x27;售后服务&#x27;</span>,<span class="number">2</span>,<span class="number">1</span>),(<span class="number">5</span>,<span class="string">&#x27;客户订单&#x27;</span>,<span class="number">3</span>,<span class="number">1</span>),(<span class="number">6</span>,<span class="string">&#x27;客户跟踪&#x27;</span>,<span class="number">4</span>,<span class="number">1</span>),(<span class="number">7</span>,<span class="string">&#x27;数据统计&#x27;</span>,<span class="keyword">NULL</span>,<span class="number">0</span>),(<span class="number">8</span>,<span class="string">&#x27;客户统计&#x27;</span>,<span class="number">5</span>,<span class="number">7</span>),(<span class="number">9</span>,<span class="string">&#x27;库存统计&#x27;</span>,<span class="number">6</span>,<span class="number">7</span>);</span><br></pre></td></tr></table></figure><p><strong>3）生成代码</strong></p><p><u>在数据库里创建 menu 表后，再去 idea 里通过 mybatiesx 生成表格对应的增删改查代码</u></p><p><strong>4）定义 vo 类</strong></p><p><strong>定义一个 vo 类，方便把数据打包发给前端</strong></p><p>为什么这样定义：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/jiuchenchen/p/16524084.html">阿里巴巴 Java 开发手册中的 DO、DTO、BO、AO、VO、POJO 定义</a></p><p>更深层次的意义在于数据模型在不同层之间传递时可能需要转换**。**</p><p><strong>t_menu 表的数据对应一个简单的 Menu POJO，它只有 id, label, component, pid 字段。但为了前端的菜单树结构，你需要把它转换成 MenuVo，增加了一个 subMenu 列表字段。并且通过 BeanUtils.copyProperties 实现了基础字段的复制。</strong></p><p>这种从<strong>数据库模型 (POJO)</strong> 到<strong>视图展示模型 (VO)</strong> 的转换，是后端开发中处理数据流时的一个常见且必要的逻辑。</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250513154642452.webp" alt="image-20250513154642452" style="zoom:50%">.</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.vo;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuVo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String label;</span><br><span class="line">    <span class="keyword">private</span> Integer component;</span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuVo&gt; subMenu;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5）修改服务层代码</strong></p><p>实现将菜单返回给前端的功能</p><h5 id="服务接口代码"><a class="markdownIt-Anchor" href="#服务接口代码"></a> <strong>服务接口代码：</strong></h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> skyforever</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> 针对表【t_menu(前端菜单表)】的数据库操作Service</span></span><br><span class="line"><span class="comment">* <span class="doctag">@createDate</span> 2025-05-13 16:01:20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">MenuService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Menu&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询并构建菜单树列表</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 菜单树结构的Vo列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    List&lt;MenuVo&gt; <span class="title function_">queryMenuListService</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="服务实现代码"><a class="markdownIt-Anchor" href="#服务实现代码"></a> <strong>服务实现代码：</strong></h5><p>下面的 buildSubmenu 方法是一个典型的<strong>递归</strong>函数的应用。它通过不断调用自身来处理树形结构（子菜单）。</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* @author skyforever</span></span><br><span class="line"><span class="comment">* @description 针对表【t_menu(前端菜单表)】的数据库操作Service实现</span></span><br><span class="line"><span class="comment">* @createDate 2025-05-13 16:01:20</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="variable">@Service</span></span><br><span class="line">public class MenuServiceImpl extends ServiceImpl<span class="operator">&lt;</span>MenuMapper, Menu<span class="operator">&gt;</span></span><br><span class="line">        implements MenuService &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable">@Override</span></span><br><span class="line">    public List<span class="operator">&lt;</span>MenuVo<span class="operator">&gt;</span> queryMenuListService() &#123;</span><br><span class="line">        <span class="operator">/</span><span class="operator">/</span> <span class="number">1.</span> 查询所有菜单数据</span><br><span class="line">        List<span class="operator">&lt;</span>Menu<span class="operator">&gt;</span> allMenu <span class="operator">=</span> this.list();</span><br><span class="line">        <span class="keyword">return</span> buildSubmenu(allMenu, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 递归构建子菜单树</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * @param allMenu 所有菜单的列表</span></span><br><span class="line"><span class="comment">     * @param parentId 当前要查找的父菜单ID</span></span><br><span class="line"><span class="comment">     * @return 指定父菜单ID下的子菜单树列表</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    private List<span class="operator">&lt;</span>MenuVo<span class="operator">&gt;</span> buildSubmenu(List<span class="operator">&lt;</span>Menu<span class="operator">&gt;</span> allMenu, <span class="type">Integer</span> parentId) &#123;</span><br><span class="line">        List<span class="operator">&lt;</span>MenuVo<span class="operator">&gt;</span> submenuTree <span class="operator">=</span> <span class="keyword">new</span> ArrayList<span class="operator">&lt;&gt;</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (Menu menu : allMenu) &#123;</span><br><span class="line">            <span class="operator">/</span><span class="operator">/</span> 检查当前菜单的父ID是否与传入的parentId匹配</span><br><span class="line">            if (menu.getPid() <span class="operator">!=</span> <span class="keyword">null</span> <span class="operator">&amp;&amp;</span> menu.getPid().<span class="keyword">equals</span>(parentId)) &#123;</span><br><span class="line">                MenuVo menuVo <span class="operator">=</span> <span class="keyword">new</span> MenuVo();</span><br><span class="line">                BeanUtils.copyProperties(menu, menuVo); <span class="operator">/</span><span class="operator">/</span> 将 POJO属性 复制到 VO</span><br><span class="line">                <span class="operator">/</span><span class="operator">/</span> 递归查找当前菜单的子菜单</span><br><span class="line">                menuVo.setSubMenu(buildSubmenu(allMenu, menu.getId()));</span><br><span class="line">                submenuTree.add(menuVo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> submenuTree;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>6）控制层代码</strong></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250513154505678.webp" alt="image-20250513154505678" style="zoom:50%">.</p><p>@Autowired 注解被用在了 UserMapper 和 UserService 上，但没有用老式 Java 代码手动写代码去 new 出一个 UserMapper 或 UserService 对象。</p><p>这是 Spring 框架<strong>依赖注入 (Dependency Injection - DI)</strong> 的体现。Spring Boot 会自动扫描并创建这些类的实例（称为 Bean），并在需要的地方自动把它们“装配”进去。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenusController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MenuService menusService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*定义方法处理，加载左侧菜单节点的请求*/</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/listMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;MenuVo&gt; <span class="title function_">listMenus</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> menusService.queryMenuListService();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>7）修改启动类</strong></p><p><strong>添加对 mapper 的扫描注解</strong></p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/9e795ed2642f1ed2b18078bbec4ba233.webp" alt="image-20250513161028088">.</p><p><strong>8）启动并测试</strong></p><p>成功启动后，检验后端是否能返回预期数据</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/39e03434fca7cff4d0e32e5350596a76.webp" alt="image-20250513163121617"></p><p><strong>9）配合前端调试</strong></p><p><strong>实现前端控制台输出菜单 id</strong></p><p>只需要在控制层（MenusController）里加一个函数获取菜单 id</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*定义方法处理，加载左侧菜单节点的对应的组件下标的请求*/</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/compIndex&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Integer <span class="title function_">compIndex</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">    <span class="type">Menu</span> <span class="variable">menus</span> <span class="operator">=</span> menusService.getById(id);</span><br><span class="line">    <span class="keyword">return</span> menus.getComponent();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="上面学了什么内容-3"><a class="markdownIt-Anchor" href="#上面学了什么内容-3"></a> 上面学了什么内容？</h3><p>上面的过程清晰地展示了<strong>Controller、Service、Mapper 和 VO</strong> 这几个层级如何协作：</p><ul><li><strong>Controller (MenusController)</strong>：接收前端请求 (/listMenus)，调用 Service 层方法。</li><li><strong>Service (MenuServiceImpl)</strong>：调用 Mapper 获取所有原始数据，执行业务逻辑（将平铺数据构建成树状），准备好适合前端的 VO 数据。</li><li><strong>Mapper (MenuMapper)</strong>：通过 MyBatis-Plus 的 list() 方法从数据库获取原始 Menu (POJO) 数据。</li><li><strong>VO (MenuVo)</strong>：作为 Service 层处理后、Controller 层返回给前端的最终数据格式。</li></ul><h3 id="前端实现"><a class="markdownIt-Anchor" href="#前端实现"></a> 前端实现</h3><h4 id="从后端获取-menu-参数"><a class="markdownIt-Anchor" href="#从后端获取-menu-参数"></a> 从后端获取 menu 参数</h4><p><strong>1）修改 main.js</strong></p><p>添加对饿了么 ui 的引用</p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250513164400962.webp" alt="image-20250513164400962" style="zoom:50%"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 引入 ElementPlus 组件库</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementPlus</span> <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span><br><span class="line"><span class="comment">// 引入 ElementPlus 的默认样式文件</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&quot;element-plus/dist/index.css&quot;</span>;</span><br><span class="line"><span class="comment">// 创建 Vue 应用实例，注册 ElementPlus 和路由，并挂载到 #app 元素</span></span><br><span class="line"><span class="title function_">createApp</span>(<span class="title class_">App</span>).<span class="title function_">use</span>(<span class="title class_">ElementPlus</span>).<span class="title function_">use</span>(router).<span class="title function_">mount</span>(<span class="string">&quot;#app&quot;</span>);</span><br></pre></td></tr></table></figure><p><strong>2）修改 index.js</strong></p><p>把 index.vue 页面文件加入页面路由中</p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250513170419321.webp" alt="image-20250513170419321" style="zoom:50%"><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> index <span class="keyword">from</span> <span class="string">&#x27;../views/index.vue&#x27;</span><span class="comment">//注意前面需要导入页面</span></span><br><span class="line">,</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/index&#x27;</span>, <span class="comment">// 定义路由路径为 /index</span></span><br><span class="line">    <span class="attr">name</span>: <span class="string">&#x27;index&#x27;</span>, <span class="comment">// 给该路由起一个名字，便于在组件中引用</span></span><br><span class="line">    <span class="attr">component</span>: index <span class="comment">// 指定该路由对应的组件为 index</span></span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>3）实现 index.vue</strong></p><p>实现之前，需要设置两个没有设置逻辑的页面<code>AddCustomer.vue</code>和<code>ListCustomer.vue</code></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span> <span class="attr">lang</span>=<span class="string">&quot;ts&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span> <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p>index.vue 的具体实现</p><ul><li><p><strong>响应式系统 (ref, shallowRef):</strong> 使用 ref 来创建响应式数据（menus），当这些数据变化时，UI 会自动更新。</p><p>shallowRef 和 markRaw 让你初步了解了 Vue 3 针对复杂对象或组件引用的性能优化和更细粒度的响应式控制。</p></li><li><p><strong>生命周期钩子 (onMounted):</strong> 学会了在组件的特定阶段（DOM 挂载后）执行代码，比如在这里用于在页面加载完成后立即发起数据请求。</p><hr></li><li><p><strong>客户端路由 (vue-router):</strong> 通过修改 router/index.js 和使用<router-view>(虽然代码中没直接展示<router-view>，但动态组件<component :is>承担了类似角色)，学到了如何在前端实现页面间的<strong>无刷新跳转和导航</strong>，以及如何将 URL 路径映射到特定的 Vue 组件（页面）</component></router-view></router-view></p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddCustomer.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListCustomer.vue&quot;</span>; <span class="comment">//导入要跳转的两个页面</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; markRaw, shallowRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明数组保存所有组件，按后端component值顺序映射</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> views = [<span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>), <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>)];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> currentComponent = <span class="title function_">shallowRef</span>(views[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> menus = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/* menu组件选中叶子节点触发的函数，参数index：菜单节点的id */</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> handlerSelect = <span class="keyword">function</span> (<span class="params">index</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 查找对应菜单项的component值</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">let</span> componentIndex = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    menus.<span class="property">value</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">menu</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      menu.<span class="property">subMenu</span>.<span class="title function_">forEach</span>(<span class="function">(<span class="params">subMenu</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (subMenu.<span class="property">id</span> === <span class="built_in">parseInt</span>(index)) &#123;</span></span><br><span class="line"><span class="language-javascript">          componentIndex = subMenu.<span class="property">component</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 动态设置currentComponent</span></span></span><br><span class="line"><span class="language-javascript">    currentComponent.<span class="property">value</span> = views[componentIndex];</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listMenus&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        menus.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;common-layout&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-header</span> <span class="attr">class</span>=<span class="string">&quot;top&quot;</span>&gt;</span>ERP-ikun小组<span class="tag">&lt;/<span class="name">el-header</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">&quot;240px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span><br><span class="line">          系统菜单</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">class</span>=<span class="string">&quot;el-menu-vertical-demo&quot;</span> @<span class="attr">select</span>=<span class="string">&quot;handlerSelect&quot;</span>&gt;</span></span><br><span class="line">            //绑定事件</span><br><span class="line">            <span class="tag">&lt;<span class="name">el-sub-menu</span> <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> <span class="attr">:index</span>=<span class="string">&quot;menu.id.toString()&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">template</span> #<span class="attr">title</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; menu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-menu-item</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;subMenu in menu.subMenu&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:index</span>=<span class="string">&quot;subMenu.id.toString()&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                &#123;&#123; subMenu.label &#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-sub-menu</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-main</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;currentComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.top</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: azure;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: blanchedalmond;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: cornsilk;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>4）启动项目</strong></p><p>看看能不能实现从后端获取菜单并加载</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/5c39e072044eeb0d2dd8617a514038e9.webp" alt="image-20250513171546742"></p><p><strong>5）配合后端</strong></p><p><strong>实现获取当前菜单选项 id</strong></p><p>需要在后端菜单控制层代码加方法</p><p>然后，前端代码修改 handlerSelect 方法即可：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* menu组件选中叶子节点触发的函数，参数index：菜单节点的id */</span></span><br><span class="line"><span class="keyword">const</span> handlerSelect = <span class="keyword">function</span> (<span class="params">index</span>) &#123;</span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;选择的页面id:&quot;</span>, index); <span class="comment">// 用于调试 id</span></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/compIndex?id=&quot;</span> + index)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;后端返回的id值:&quot;</span>, response.<span class="property">data</span>); <span class="comment">// 调试后端返回的值</span></span><br><span class="line">      <span class="keyword">const</span> componentIndex = response.<span class="property">data</span>;</span><br><span class="line">      currentComponent.<span class="property">value</span> = views[componentIndex];</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Error:&quot;</span>, error); <span class="comment">// 捕获并显示错误</span></span><br><span class="line">    &#125;);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><h3 id="上面学了什么内容-4"><a class="markdownIt-Anchor" href="#上面学了什么内容-4"></a> 上面学了什么内容？</h3><p>从这份前端代码学到了如何从“静态网页”转向“动态、交互式、模块化”的现代前端开发，了解了 Vue.js 框架、路由、组件化、状态管理（简单响应式）、数据请求与处理、UI 库使用以及事件响应等核心技能，这是构建一个功能性 Web 应用前端的重要基础。</p><h2 id="day3"><a class="markdownIt-Anchor" href="#day3"></a> Day3</h2><h3 id="1-增删改查客户信息"><a class="markdownIt-Anchor" href="#1-增删改查客户信息"></a> 1 增删改查客户信息</h3><h4 id="后端实现-2"><a class="markdownIt-Anchor" href="#后端实现-2"></a> 后端实现</h4><p><strong>1. 添加 Mybatis 配置</strong></p><p>在后端实现客户列表的查询时，为了避免一次性加载所有数据导致性能问题，我们通常需要进行分页。MyBatis-Plus 的<strong>分页拦截器 (<code>PaginationInnerInterceptor</code>)</strong> 就是用来<strong>自动化</strong>实现这个功能的。</p><p>它的核心作用是<strong>拦截</strong>你使用 MyBatis-Plus 标准方法（如 <code>selectList(page, ...)</code>）执行的 SQL 查询。在执行数据库查询之前，这个拦截器会检查你是否传入了一个 <code>Page</code> 对象。如果传入了，它就会<strong>自动修改</strong>你原始的 SQL 语句，在后面<strong>添加 <code>LIMIT</code> 子句</strong>。</p><p>例如，如果你原始的查询是 <code>SELECT * FROM t_customer WHERE ...</code>，分页拦截器可能会根据你传入的页码和每页大小，将其改写为 <code>SELECT * FROM t_customer WHERE ... LIMIT offset, pageSize</code>。</p><p>这样就<strong>无需手动编写分页的 SQL 逻辑</strong>。你只需要配置好分页拦截器，并在 Service 层调用 Mapper 方法时传入 <code>Page</code> 对象，MyBatis-Plus 就会自动帮你处理底层数据库的分页细节，大大简化了分页功能的开发。</p><p>配置它的方式就是创建一个 <code>@Configuration</code> 类 (<code>MybatisPlusPageConfig</code>)，定义一个 <code>@Bean</code> 方法返回 <code>MybatisPlusInterceptor</code>，并在其中添加 <code>PaginationInnerInterceptor</code>。</p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/img-image-20250514170425183.webp" alt="image-20250514170425183" style="zoom:67%"><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.MybatisPlusInterceptor;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.extension.plugins.inner.PaginationInnerInterceptor;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MybatisPlusPageConfig</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*给mybatisplus注册拦截器，修改sql语句，给sql语句添加limit关键字*/</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> MybatisPlusInterceptor <span class="title function_">mybatisPlusInterceptor</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">MybatisPlusInterceptor</span> <span class="variable">mybatisPlusInterceptor</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MybatisPlusInterceptor</span>();</span><br><span class="line">        mybatisPlusInterceptor.addInnerInterceptor(<span class="keyword">new</span> <span class="title class_">PaginationInnerInterceptor</span>());</span><br><span class="line">        <span class="keyword">return</span> mybatisPlusInterceptor;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>2. 实现增删改查</strong></p><p>对前端提供客户列表的增删改查方法</p><p><strong>Controller 层</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomerService customerService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*增 添加客户信息*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveCust&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveCustomer</span><span class="params">(<span class="meta">@RequestBody</span> Customer customer)</span> &#123;</span><br><span class="line">        System.out.println(customer);</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">        customerService.save(customer);</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*查 处理客户信息分页查询请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/listCust&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryCustList</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> customerService.queryCustListService(pageNum, pageSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*删 删除客户信息*/</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/deleteCust/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteCustomer</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            customerService.removeById(id);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*改 修改客户信息*/</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/updateCust&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateCustomer</span><span class="params">(<span class="meta">@RequestBody</span> Customer customer)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            customerService.updateById(customer);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>Service 层实现分页查询</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">* <span class="doctag">@author</span> skyforever</span></span><br><span class="line"><span class="comment">* <span class="doctag">@description</span> 针对表【t_customer(客户表)】的数据库操作Service实现</span></span><br><span class="line"><span class="comment">* <span class="doctag">@createDate</span> 2025-05-13 10:05:12</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CustomerServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;CustomerMapper, Customer&gt; <span class="keyword">implements</span> <span class="title class_">CustomerService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 注入CustomerMapper</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CustomerMapper customerMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryCustListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 初始化分页对象</span></span><br><span class="line">        <span class="type">Page</span> <span class="variable">page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum, pageSize);</span><br><span class="line">        System.out.println(page.getTotal());</span><br><span class="line">        <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> customerMapper.selectList(page, <span class="literal">null</span>);</span><br><span class="line">        System.out.println(page.getTotal());</span><br><span class="line"></span><br><span class="line">        result.put(<span class="string">&quot;custlist&quot;</span>, list);</span><br><span class="line">        result.put(<span class="string">&quot;total&quot;</span>, page.getTotal());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>对应服务添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">CustomerService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;Customer&gt; &#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询客户列表，并支持分页</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageNum  当前页码</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> pageSize 每页显示数量</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> 包含客户列表和总数的结果Map</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Map&lt;String, Object&gt; <span class="title function_">queryCustListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-2"><a class="markdownIt-Anchor" href="#前端实现-2"></a> 前端实现</h4><p><strong>写两个页面，分别实现查和增删改</strong></p><p>昨天在 index.vue 添加了 AddCustomer 页面和 ListCustomer 页面，这里不重复</p><p><strong>1. 客户信息页实现</strong></p><p>AddCustomer.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 模块导入 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>; <span class="comment">// reactive: 用于创建响应式对象</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>; <span class="comment">// axios: 用于发送HTTP请求</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 响应式状态定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 初始化响应式表单数据对象 (custForm)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 客户名称</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">address</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 联系地址</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 联系电话</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custType</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 客户职业</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">grade</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 客户等级</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 方法定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明提交表单的函数 (subCustForm)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subCustForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 使用axios发送POST请求到后端API &#x27;/saveCust&#x27;，请求体为custForm对象</span></span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/saveCust&quot;</span>, custForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 请求成功的回调</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>); <span class="comment">// 打印后端返回的数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 提交成功后，清空表单各项数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(custForm, &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">address</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">custType</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">grade</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 请求失败的回调</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;提交失败:&quot;</span>, error); <span class="comment">// 在控制台打印错误信息</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 实际项目中，这里通常会显示错误提示给用户</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义重置表单的函数 (resetForm)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 将表单各项数据重置为空字符串 (或初始默认值)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(custForm, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">address</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">custType</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">grade</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 页面主标题 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>添加客户信息<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- Element Plus 表单组件 (el-form) --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- :model=&quot;custForm&quot; 将表单数据模型绑定到script部分的custForm响应式对象 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- label-width=&quot;120px&quot; 设置表单项标签的统一宽度 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;custForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 表单项 (el-form-item): 每个表单项包含一个标签(label)和一个输入控件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Element Plus 输入框 (el-input) --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- v-model=&quot;custForm.custName&quot; 双向绑定输入框的值到custForm对象的custName属性 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.custName&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系地址&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.address&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系电话&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.phone&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户职业&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Element Plus 选择器 (el-select) --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- v-model=&quot;custForm.custType&quot; 双向绑定选择器的值到custForm对象的custType属性 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- placeholder 设置未选择时的提示文本 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;custForm.custType&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请选择职业……&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 下拉选项 (el-option): label为显示文本, value为实际选中值 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;保密&quot;</span> <span class="attr">value</span>=<span class="string">&quot;保密&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;金融&quot;</span> <span class="attr">value</span>=<span class="string">&quot;金融&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;互联网&quot;</span> <span class="attr">value</span>=<span class="string">&quot;互联网&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;IT&quot;</span> <span class="attr">value</span>=<span class="string">&quot;IT&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;能源&quot;</span> <span class="attr">value</span>=<span class="string">&quot;能源&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户等级&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.grade&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 表单操作按钮区域 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- Element Plus 按钮 (el-button) --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- type=&quot;primary&quot; 设置按钮主题色为主色调 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- @click=&quot;subCustForm&quot; 点击时调用subCustForm方法 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subCustForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- @click=&quot;resetForm&quot; 点击时调用resetForm方法 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* scoped样式: CSS只作用于当前组件 */</span></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 设置表单的最大宽度并使其居中显示 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.el-form</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">max-width</span>: <span class="number">600px</span>; <span class="comment">/* 限制表单最大宽度 */</span></span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">20px</span> auto; <span class="comment">/* 上下20px外边距，左右自动外边距实现水平居中 */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2.删改查客户页实现</strong></p><p>ListCustomer.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 1. 模板区域: 定义组件的HTML结构 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>客户列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 2. 客户信息展示表格 (饿了么Plus组件 el-table) --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- :data绑定客户列表数据, stripe开启斑马纹, style设置宽度 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;custList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- el-table-column: 定义表格列。prop指定数据源的字段名, label指定列头文本 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户编号&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户姓名&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;address&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户地址&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户电话&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custType&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户职业&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;grade&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户等级&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;hisTotal&quot;</span> <span class="attr">label</span>=<span class="string">&quot;消费总额&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 操作列: fixed固定在右侧, width设置宽度, #default作用域插槽自定义内容 (row代表当前行数据) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 饿了么按钮: link类型像链接, 小按钮样式，@click绑定点击事件 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;deleteCustomer(row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openCustDialog(row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 3. 分页组件 (饿了么Plus组件 el-pagination) --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- small小型分页, background带背景色, :page-size每页条数, :pager-count页码按钮数, layout组件布局, :total总条数, @current-change页码改变事件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 4. 修改客户信息对话框 (饿了么Plus组件 el-dialog) --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- v-model控制显示/隐藏, width宽度, title标题 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogCustVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span> <span class="attr">title</span>=<span class="string">&quot;修改客户信息&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 客户信息表单 (饿了么Plus组件 el-form) --&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- :model绑定表单数据对象, label-width标签宽度, :rules绑定验证规则, ref用于访问表单实例 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">&quot;custForm&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;custFormRef&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- el-form-item: 表单项。label标签文本, prop关联数据和规则 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;custName&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- el-input: 输入框, v-model双向绑定数据 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.custName&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系地址&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;address&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.address&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系电话&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;custForm.phone&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户职业&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;custType&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- el-select: 下拉选择框 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;custForm.custType&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择职业....&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- el-option: 下拉选项, label显示文本, value实际值 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;保密&quot;</span> <span class="attr">value</span>=<span class="string">&quot;保密&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;金融&quot;</span> <span class="attr">value</span>=<span class="string">&quot;金融&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;互联网&quot;</span> <span class="attr">value</span>=<span class="string">&quot;互联网&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;IT&quot;</span> <span class="attr">value</span>=<span class="string">&quot;IT&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;能源&quot;</span> <span class="attr">value</span>=<span class="string">&quot;能源&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户等级&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;grade&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- .number修饰符, 输入值自动转为数字 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;custForm.grade&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 对话框底部操作区域 (el-dialog的#footer插槽) --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;cancelForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subCustForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 5. Script区域 (Vue 3 Composition API setup语法糖) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 导入Vue核心API, Axios HTTP库, Element Plus组件</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 响应式状态定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custList = <span class="title function_">ref</span>([]); <span class="comment">// 客户列表数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>); <span class="comment">// 客户总记录数 (用于分页)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogCustVisible = <span class="title function_">ref</span>(<span class="literal">false</span>); <span class="comment">// 控制修改对话框的显示/隐藏</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>); <span class="comment">// 表单DOM引用 (用于调用表单方法如validate, resetFields)</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 客户表单数据模型 (响应式对象)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">address</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custType</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">grade</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">hisTotal</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 表单验证规则</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> rules = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custName</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入客户名称&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">address</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入联系地址&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入联系电话&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">pattern</span>: <span class="regexp">/^\d&#123;11&#125;$/</span>, <span class="attr">message</span>: <span class="string">&quot;请输入11位数字电话&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custType</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择客户职业&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">grade</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入客户等级&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">type</span>: <span class="string">&quot;number&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;等级必须为数字&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 方法定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 查询客户列表 (pageNum: 请求的页码)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">custListQeury</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 使用 axios 发送 GET 请求到后端 API</span></span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">`http://localhost:8080/listCust?pageNum=<span class="subst">$&#123;pageNum&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 请求成功的回调</span></span></span><br><span class="line"><span class="language-javascript">        custList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">custlist</span>; <span class="comment">// 更新客户列表数据</span></span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>; <span class="comment">// 更新总记录数</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 请求失败的回调</span></span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;查询失败&quot;</span>); <span class="comment">// 使用 Element Plus 的 ElMessage 显示错误提示</span></span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error); <span class="comment">// 在控制台打印错误信息</span></span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 删除客户 (id: 客户ID)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">deleteCustomer</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定删除该客户吗？&quot;</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">delete</span>(<span class="string">`http://localhost:8080/deleteCust/<span class="subst">$&#123;id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;删除成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">custListQeury</span>(<span class="number">1</span>); <span class="comment">// 刷新列表</span></span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开修改对话框并填充数据 (row: 当前行数据)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openCustDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogCustVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 使用Object.assign将行数据安全地复制到表单模型，提供默认值以防row中字段缺失</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(custForm, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: row.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">custName</span>: row.<span class="property">custName</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">address</span>: row.<span class="property">address</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">phone</span>: row.<span class="property">phone</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">custType</span>: row.<span class="property">custType</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">grade</span>: row.<span class="property">grade</span> || <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hisTotal</span>: row.<span class="property">hisTotal</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 提交修改表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subCustForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    custFormRef.<span class="property">value</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 调用表单验证</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">put</span>(<span class="string">&quot;http://localhost:8080/updateCust&quot;</span>, custForm)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;修改成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            dialogCustVisible.<span class="property">value</span> = <span class="literal">false</span>; <span class="comment">//关闭弹窗</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">custListQeury</span>(<span class="number">1</span>); <span class="comment">// 刷新列表</span></span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;请填写完整信息&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 取消修改 (关闭对话框并重置表单)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">cancelForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogCustVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    custFormRef.<span class="property">value</span>.<span class="title function_">resetFields</span>(); <span class="comment">// 重置表单项到初始值并移除校验结果</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 生命周期钩子 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 组件挂载后执行: 初始化加载第一页数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">custListQeury</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理分页页码变化 (value: 新的页码)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerPageChange</span>(<span class="params">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">custListQeury</span>(value);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 6. Style区域 (scoped表示样式仅作用于当前组件) --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 此处可添加组件特定样式 */</span></span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-增删改查销售过程信息"><a class="markdownIt-Anchor" href="#2-增删改查销售过程信息"></a> 2 增删改查销售过程信息</h3><p>实现销售机会过程数据维护，销售过程数据和客户信息表存在主外键关系。</p><h4 id="后端实现-3"><a class="markdownIt-Anchor" href="#后端实现-3"></a> 后端实现</h4><p><strong>1.为销售机会页面提供下拉列表内容查询</strong></p><p><strong>Customer 添加相关方法</strong></p><p><strong>服务层接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查询所有客户Id和姓名*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title function_">queryCustIdNameListService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>服务层实现</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title function_">queryCustIdNameListService</span><span class="params">()</span> &#123;</span><br><span class="line">    QueryWrapper&lt;Customer&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//指定列的投影，指定select id,cust_name</span></span><br><span class="line">    wrapper.select(<span class="string">&quot;id&quot;</span>,<span class="string">&quot;cust_name&quot;</span>);</span><br><span class="line">    List&lt;Customer&gt; customerList = customerMapper.selectList(wrapper);</span><br><span class="line">    <span class="keyword">return</span> customerList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>控制层实现</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理加载所有客户列表请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/listAllCust&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Customer&gt; <span class="title function_">listAllCust</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> customerService.queryCustIdNameListService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>2.为销售机会页面实现保存功能</strong></p><p>新增 SellJhController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SellJhController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SellJhService sellJhService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*添加销售计划*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveSellJh&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveSellJh</span><span class="params">(<span class="meta">@RequestBody</span> SellJh sellJh)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            sellJhService.save(sellJh);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-3"><a class="markdownIt-Anchor" href="#前端实现-3"></a> 前端实现</h4><p><strong>1. 添加销售机会页面</strong></p><p>AddSellJh.vue 代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>销售开发<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;sellForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 客户选择下拉框: 选项动态从后端获取 --&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- v-model绑定的是选中客户的ID --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;sellForm.custid&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;m-2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请选择客户&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">size</span>=<span class="string">&quot;large&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- v-for遍历custList (从后端获取的客户列表) 来动态生成选项 --&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- :key为每个选项提供唯一标识, :label显示客户名称, :value是客户的ID --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-for</span>=<span class="string">&quot;item in custList&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:label</span>=<span class="string">&quot;item.custName&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;销售渠道&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;sellForm.channelId&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请选择渠道....&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;自媒体&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;网络推广&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;老客户介绍&quot;</span> <span class="attr">value</span>=<span class="string">&quot;2&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;陌拜&quot;</span> <span class="attr">value</span>=<span class="string">&quot;3&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;二次客户&quot;</span> <span class="attr">value</span>=<span class="string">&quot;4&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;销售金额&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;sellForm.money&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;开发阶段&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;sellForm.nowStep&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请选择....&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;解除&quot;</span> <span class="attr">value</span>=<span class="string">&quot;解除&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;报价&quot;</span> <span class="attr">value</span>=<span class="string">&quot;报价&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;签约&quot;</span> <span class="attr">value</span>=<span class="string">&quot;签约&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;业务员&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;sellForm.empId&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subSellForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义销售过程表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sellForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custid</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 存储选中的客户ID</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">channelId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">money</span>: <span class="number">0.0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">nowStep</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">empId</span>: <span class="number">100</span>, <span class="comment">// 业务员ID，默认为100</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//创建数组，用于封装从后端获取的所有客户信息 (用于客户名称下拉列表)</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//页面挂载时执行: 发送ajax请求，查询所有客户信息，用于填充客户名称的下拉列表框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listAllCust&quot;</span>) <span class="comment">// API端点，获取所有客户列表</span></span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        custList.<span class="property">value</span> = response.<span class="property">data</span>; <span class="comment">// 将获取的客户数据赋值给custList</span></span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subSellForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/saveSellJh&quot;</span>, sellForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查后端返回的业务状态码，确保操作成功</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(response.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 成功后清空表单, custid设为null，empId恢复默认值</span></span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">Object</span>.<span class="title function_">assign</span>(sellForm, &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">custid</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">channelId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">money</span>: <span class="number">0.0</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">nowStep</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">empId</span>: <span class="number">100</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;提交失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>2.注册销售机会页面</strong></p><p>修改 index.vue，将上面的 AddSellJh.vue 页面加入进去</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">AddSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddSellJh&quot;</span>; <span class="comment">//添加页面</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如果是老师的方案，就修改数组</span></span><br><span class="line"><span class="keyword">const</span> views = [<span class="title class_">AddCustomer</span>, <span class="title class_">ListCustomer</span>, , , <span class="title class_">AddSellJh</span>]; <span class="comment">//声明数组保存所有组件，将AddSellJh页面放到下标为四的位置</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//如果是我的方案（用markRaw），则直接加多个占位符</span></span><br><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> &#123; markRaw, shallowRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="comment">// 声明数组保存所有组件，按后端component值顺序映射</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="day3-学了什么"><a class="markdownIt-Anchor" href="#day3-学了什么"></a> Day3 学了什么</h3><p>从基础的项目搭建和 Mybatis-Plus 的基本增删改查使用，进步到了实现<strong>完整的、带有实际业务功能的客户信息管理</strong>。</p><p>学会了如何在后端实现客户信息的<strong>增、删、改、查</strong> API，并在前端构建了对应的页面，利用 <strong>Vue.js 和 Element Plus UI 组件库</strong>实现了数据的展示（表格）、表单的提交、修改对话框和删除确认，以及前后端通过 <strong>HTTP 请求</strong>进行数据交互来完成这些操作。</p><p>特别是学会了处理<strong>数据分页</strong>和<strong>动态加载下拉列表</strong>数据，让应用更能应对实际数据量。</p><h2 id="day4"><a class="markdownIt-Anchor" href="#day4"></a> Day4</h2><h3 id="1统计每个客户历史消费总额"><a class="markdownIt-Anchor" href="#1统计每个客户历史消费总额"></a> 1.统计每个客户历史消费总额</h3><p>通过订单表统计每个客户历史消费总额，更新到客户信息表</p><p>以下全部针对<strong>后端</strong>操作</p><p><strong>创建 HisData 实体类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">HisData</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Long custId;</span><br><span class="line">    <span class="keyword">private</span> Double hisTotal;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>OrderMapper 接口添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">OrderMapper</span> <span class="keyword">extends</span> <span class="title class_">BaseMapper</span>&lt;Order&gt; &#123;</span><br><span class="line">    <span class="comment">/* 查询统计每个客户历史消费总额 */</span></span><br><span class="line">    List&lt;HisData&gt; <span class="title function_">queryCountHisDataMapper</span><span class="params">()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>OrderMapper.xml 定义 SQL</strong></p><p>写出带有 GROUP BY 和 SUM() 聚合函数的 SQL 语句。</p><p>这是 MyBatis-Plus 自动生成的简单 CRUD 无法覆盖的，需要你根据业务需求手写 SQL 来实现更复杂的数据库查询。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 顶级sql统计客户历史消费总额 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;queryCountHisDataMapper&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.demo.dto.HisData&quot;</span>&gt;</span></span><br><span class="line">    select cust_id custId, sum(pay_money) hisTotal from t_order group by cust_id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>实现客户信息表更新</strong></p><p>修改 CustomerServiceImpl 中分页查询方法：</p><ul><li><p>在 CustomerServiceImpl 的 queryCustListService 方法中，先调用了 OrderMapper 的方法查询统计数据，然后遍历这个结果，再逐条针对每个客户调用 CustomerMapper 的 updateById 方法来更新客户表中的历史消费总额。这展示了在一个业务流程中，如何协调不同表（通过不同 Mapper）的数据操作。</p></li><li><p><strong>事务管理 (@Transactional)：</strong> 在这个更新操作的方法上添加了 <strong>@Transactional</strong> 注解。这是一个非常重要的进步，它保证了在更新客户历史消费总额这一系列数据库操作中，要么所有更新都成功，要么如果中途发生任何错误，所有已做的更新都会回滚。</p><p>这确保了数据的<strong>一致性</strong>和<strong>完整性</strong>。</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 注入 Mapper</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CustomerMapper customerMapper;</span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryCustListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    System.out.println(<span class="string">&quot;==================&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 将客户历史消费信息更新到客户信息表</span></span><br><span class="line">    List&lt;HisData&gt; hisDatas = orderMapper.queryCountHisDataMapper();</span><br><span class="line">    <span class="keyword">for</span> (HisData hisData : hisDatas) &#123;</span><br><span class="line">        <span class="type">Customer</span> <span class="variable">cust</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Customer</span>();</span><br><span class="line">        cust.setId(hisData.getCustId());</span><br><span class="line">        cust.setHisTotal(hisData.getHisTotal());</span><br><span class="line">        customerMapper.updateById(cust);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 创建封装分页查询参数的 Page 对象</span></span><br><span class="line">    <span class="type">Page</span> <span class="variable">page</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Page</span>(pageNum, pageSize);</span><br><span class="line">    System.out.println(page.getTotal());</span><br><span class="line">    <span class="type">List</span> <span class="variable">list</span> <span class="operator">=</span> customerMapper.selectList(page, <span class="literal">null</span>);</span><br><span class="line">    System.out.println(page.getTotal());</span><br><span class="line"></span><br><span class="line">    result.put(<span class="string">&quot;custList&quot;</span>, list);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>, page.getTotal());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2实现销售过程表的增删改查"><a class="markdownIt-Anchor" href="#2实现销售过程表的增删改查"></a> 2.实现销售过程表的增删改查</h3><h4 id="后端实现-4"><a class="markdownIt-Anchor" href="#后端实现-4"></a> 后端实现</h4><p><strong>在服务层添加分页方法接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">SellJhService</span> <span class="keyword">extends</span> <span class="title class_">IService</span>&lt;SellJh&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*定义分页查询方法*/</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">querySellJhListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实现此接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> SellJhMapper sellJhMapper;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">querySellJhListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    Page&lt;SellJh&gt; page=<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;1---------&quot;</span>+page.getTotal());</span><br><span class="line">    List&lt;SellJh&gt; sellJhs = sellJhMapper.selectList(page, <span class="literal">null</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;2---------&quot;</span>+page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;sellJhList&quot;</span>,sellJhs);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加控制层接口相关方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理销售计划分页查询请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/sellJhList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">querySellJhList</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum,</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> sellJhService.querySellJhListService(pageNum, pageSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-4"><a class="markdownIt-Anchor" href="#前端实现-4"></a> 前端实现</h4><p><strong>添加销售计划列表页面</strong></p><ul><li>在以下页面中，对于销售渠道 (channelId)，没有直接显示数据库中存储的数字 ID，而是通过一个 getChannelName(channelId) 方法将其转换为用户友好的文本描述（如 “自媒体”, “网络推广”）。这是一种常见的前端数据<strong>格式化或转换</strong>技巧，用于提升用户体验。</li></ul><p>ListSellJh.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>销售计划列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;sellJHList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;计划编号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;channelId&quot;</span> <span class="attr">label</span>=<span class="string">&quot;销售渠道&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        &#123;&#123; getChannelName(scope.row.channelId) &#125;&#125;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;money&quot;</span> <span class="attr">label</span>=<span class="string">&quot;销售金额&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;nowStep&quot;</span> <span class="attr">label</span>=<span class="string">&quot;销售阶段&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;empId&quot;</span> <span class="attr">label</span>=<span class="string">&quot;业务员&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;deleteSellJh(scope.row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;openSellJhDialog(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogSellJhVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>修改销售计划<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">&quot;sellJhForm&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;sellJhFormRef&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;sellJhForm.custid&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">class</span>=<span class="string">&quot;m-2&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择客户&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;large&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">&quot;item in custList&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:label</span>=<span class="string">&quot;item.custName&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:value</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;销售渠道&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;channelId&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;sellJhForm.channelId&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择渠道....&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">&quot;opt in channelList&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">&quot;opt.id&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:label</span>=<span class="string">&quot;opt.label&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:value</span>=<span class="string">&quot;opt.id&quot;</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;销售金额&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;money&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;sellJhForm.money&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;开发阶段&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;nowStep&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;sellJhForm.nowStep&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择....&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;接触&quot;</span> <span class="attr">value</span>=<span class="string">&quot;接触&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;报价&quot;</span> <span class="attr">value</span>=<span class="string">&quot;报价&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;签约&quot;</span> <span class="attr">value</span>=<span class="string">&quot;签约&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;业务员&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;empId&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model.number</span>=<span class="string">&quot;sellJhForm.empId&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">readonly</span>=<span class="string">&quot;readonly&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subSellJhForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;cancelForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sellJHList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogSellJhVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sellJhFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> custList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> channelList = <span class="title function_">ref</span>([</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">id</span>: <span class="number">0</span>, <span class="attr">label</span>: <span class="string">&quot;自媒体&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">id</span>: <span class="number">1</span>, <span class="attr">label</span>: <span class="string">&quot;网络推广&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">id</span>: <span class="number">2</span>, <span class="attr">label</span>: <span class="string">&quot;老客户介绍&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">id</span>: <span class="number">3</span>, <span class="attr">label</span>: <span class="string">&quot;陌拜&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">id</span>: <span class="number">4</span>, <span class="attr">label</span>: <span class="string">&quot;二次客户&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  ]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sellJhForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custid</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">channelId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">money</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">nowStep</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">empId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> rules = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custid</span>: [&#123; <span class="attr">required</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">&quot;请选择客户&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">channelId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择渠道&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">money</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入金额&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">type</span>: <span class="string">&quot;number&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;金额必须为数字&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">nowStep</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择开发阶段&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">empId</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入业务员ID&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">type</span>: <span class="string">&quot;number&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;业务员ID必须为数字&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">getChannelName</span>(<span class="params">channelId</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">switch</span> (channelId) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="number">0</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;自媒体&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="number">1</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;网络推广&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="number">2</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;老客户介绍&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="number">3</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;陌拜&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">case</span> <span class="number">4</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;二次客户&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">default</span>:</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="string">&quot;未知&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">sellJhListQuery</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">`http://localhost:8080/sellJhList?pageNum=<span class="subst">$&#123;pageNum&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        sellJHList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">sellJhList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;查询失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">deleteSellJh</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定删除该销售计划吗？&quot;</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">delete</span>(<span class="string">`http://localhost:8080/deleteSellJh/<span class="subst">$&#123;id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;删除成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">sellJhListQuery</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openSellJhDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogSellJhVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listAllCust&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        custList.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(sellJhForm, &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">id</span>: row.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">custid</span>: row.<span class="property">custid</span> ?? <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">channelId</span>: row.<span class="property">channelId</span> ?? <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">money</span>: row.<span class="property">money</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">nowStep</span>: row.<span class="property">nowStep</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">empId</span>: row.<span class="property">empId</span> || <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">custName</span>: row.<span class="property">custName</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subSellJhForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    sellJhFormRef.<span class="property">value</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">put</span>(<span class="string">&quot;http://localhost:8080/updateSellJh&quot;</span>, sellJhForm)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;修改成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            dialogSellJhVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">sellJhListQuery</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;请填写完整信息&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">cancelForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogSellJhVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    sellJhFormRef.<span class="property">value</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">sellJhListQuery</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">sellJhListQuery</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在数据库中加入这个页面</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="string">&#x27;销售过程列表&#x27;</span>, <span class="number">7</span>, <span class="number">1</span>);</span><br></pre></td></tr></table></figure><p><strong>修改 index.vue 页面，将 ListSellJh 页面注册进来</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListSellJh&quot;</span>; <span class="comment">// 导入 &quot;销售计划列表&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法像下面这样改</span></span><br><span class="line"><span class="keyword">const</span> views = [<span class="title class_">AddCustomer</span>, <span class="title class_">ListCustomer</span>, , , <span class="title class_">AddSellJh</span>, , , <span class="title class_">ListSellJh</span>];</span><br><span class="line"><span class="comment">//我的方法像下面这样改</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="3销售过程页客户-id-和名称映射"><a class="markdownIt-Anchor" href="#3销售过程页客户-id-和名称映射"></a> 3.销售过程页客户 id 和名称映射</h3><h4 id="后端实现-5"><a class="markdownIt-Anchor" href="#后端实现-5"></a> 后端实现</h4><p><strong>在 pom.xml 里新增 PageHelper 分页插件方便实现自定义 sql 分页查询</strong></p><p>PageHelper 的一个重要特点是它<strong>对于手写的、非 MyBatis-Plus 自动生成的 SQL 也能很好地实现分页</strong>。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--PageHelper分页插件--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.pagehelper<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>pagehelper-spring-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.4.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>SellJh 类添加客户名字段</strong></p><ul><li>给 SellJh 类添加了一个<strong>非数据库表字段</strong>的 custName 属性，并使用 @TableField(exist = false) 注解告诉 MyBatis-Plus 这个字段不参与数据库表的映射。这是处理关联查询结果的一种常见方式，将关联表的信息直接封装到主表的实体对象中。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="comment">//扩展属性，封装客户名字</span></span><br><span class="line"><span class="keyword">private</span> String custName;</span><br></pre></td></tr></table></figure><p><strong>mapper 接口里添加自定义查询方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*查询客户销售过程记录列表*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;SellJh&gt; <span class="title function_">querySellJhListMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>xml 里添加自定义方法的 sql</strong></p><ul><li>这里编写了<strong>多表关联查询</strong><code>INNER JOIN SQL</code> 语句，将销售机会表 (t_sell_jh) 和客户表 (t_customer) 关联起来，以便在销售机会列表中直接显示客户名称</li><li>用到了之前在 SellJh 里加的<strong>非数据库表字段</strong>属性，方便封装数据</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--定义sql查询销售记录列表--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;querySellJhListMapper&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.example.demo.pojo.SellJh&quot;</span>&gt;</span></span><br><span class="line">    select sell.*,customer.cust_name custName from t_sell_jh sell inner join</span><br><span class="line">                                                   t_customer customer on sell.custid=customer.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改 serviceimpl 原本的实现方法</strong></p><ul><li>在 新的 SellJhServiceImpl 中，调用的是 sellJhMapper.querySellJhListMapper() 这个<strong>自定义的 Mapper 方法</strong>（对应 XML 中的手写 SQL）。</li><li>通过在调用这个方法之前执行 PageHelper.startPage(pageNum, pageSize)，PageHelper 就能拦截这个自定义的 SQL 并在其后添加分页逻辑。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">querySellJhListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//Page&lt;SellJh&gt; page=new Page&lt;&gt;(pageNum,pageSize);</span></span><br><span class="line">    <span class="comment">//使用PageHelper分页,指定分页查询参数</span></span><br><span class="line">    Page&lt;SellJh&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;1---------&quot;</span>+page.getTotal());</span><br><span class="line">    <span class="comment">//List&lt;SellJh&gt; sellJhs = sellJhMapper.selectList(page, null);</span></span><br><span class="line">    List&lt;SellJh&gt; sellJhs = sellJhMapper.querySellJhListMapper();</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;2---------&quot;</span>+page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;sellJhList&quot;</span>,sellJhs);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-5"><a class="markdownIt-Anchor" href="#前端实现-5"></a> 前端实现</h4><p>将 ListSellJh.vue 页面里的 custid 改为 custName 即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">将下面这个</span><br><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custid&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户ID&quot;</span> /&gt;</span></span><br><span class="line">改为这个即可</span><br><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户&quot;</span> /&gt;</span></span><br></pre></td></tr></table></figure><h3 id="day4-学了什么"><a class="markdownIt-Anchor" href="#day4-学了什么"></a> Day4 学了什么</h3><ul><li><strong>处理更复杂的业务逻辑</strong>，如跨表数据统计更新和事务管理。</li><li><strong>掌握手写复杂 SQL</strong> (聚合、多表连接) 并将其与 MyBatis 结合使用。</li><li><strong>理解并使用另一种流行的分页解决方案 PageHelper</strong>，特别是在自定义 SQL 场景下的应用。</li><li><strong>如何在 POJO 中扩展属性</strong>来封装关联查询的结果。</li><li><strong>前端如何对从后端获取的数据进行格式化展示</strong>以优化用户体验。</li></ul><h2 id="day5"><a class="markdownIt-Anchor" href="#day5"></a> Day5</h2><h3 id="1实现订单数据增删改查"><a class="markdownIt-Anchor" href="#1实现订单数据增删改查"></a> 1.实现订单数据增删改查</h3><h4 id="后端实现-6"><a class="markdownIt-Anchor" href="#后端实现-6"></a> 后端实现</h4><p><strong>修改 Order 类</strong></p><ul><li>在 Order 类的 orderDate (订单日期) 字段上，添加了 @JsonFormat(pattern = “yyyy-MM-dd HH:mm:ss”) 注解。</li><li><strong>作用：</strong> 这个注解（通常来自 Jackson 库，Spring Boot 默认的 JSON 处理库）指示了当这个 Order 对象被序列化为 JSON 字符串（例如，后端返回给前端时）或者从 JSON 反序列化时，日期类型的 orderDate 字段应该按照 “yyyy-MM-dd HH:mm:ss” 这种格式进行转换。这有助于确保前后端日期格式的一致性，避免因格式问题导致的解析错误或显示异常。</li><li>Order 实体类中也相应地添加了 @TableField(exist = false) 注解的 custName 和 itemName 属性来承载这些关联查询的结果。这是对 Day 4 学习内容的应用和巩固。</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 下单时间</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><span class="comment">//新增映射注释</span></span><br><span class="line">  <span class="keyword">private</span> Date orderDate;</span><br><span class="line"><span class="comment">//添加sql查询需要的字段</span></span><br><span class="line">  <span class="meta">@TableField(exist = false)</span><span class="comment">//不映射到类本身</span></span><br><span class="line">  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> Integer num;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> String custName;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> String itemName;</span><br></pre></td></tr></table></figure><p><strong>Ordermapper 添加自定义查询方法</strong></p><ul><li>再次使用了 INNER JOIN 来关联客户表和商品表，以便在订单列表中显示客户名称和商品名称</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryOrderListMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.Order&quot;<span class="operator">&gt;</span></span><br><span class="line">        <span class="keyword">select</span> ord.<span class="operator">*</span>,customer.cust_name custName,</span><br><span class="line">               item.item_name itemName <span class="keyword">from</span> t_customer customer</span><br><span class="line">                                                <span class="keyword">inner</span> <span class="keyword">join</span> t_order ord <span class="keyword">on</span> customer.id<span class="operator">=</span>ord.cust_id</span><br><span class="line">                                                <span class="keyword">inner</span> <span class="keyword">join</span> t_item item <span class="keyword">on</span> item.id<span class="operator">=</span>ord.item_id</span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在对应 mapper 接口里添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 查询订单列表</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">queryOrderListMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>在对应 service 里添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理订单数据动态多条件分页查询*/</span></span><br><span class="line">   <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryOrderListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p><strong>在对应 servicimpl 里实现对应方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">   <span class="keyword">private</span> OrderMapper orderMapper;</span><br><span class="line"></span><br><span class="line">   <span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryOrderListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">       <span class="comment">//指定分页参数</span></span><br><span class="line">       Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">       <span class="comment">//查询数据库</span></span><br><span class="line">       List&lt;Order&gt; orderList = orderMapper.queryOrderListMapper();</span><br><span class="line"></span><br><span class="line">       Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">       result.put(<span class="string">&quot;orderList&quot;</span>,orderList);</span><br><span class="line">       result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line"></span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p><strong>新建 Controller 类，实现增删改查</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.Controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.pojo.Order;</span><br><span class="line"><span class="keyword">import</span> com.example.demo.service.OrderService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OrderController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 处理分页查询请求 */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/listOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">listOrders</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum,</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> orderService.queryOrderListService(pageNum, pageSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 添加订单 */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            orderService.save(order);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 删除订单 */</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/deleteOrder/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteOrder</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            orderService.removeById(id);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/* 修改订单 */</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/updateOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            orderService.updateById(order);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">            result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-6"><a class="markdownIt-Anchor" href="#前端实现-6"></a> 前端实现</h4><p><strong>添加销售计划列表页面</strong></p><ul><li>在表格上方添加了由多个输入框 (el-input) 和下拉选择框 (el-select) 组成的查询表单 (el-form :inline=“true” 表示行内表单)。</li><li>用户可以在这些表单项中输入查询条件，点击“查询”按钮后，前端会将这些条件收集起来（绑定到 condForm 这个响应式对象），然后通过 POST 请求发送给后端。</li></ul><p>ListCustOrder.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>客户订单列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;orderList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;订单编号&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;custName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;客户姓名&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;orderDate&quot;</span> <span class="attr">label</span>=<span class="string">&quot;订单日期&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;订单状态&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;num&quot;</span> <span class="attr">label</span>=<span class="string">&quot;数量&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;pay&quot;</span> <span class="attr">label</span>=<span class="string">&quot;支付方式&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;payMoney&quot;</span> <span class="attr">label</span>=<span class="string">&quot;支付金额&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;deleteOrder(scope.row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;openOrderDialog(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerOrderPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogOrderVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span> <span class="attr">title</span>=<span class="string">&quot;修改订单信息&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;orderForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户姓名&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;orderForm.custName&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;orderForm.itemName&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;订单日期&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;orderForm.orderDate&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;订单状态&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;orderForm.state&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;数量&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;orderForm.num&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;支付方式&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;orderForm.pay&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;支付金额&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;orderForm.payMoney&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;saveOrder&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;cancelOrder&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref, reactive &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义订单列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> orderList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogOrderVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> orderForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">orderDate</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">state</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">num</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">pay</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">payMoney</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 加载订单列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadOrderList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">`http://localhost:8080/listOrder?pageNum=<span class="subst">$&#123;pageNum&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        orderList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">orderList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 删除订单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">deleteOrder</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定删除该订单吗？&quot;</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">delete</span>(<span class="string">`http://localhost:8080/deleteOrder/<span class="subst">$&#123;id&#125;</span>`</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;删除成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">loadOrderList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开修改对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openOrderDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogOrderVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(orderForm, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: row.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">custName</span>: row.<span class="property">custName</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemName</span>: row.<span class="property">itemName</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">orderDate</span>: row.<span class="property">orderDate</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">state</span>: row.<span class="property">state</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">num</span>: row.<span class="property">num</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">pay</span>: row.<span class="property">pay</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">payMoney</span>: row.<span class="property">payMoney</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 保存修改</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">saveOrder</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">put</span>(<span class="string">&quot;http://localhost:8080/updateOrder&quot;</span>, orderForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;修改成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        dialogOrderVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">loadOrderList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 取消修改</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">cancelOrder</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogOrderVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 页面加载</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadOrderList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 分页处理</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerOrderPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadOrderList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改 index.vue 页面，将 ListCustOrder 页面注册进来</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListCustOrder</span> <span class="keyword">from</span> <span class="string">&quot;./views/ListCustOrder.vue&quot;</span>; <span class="comment">// 导入 &quot;客户订单列表&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法像下面这样改</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  ,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法像下面这样改</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="2实现订单数据多条件分页查询"><a class="markdownIt-Anchor" href="#2实现订单数据多条件分页查询"></a> 2.实现订单数据多条件分页查询</h3><h4 id="后端实现-7"><a class="markdownIt-Anchor" href="#后端实现-7"></a> 后端实现</h4><p>修改原本的 order 实体类，添加分页查询参数</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> Integer pageNum=<span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> Integer pageSize=<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p>修改对应 mapper 接口，用 order 实体类封装动态 where 条件</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现订单数据动态多条件分页查询</span></span><br><span class="line"><span class="comment"> * order:封装动态where条件</span></span><br><span class="line"><span class="comment"> * */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Order&gt; <span class="title function_">queryOrderListMapper</span><span class="params">(Order order)</span>;</span><br></pre></td></tr></table></figure><p>修改 mapper 对应 xml，添加条件查询 where-if 字句</p><ul><li>这是 Day 5 最显著的特色之一。在实现订单数据和售后数据的“多条件分页查询”时，在 Mapper XML 文件中使用了 MyBatis 的<strong>动态 SQL</strong> 功能：<ul><li><where>标签：MyBatis 会智能地处理<where>标签内部 AND 或 OR 的前缀。如果内部有条件成立，它会自动加上 WHERE 关键字；如果内部所有条件都不成立，则<where>标签本身不会渲染。</where></where></where></li><li><if test="...">标签：根据传入参数对象的属性值是否满足 test 中的条件（例如 id!=null 或 state!=null and state!=‘’），来决定是否将该<if>标签内部的 SQL 片段拼接到最终的 SQL 语句中。</if></if></li></ul></li><li><strong>将查询条件封装到实体对象中：</strong> 在 Order 和 AfterSales 实体类中添加了用于承载查询条件的属性 (如 id, state, custName, itemName 等)，以及分页参数 (pageNum, pageSize)。在 Service 层和 Mapper 接口中，直接传递这个包含所有查询条件的实体对象。</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 顶级sql统计客户历史消费总额 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryCountHisDataMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.dto.HisData&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> cust_id custId, <span class="built_in">sum</span>(pay_money) hisTotal <span class="keyword">from</span> t_order <span class="keyword">group</span> <span class="keyword">by</span> cust_id</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryOrderListMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.Order&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> ord.<span class="operator">*</span>,customer.cust_name custName,</span><br><span class="line">           item.item_name itemName <span class="keyword">from</span> t_customer customer</span><br><span class="line">                                            <span class="keyword">inner</span> <span class="keyword">join</span> t_order ord <span class="keyword">on</span> customer.id<span class="operator">=</span>ord.cust_id</span><br><span class="line">                                            <span class="keyword">inner</span> <span class="keyword">join</span> t_item item <span class="keyword">on</span> item.id<span class="operator">=</span>ord.item_id</span><br><span class="line">    <span class="operator">&lt;</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;id!=null&quot;<span class="operator">&gt;</span></span><br><span class="line">            ord.id<span class="operator">=</span>#&#123;id&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;state!=null and state!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> state<span class="operator">=</span>#&#123;state&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;custName!=null and custName!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> cust_name<span class="operator">=</span>#&#123;custName&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;itemName!=null and itemName!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> item_name<span class="operator">=</span>#&#123;itemName&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>修改对应 service 接口，用 order 实体类封装</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理订单数据动态多条件分页查询*/</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryOrderListService</span><span class="params">(Integer pageNum,Integer pageSize,Order order)</span>;</span><br></pre></td></tr></table></figure><p>修改 service 对应实现，用 order 实体类封装</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryOrderListService</span><span class="params">(Integer pageNum, Integer pageSize,Order order)</span> &#123;<span class="comment">//封装</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定分页参数</span></span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    List&lt;Order&gt; orderList = orderMapper.queryOrderListMapper(order);<span class="comment">//封装</span></span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;orderList&quot;</span>,orderList);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>修改对应 Controller，改用 post 请求方法，用 order 封装参数</strong></p><p>引用外部资源方便理解：<br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/vipstone/p/16545771.html">面试突击 71：GET 和 POST 有什么区别？</a></p><p><strong>节选内容：两个方法最本质的区别</strong></p><p><strong>GET 和 POST 最本质的区别是“约定和规范”上的区别，在规范中，定义 GET 请求是用来获取资源的，也就是进行查询操作的，而 POST 请求是用来传输实体对象的，因此会使用 POST 来进行添加、修改和删除等操作</strong>。<br>当然如果严格按照规范来说，删除操作应该使用 DELETE 请求才对，但在实际开发中，使用 POST 来进行删除的用法更常见一些。<br><u><strong>按照约定来说，GET 和 POST 的参数传递也是不同的，GET 请求是将参数拼加到 URL 上进行参数传递的，而 POST 是将请参数写入到请求正文中传递的</strong>，</u></p><p>虽然 GET 也可以传递复杂对象（通过序列化到 URL），但 POST 更符合将“实体对象”作为请求体传输的语义，尤其当查询条件较多或可能包含特殊字符时，POST 更为健壮和推荐。同时，这也为将来可能的更复杂查询参数（比如范围查询、排序等）留下了扩展空间。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/* 处理分页查询请求 */</span></span><br><span class="line"><span class="comment">//    @GetMapping(&quot;/listOrder&quot;)</span></span><br><span class="line"><span class="comment">//    public Map&lt;String, Object&gt; listOrders(</span></span><br><span class="line"><span class="comment">//            @RequestParam(defaultValue = &quot;1&quot;) Integer pageNum,</span></span><br><span class="line"><span class="comment">//            @RequestParam(defaultValue = &quot;3&quot;) Integer pageSize) &#123;</span></span><br><span class="line"><span class="comment">//        return orderService.queryOrderListService(pageNum, pageSize);</span></span><br><span class="line"><span class="comment">//    &#125;</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/listOrder&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">listOrders</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderService.queryOrderListService(order.getPageNum(),order.getPageSize(),order);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-7"><a class="markdownIt-Anchor" href="#前端实现-7"></a> 前端实现</h4><p><strong>修改对应页面代码</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>客户订单列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加条件查询表单 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:inline</span>=<span class="string">&quot;true&quot;</span> <span class="attr">:model</span>=<span class="string">&quot;condForm&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;订单号&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;condForm.id&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;订单状态&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 22%&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;condForm.state&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择订单状态....&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;未出库&quot;</span> <span class="attr">value</span>=<span class="string">&quot;未出库&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;已出库&quot;</span> <span class="attr">value</span>=<span class="string">&quot;已出库&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;配送中&quot;</span> <span class="attr">value</span>=<span class="string">&quot;配送中&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;已收货&quot;</span> <span class="attr">value</span>=<span class="string">&quot;已收货&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;客户姓名&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;condForm.custName&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;condForm.itemName&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subQueryCond&quot;</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span></span></span><br><span class="line"><span class="tag">/&gt;</span><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改对应方法：</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 加载订单列表</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadOrderList</span>(<span class="params">pageNum</span>) &#123;</span><br><span class="line">  condForm.<span class="property">pageNum</span> = pageNum;</span><br><span class="line">  axios</span><br><span class="line">    <span class="comment">// .get(`http://localhost:8080/listOrder?pageNum=$&#123;pageNum&#125;`)</span></span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/listOrder&quot;</span>, condForm)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      orderList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">orderList</span>;</span><br><span class="line">      total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加条件查询方法</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明保存查询条件的表单数据</span></span><br><span class="line"><span class="keyword">const</span> condForm = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">id</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">state</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义函数提交动态查询条件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subQueryCond</span>(<span class="params"></span>) &#123;</span><br><span class="line">  condForm.<span class="property">pageNum</span> = <span class="number">1</span>; <span class="comment">//将原来页码重置为1</span></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/listOrder&quot;</span>, condForm)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      orderList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">orderList</span>;</span><br><span class="line">      total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3实现客户投诉页的基本显示"><a class="markdownIt-Anchor" href="#3实现客户投诉页的基本显示"></a> 3.实现客户投诉页的基本显示</h3><h4 id="后端实现-8"><a class="markdownIt-Anchor" href="#后端实现-8"></a> 后端实现</h4><p><strong>修改数据库，把 record 字段名改为 grade</strong></p><p><strong>修改对应实体类的相关字段</strong>，添加几个字段</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="comment">/**</span></span><br><span class="line"><span class="comment">   * 紧急程度</span></span><br><span class="line"><span class="comment">   */</span></span><br><span class="line">  <span class="keyword">private</span> String grade;</span><br><span class="line"><span class="comment">//添加字段</span></span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> String custName;</span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> Integer pageNum=<span class="number">1</span>;</span><br><span class="line">  <span class="meta">@TableField(exist = false)</span></span><br><span class="line">  <span class="keyword">private</span> Integer pageSize=<span class="number">3</span>;</span><br></pre></td></tr></table></figure><p><strong>在对应 mapper 接口里新增方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现售后数据多条件分页查询*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;AfterSales&gt; <span class="title function_">queryAfterSaleMapper</span><span class="params">(AfterSales afterSales)</span>;</span><br></pre></td></tr></table></figure><p><strong>在 mapper.xml 里实现方法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryAfterSaleMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.AfterSales&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> aft.<span class="operator">*</span>,customer.cust_name custName <span class="keyword">from</span> t_customer customer</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_after_sales aft <span class="keyword">on</span> customer.id<span class="operator">=</span>aft.cust_id</span><br><span class="line">    <span class="operator">&lt;</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;id!=null&quot;<span class="operator">&gt;</span></span><br><span class="line">            aft.id<span class="operator">=</span>#&#123;id&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;question!=null and question!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> question<span class="operator">=</span>#&#123;question&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;state!=null and state!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> state<span class="operator">=</span>#&#123;state&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;grade!=null and grade!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> aft.grade<span class="operator">=</span>#&#123;grade&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在对应 service 接口里新增方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现客户投诉信息分页查询*/</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryAfterSaleListService</span><span class="params">(AfterSales afterSales)</span>;</span><br></pre></td></tr></table></figure><p><strong>在对应 impl 里实现 service 方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> AfterSalesMapper afterSalesMapper;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryAfterSaleListService</span><span class="params">(AfterSales afterSales)</span> &#123;</span><br><span class="line">    <span class="comment">//指定分页查询参数</span></span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(afterSales.getPageNum(), afterSales.getPageSize());</span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    List&lt;AfterSales&gt; afterSalesList = afterSalesMapper.queryAfterSaleMapper(afterSales);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;afterSalesList&quot;</span>,afterSalesList);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加并实现 AfterSaleController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AfterSaleController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AfterSalesService afterSalesService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理投诉信息分页查询请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/listAfterSale&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">listAfterSales</span><span class="params">(<span class="meta">@RequestBody</span> AfterSales afterSales)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> afterSalesService.queryAfterSaleListService(afterSales);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-8"><a class="markdownIt-Anchor" href="#前端实现-8"></a> 前端实现</h4><p><strong>新增 ListAfterSale.vue 页面</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;h2&gt;客户投诉列表&lt;/h2&gt;</span><br><span class="line">  &lt;el-form :inline=<span class="string">&quot;true&quot;</span> :model=<span class="string">&quot;condForm&quot;</span>&gt;</span><br><span class="line">    &lt;el-form-item label=<span class="string">&quot;投诉单号&quot;</span>&gt;</span><br><span class="line">      &lt;el-input v-model=<span class="string">&quot;condForm.id&quot;</span> /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=<span class="string">&quot;问题描述&quot;</span>&gt;</span><br><span class="line">      &lt;el-input v-model=<span class="string">&quot;condForm.question&quot;</span> /&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line"></span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">    &lt;el-form-item label=<span class="string">&quot;紧急程度&quot;</span> style=<span class="string">&quot;width: 22%&quot;</span>&gt;</span><br><span class="line">      &lt;el-select</span><br><span class="line">          v-model=<span class="string">&quot;condForm.grade&quot;</span></span><br><span class="line">          placeholder=<span class="string">&quot;请选择....&quot;</span>&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;普通&quot;</span> value=<span class="string">&quot;普通&quot;</span> /&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;加急&quot;</span> value=<span class="string">&quot;加急&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;el-form-item label=<span class="string">&quot;处理状态&quot;</span> style=<span class="string">&quot;width: 22%&quot;</span>&gt;</span><br><span class="line">      &lt;el-select</span><br><span class="line">          v-model=<span class="string">&quot;condForm.state&quot;</span></span><br><span class="line">          placeholder=<span class="string">&quot;请选择....&quot;</span>&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;未处理&quot;</span> value=<span class="string">&quot;未处理&quot;</span> /&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;已处理&quot;</span> value=<span class="string">&quot;已处理&quot;</span> /&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;未回访&quot;</span> value=<span class="string">&quot;未回访&quot;</span> /&gt;</span><br><span class="line">        &lt;el-option label=<span class="string">&quot;已回访&quot;</span> value=<span class="string">&quot;已回访&quot;</span> /&gt;</span><br><span class="line"></span><br><span class="line">      &lt;/el-select&gt;</span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">    &lt;br/&gt;</span><br><span class="line">    &lt;el-form-item&gt;</span><br><span class="line">      &lt;el-button type=<span class="string">&quot;primary&quot;</span> <span class="meta">@click</span>=<span class="string">&quot;subQueryAfter&quot;</span>&gt;查询&lt;/el-button&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/el-form-item&gt;</span><br><span class="line">  &lt;/el-form&gt;</span><br><span class="line"></span><br><span class="line">  &lt;hr/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;el-table :data=<span class="string">&quot;afterSaleList&quot;</span> stripe style=<span class="string">&quot;width: 100%&quot;</span>&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;id&quot;</span> label=<span class="string">&quot;投诉编号&quot;</span>/&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;custName&quot;</span> label=<span class="string">&quot;客户姓名&quot;</span>/&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;question&quot;</span> label=<span class="string">&quot;问题类型&quot;</span>/&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;state&quot;</span> label=<span class="string">&quot;处理状态&quot;</span>/&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;grade&quot;</span> label=<span class="string">&quot;紧急程度&quot;</span>/&gt;</span><br><span class="line">    &lt;el-table-column prop=<span class="string">&quot;level&quot;</span> label=<span class="string">&quot;投诉满意度&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line">    &lt;el-table-column fixed=<span class="string">&quot;right&quot;</span> label=<span class="string">&quot;操作&quot;</span> width=<span class="string">&quot;200&quot;</span>&gt;</span><br><span class="line">      &lt;template #<span class="keyword">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span><br><span class="line">        &lt;el-button link type=<span class="string">&quot;primary&quot;</span> size=<span class="string">&quot;small&quot;</span>&gt;处理</span><br><span class="line">        &lt;/el-button&gt;</span><br><span class="line">        &lt;el-button link type=<span class="string">&quot;primary&quot;</span> size=<span class="string">&quot;small&quot;</span>&gt;查看处理详情</span><br><span class="line">        &lt;/el-button&gt;</span><br><span class="line">      &lt;/template&gt;</span><br><span class="line">    &lt;/el-table-column&gt;</span><br><span class="line"></span><br><span class="line">  &lt;/el-table&gt;</span><br><span class="line">  &lt;hr/&gt;</span><br><span class="line"></span><br><span class="line">  &lt;el-pagination</span><br><span class="line">      small</span><br><span class="line">      background</span><br><span class="line">      :page-size=<span class="string">&quot;3&quot;</span></span><br><span class="line">      :pager-count=<span class="string">&quot;10&quot;</span></span><br><span class="line">      layout=<span class="string">&quot;prev, pager, next&quot;</span></span><br><span class="line">      :total=<span class="string">&quot;total&quot;</span></span><br><span class="line">      class=<span class="string">&quot;mt-4&quot;</span> <span class="meta">@current</span>-change=<span class="string">&quot;handlerSalePageChange&quot;</span>/&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line"><span class="keyword">import</span> &#123;onMounted, reactive, ref&#125; from <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"><span class="keyword">import</span> axios from <span class="string">&quot;axios&quot;</span>;</span><br><span class="line">  <span class="comment">//数据库总记录数</span></span><br><span class="line">  const total=ref(<span class="number">0</span>)</span><br><span class="line">  <span class="comment">//声明投诉列表集合</span></span><br><span class="line">  const afterSaleList=ref([]);</span><br><span class="line">  <span class="comment">//定义封装查询条件的表单对象</span></span><br><span class="line">  const condForm=reactive(&#123;</span><br><span class="line">    id:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    question:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    grade:<span class="string">&#x27;&#x27;</span>,</span><br><span class="line">    level:<span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//定义函数发生ajax请求</span></span><br><span class="line">  function <span class="title function_">queryAfterSaleList</span><span class="params">(pageNum)</span>&#123;</span><br><span class="line">    condForm.pageNum=pageNum;</span><br><span class="line">    axios.post(<span class="string">&quot;http://localhost:8080/listAfterSale&quot;</span>, condForm)</span><br><span class="line">    .then((response)=&gt;&#123;</span><br><span class="line">      afterSaleList.value=response.data.afterSalesList;</span><br><span class="line">      total.value=response.data.total;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="keyword">catch</span>((error)=&gt;&#123;</span><br><span class="line">      console.log(error);</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//加载视图进行调用</span></span><br><span class="line">  onMounted(function()&#123;</span><br><span class="line">    queryAfterSaleList(<span class="number">1</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//定义函数提交分页请求</span></span><br><span class="line">  function <span class="title function_">handlerSalePageChange</span><span class="params">(pageNum)</span>&#123;</span><br><span class="line">    queryAfterSaleList(pageNum);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">//定义函数提交查询条件</span></span><br><span class="line">  function <span class="title function_">subQueryAfter</span><span class="params">()</span>&#123;</span><br><span class="line">    queryAfterSaleList(<span class="number">1</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;</span><br><span class="line"></span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p><strong>在主页中注册新增页面</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListAfterSale.vue&quot;</span>; <span class="comment">// 导入 &quot;客户投诉列表&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法，修改以下内容:</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  <span class="title class_">ListAfterSale</span>,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  ,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法，修改以下内容：</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="day5-学了什么"><a class="markdownIt-Anchor" href="#day5-学了什么"></a> Day5 学了什么</h3><ul><li><strong>实现更强大和灵活的后端动态条件查询</strong>，使用 MyBatis 的<where>和<if>标签，并将查询条件封装在实体对象中。</if></where></li><li><strong>理解并实践了后端接口接收复杂查询参数的不同方式</strong> (从 GET + @RequestParam 到 POST + @RequestBody)。</li><li><strong>前端如何构建多条件查询界面</strong>，并收集用户输入的条件发送给后端。</li><li><strong>初步了解了后端如何通过注解（如 @JsonFormat）控制数据（如日期）在 JSON 序列化时的格式</strong>。</li><li><strong>进一步熟练了多表关联查询和在 POJO 中添加非数据库字段来封装结果</strong>。</li></ul><h2 id="day6"><a class="markdownIt-Anchor" href="#day6"></a> Day6</h2><h3 id="1客户投诉页添加处理操作"><a class="markdownIt-Anchor" href="#1客户投诉页添加处理操作"></a> 1.客户投诉页添加处理操作</h3><h4 id="后端实现-9"><a class="markdownIt-Anchor" href="#后端实现-9"></a> 后端实现</h4><p><strong>新增用户反馈表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_replay` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;反馈/评价ID (主键)&#x27;</span>,</span><br><span class="line">  `content` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_unicode_ci <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;反馈或评价内容&#x27;</span>,</span><br><span class="line">  `redate` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;反馈或评价日期时间&#x27;</span>,</span><br><span class="line">  `score` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;评分 (如：1-5分)&#x27;</span>,</span><br><span class="line">  `ques_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;问题ID，对应after_sales表&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_unicode_ci COMMENT<span class="operator">=</span><span class="string">&#x27;用户反馈/评价表&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>在 idea 里用 mybatiesx 生成此表的三个层级代码</strong></p><p>新增对应控制层代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ReplayController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ReplayService replayService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*定义方法处理投诉回复的请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveReplay&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveReplay</span><span class="params">(<span class="meta">@RequestBody</span> Replay replay)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;操作失败.....&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            replay.setRedate(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">            replay.setScore(ThreadLocalRandom.current().nextInt(<span class="number">1</span>,<span class="number">6</span>));</span><br><span class="line">            replayService.save(replay);</span><br><span class="line"></span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;处理投诉回复成功......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-9"><a class="markdownIt-Anchor" href="#前端实现-9"></a> 前端实现</h4><p><strong>添加处理按钮绑定事件</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">  <span class="attr">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">click</span>=<span class="string">&quot;openReplayDialog(scope.row.id)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>处理&lt;/el-button</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><strong>添加对话框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">  <span class="attr">small</span></span></span><br><span class="line"><span class="tag">  <span class="attr">background</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">current-change</span>=<span class="string">&quot;handlerSalePageChange&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- 添加对话框控件 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 回显客户信息的对话框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogReplayVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>恢复客户投诉<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 对话框中添加form --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;replayForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;回复内容&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;replayForm.content&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%;height: 120px&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">type</span>=<span class="string">&quot;textarea&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subReplayForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加相关触发逻辑</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义对话框状态</span></span><br><span class="line">  const dialogReplayVisible=ref(<span class="literal">false</span>);</span><br><span class="line">  <span class="comment">//定义对话框中form表单</span></span><br><span class="line">  const replayForm=reactive(&#123;</span><br><span class="line">    content:<span class="string">&#x27;&#x27;</span></span><br><span class="line">  &#125;);</span><br><span class="line">  <span class="comment">//定义函数打开对话框</span></span><br><span class="line">  function <span class="title function_">openReplayDialog</span><span class="params">(qid)</span>&#123;</span><br><span class="line">    dialogReplayVisible.value=<span class="literal">true</span>;</span><br><span class="line">    replayForm.quesId=qid;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>添加发送请求到后端的代码</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送ajax请求</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">subReplayForm</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">//发送aajx请求</span></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8081/saveReplay&quot;</span>, replayForm)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        dialogReplayVisible.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">msg</span>);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">msg</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2加载问题回复列表"><a class="markdownIt-Anchor" href="#2加载问题回复列表"></a> 2.加载问题回复列表</h3><h4 id="后端实现-10"><a class="markdownIt-Anchor" href="#后端实现-10"></a> 后端实现</h4><p><strong>修改 Replay 实体类，使前端能正确解析时间</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 反馈或评价日期时间</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date redate;</span><br></pre></td></tr></table></figure><p><strong>service 接口添加</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*根据投诉id。查询投诉回复列表*/</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryReplayListService</span><span class="params">(Integer id</span></span><br><span class="line"><span class="params">        , Integer pageNum, Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现 service 方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ReplayMapper  replayMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryReplayListService</span><span class="params">(Integer id</span></span><br><span class="line"><span class="params">            , Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">        Page&lt;Replay&gt; page=<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize);</span><br><span class="line">        <span class="comment">//封装whrer条件</span></span><br><span class="line">        QueryWrapper&lt;Replay&gt; wrapper</span><br><span class="line">                =<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;ques_id&quot;</span>,id); <span class="comment">//where ques_id=?</span></span><br><span class="line">        <span class="comment">//指定分页参数</span></span><br><span class="line">        List&lt;Replay&gt; replayList = replayMapper.selectList(page, wrapper);</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">        result.put(<span class="string">&quot;replayList&quot;</span>,replayList);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>添加 Controller 接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理回复列表分页查询请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/listReplay&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">listReplay</span><span class="params">(Integer id</span></span><br><span class="line"><span class="params">        , <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">        , <span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> replayService.queryReplayListService(id, pageNum, pageSize);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-10"><a class="markdownIt-Anchor" href="#前端实现-10"></a> 前端实现</h4><p><strong>添加对话框组件</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 添加对话框控件 --&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 回复列表对话框 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogReplayListVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>回复列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-text</span>&gt;</span>投诉人:&#123;&#123;question.custName&#125;&#125;<span class="tag">&lt;/<span class="name">el-text</span>&gt;</span><span class="tag">&lt;<span class="name">br</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-text</span>&gt;</span>投诉问题:&#123;&#123;question.quesDesc&#125;&#125;<span class="tag">&lt;/<span class="name">el-text</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--   table    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;replaysList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;编号&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;redate&quot;</span> <span class="attr">label</span>=<span class="string">&quot;时间&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;score&quot;</span> <span class="attr">label</span>=<span class="string">&quot;评分&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;content&quot;</span> <span class="attr">label</span>=<span class="string">&quot;内容&quot;</span> /&gt;</span></span><br><span class="line">      <span class="comment">&lt;!--        &lt;el-table-column fixed=&quot;right&quot; label=&quot;操作&quot; width=&quot;200&quot;&gt;</span></span><br><span class="line"><span class="comment">          &lt;template #default=&quot;scope&quot;&gt;</span></span><br><span class="line"><span class="comment">            &lt;el-button link type=&quot;primary&quot; size=&quot;small&quot;</span></span><br><span class="line"><span class="comment">                       @click=&quot;openReplayDialog(scope.row.id)&quot;&gt;处理</span></span><br><span class="line"><span class="comment">            &lt;/el-button&gt;</span></span><br><span class="line"><span class="comment">            &lt;el-button link type=&quot;primary&quot; size=&quot;small&quot;</span></span><br><span class="line"><span class="comment">                       @click=&quot;loadQuestionReplayList(scope.row)&quot;&gt;查看处理详情</span></span><br><span class="line"><span class="comment">            &lt;/el-button&gt;</span></span><br><span class="line"><span class="comment">          &lt;/template&gt;</span></span><br><span class="line"><span class="comment">        &lt;/el-table-column&gt;--&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--   分页    --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">      <span class="attr">small</span></span></span><br><span class="line"><span class="tag">      <span class="attr">background</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:total</span>=<span class="string">&quot;totalReplay&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">current-change</span>=<span class="string">&quot;handlerReplayPageChange&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加对应处理方法</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义回复列表对话框状态</span></span><br><span class="line"><span class="keyword">const</span> dialogReplayListVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">//定义回显投诉人和投诉内容的对象数据</span></span><br><span class="line"><span class="keyword">const</span> question = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">custName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">quesDesc</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//定义total。保存回复总记录数</span></span><br><span class="line"><span class="keyword">const</span> totalReplay = <span class="title function_">ref</span>(<span class="number">0</span>);</span><br><span class="line"><span class="comment">//定义回复列表数据</span></span><br><span class="line"><span class="keyword">const</span> replaysList = <span class="title function_">ref</span>([]);</span><br><span class="line"><span class="comment">//声明变量保存投诉id</span></span><br><span class="line"><span class="keyword">let</span> qid = <span class="number">0</span>;</span><br><span class="line"><span class="comment">//打开对话框加载恢复列表</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadQuestionReplayList</span>(<span class="params">row</span>) &#123;</span><br><span class="line">  dialogReplayListVisible.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">  question.<span class="property">custName</span> = row.<span class="property">custName</span>;</span><br><span class="line">  question.<span class="property">quesDesc</span> = row.<span class="property">question</span>;</span><br><span class="line">  qid = row.<span class="property">id</span>;</span><br><span class="line">  <span class="comment">//发送ajax请求</span></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/listReplay?id=&quot;</span> + row.<span class="property">id</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      replaysList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">replayList</span>;</span><br><span class="line">      totalReplay.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//提交分页查询参数的请求</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handlerReplayPageChange</span>(<span class="params">pageNum</span>) &#123;</span><br><span class="line">  <span class="comment">//发送ajax请求</span></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/listReplay?id=&quot;</span> + qid + <span class="string">&quot;&amp;pageNum=&quot;</span> + pageNum)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      replaysList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">replayList</span>;</span><br><span class="line">      totalReplay.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3rbac-权限控制"><a class="markdownIt-Anchor" href="#3rbac-权限控制"></a> 3.RBAC 权限控制</h3><p>权限控制：</p><ul><li>不同用户登录系统可以使用的系统资源不一样。</li><li>不同用户登录系统看到的左边菜单不一样。 建立起用户和菜单表的关系，建立用户表和菜单表的关联关系。</li></ul><h4 id="后端实现-11"><a class="markdownIt-Anchor" href="#后端实现-11"></a> 后端实现</h4><p><strong>添加四个表</strong></p><p>这些表共同构建了一个<strong>基于角色的权限控制 (RBAC)</strong> 系统：</p><ul><li><p><strong>t_user</strong> 存储用户账号，</p></li><li><p><strong>t_roler</strong> 定义不同的角色，</p></li><li><p>之前的<strong>t_menus</strong> 表示系统中的菜单或资源。</p></li><li><p><strong>t_user_role</strong> 表连接用户和他们拥有的角色（一个用户可有多个角色），</p><p>而 <strong>t_role_menu</strong> 表连接角色和他们被授权访问的菜单（一个角色可访问多个菜单），从而决定了用户通过角色能够看到和操作哪些菜单功能。</p></li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_role_menu`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;关联ID (主键)&#x27;</span>,</span><br><span class="line">  `rid` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色ID (关联t_roler.id)&#x27;</span>,</span><br><span class="line">  `mid` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;菜单ID (关联t_menus.id)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span> COMMENT <span class="operator">=</span> <span class="string">&#x27;角色菜单关联表 (定义角色拥有的菜单权限)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_roler`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;角色ID (主键)&#x27;</span>,</span><br><span class="line">  `rname` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色名称&#x27;</span>,</span><br><span class="line">  `rdesc` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色描述&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span> COMMENT <span class="operator">=</span> <span class="string">&#x27;角色信息表 (权限管理)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_user`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;用户ID (主键)&#x27;</span>,</span><br><span class="line">  `uname` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户名&#x27;</span>,</span><br><span class="line">  `upwd` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户密码&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">11</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;手机号&#x27;</span>,</span><br><span class="line">  `edu` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;学历&#x27;</span>,</span><br><span class="line">  `age` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;年龄&#x27;</span>,</span><br><span class="line">  `title` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">CHARACTER SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_0900_ai_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;职位&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span> COMMENT <span class="operator">=</span> <span class="string">&#x27;用户信息表 (系统用户)&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_user_role`  (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;关联ID (主键)&#x27;</span>,</span><br><span class="line">  `uid` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;用户ID (关联t_user.id)&#x27;</span>,</span><br><span class="line">  `rid` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;角色ID (关联t_roler.id)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8mb4 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8mb4_0900_ai_ci ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span> COMMENT <span class="operator">=</span> <span class="string">&#x27;用户角色关联表 (分配用户角色)&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>用 mybatiesx 插件生成对应代码</strong></p><h2 id="day7"><a class="markdownIt-Anchor" href="#day7"></a> Day7</h2><h3 id="0美化主页"><a class="markdownIt-Anchor" href="#0美化主页"></a> 0.美化主页</h3><p>主页代码修改：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 模块导入 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/AddCustomer.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/ListCustomer.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/AddSellJh.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/ListSellJh.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListCustOrder</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/ListCustOrder.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Custom_Manage/ListAfterSale.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddMenus</span> <span class="keyword">from</span> <span class="string">&quot;@/views/Sys_Manage/AddMenus.vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Vue核心</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; computed, onMounted, ref, watch &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; markRaw, shallowRef &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// HTTP客户端</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// Element Plus 图标</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Folder</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Document</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Menu</span> <span class="keyword">as</span> <span class="title class_">MenuIcon</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">HomeFilled</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Refresh</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125; <span class="keyword">from</span> <span class="string">&quot;@element-plus/icons-vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// API基础URL</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="variable constant_">API_BASE_URL</span> = <span class="string">&quot;http://localhost:8080&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 组件映射与状态定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> viewComponents = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">addCustomer</span>: <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">listCustomer</span>: <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">listAfterSale</span>: <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">listCustOrder</span>: <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">addSellJh</span>: <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">addMenus</span>: <span class="title function_">markRaw</span>(<span class="title class_">AddMenus</span>),</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">listSellJh</span>: <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> views = [</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addCustomer</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">listCustomer</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">listAfterSale</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">listCustOrder</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">listSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addMenus</span>,</span></span><br><span class="line"><span class="language-javascript">    viewComponents.<span class="property">addSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">  ];</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> currentComponent = <span class="title function_">shallowRef</span>(views[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> currentComponentIndex = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> menus = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> isLoading = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> error = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 方法定义 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">handlerSelect</span> = <span class="keyword">async</span> (<span class="params">index</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      error.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/compIndex`</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">params</span>: &#123; <span class="attr">id</span>: index &#125;,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">timeout</span>: <span class="number">5000</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> compIndex = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (compIndex &gt;= <span class="number">0</span> &amp;&amp; compIndex &lt; views.<span class="property">length</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        currentComponentIndex.<span class="property">value</span> = compIndex;</span></span><br><span class="line"><span class="language-javascript">        currentComponent.<span class="property">value</span> = views[compIndex];</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`Invalid component index received: <span class="subst">$&#123;compIndex&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">        error.<span class="property">value</span> = <span class="string">&quot;无法加载请求的组件&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Failed to fetch component index:&quot;</span>, err);</span></span><br><span class="line"><span class="language-javascript">      error.<span class="property">value</span> = <span class="string">&quot;加载组件失败，请稍后再试&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">fetchMenus</span> = <span class="keyword">async</span> (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      isLoading.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      error.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">get</span>(<span class="string">`<span class="subst">$&#123;API_BASE_URL&#125;</span>/listMenus`</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">timeout</span>: <span class="number">5000</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      menus.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      isLoading.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (err) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Failed to fetch menus:&quot;</span>, err);</span></span><br><span class="line"><span class="language-javascript">      error.<span class="property">value</span> = <span class="string">&quot;加载菜单失败，请刷新页面重试&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">      menus.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">      isLoading.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> hasMenus = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> menus.<span class="property">value</span> &amp;&amp; menus.<span class="property">value</span>.<span class="property">length</span> &gt; <span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">watch</span>(error, <span class="function">(<span class="params">newError</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (newError) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        error.<span class="property">value</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;, <span class="number">5000</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义默认展开的菜单项</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> defaultOpeneds = <span class="title function_">computed</span>(<span class="function">() =&gt;</span></span></span><br><span class="line"><span class="language-javascript">    menus.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">menu</span>) =&gt;</span> menu.<span class="property">id</span>.<span class="title function_">toString</span>())</span></span><br><span class="line"><span class="language-javascript">  );</span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">fetchMenus</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;app-container&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">class</span>=<span class="string">&quot;main-container&quot;</span>&gt;</span></span><br><span class="line">      <span class="comment">&lt;!-- 顶部Header区域 --&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-header</span> <span class="attr">class</span>=<span class="string">&quot;app-header&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;header-content&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-icon</span> <span class="attr">class</span>=<span class="string">&quot;header-icon&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">HomeFilled</span> /&gt;</span><span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">h1</span> <span class="attr">class</span>=<span class="string">&quot;app-title&quot;</span>&gt;</span>ERP管理系统<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;app-subtitle&quot;</span>&gt;</span>ikun小组<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-header</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-container</span> <span class="attr">class</span>=<span class="string">&quot;content-container&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 左侧Aside区域 (导航菜单) --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">&quot;240px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;app-sidebar&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;menu-header&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span><span class="tag">&lt;<span class="name">MenuIcon</span> /&gt;</span><span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">            系统菜单</span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 加载状态 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-skeleton</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:loading</span>=<span class="string">&quot;isLoading &amp;&amp; !hasMenus&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">animated</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:count</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;isLoading &amp;&amp; !hasMenus&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span> #<span class="attr">template</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;padding: 12px&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-skeleton-item</span> <span class="attr">variant</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 90%&quot;</span> /&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 24px; margin-top: 12px&quot;</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">el-skeleton-item</span> <span class="attr">variant</span>=<span class="string">&quot;text&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">el-skeleton-item</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">variant</span>=<span class="string">&quot;text&quot;</span></span></span><br><span class="line"><span class="tag">                    <span class="attr">style</span>=<span class="string">&quot;width: 80%; margin-top: 8px&quot;</span></span></span><br><span class="line"><span class="tag">                  /&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-skeleton</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 错误提示 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-alert</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;error &amp;&amp; !hasMenus&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:title</span>=<span class="string">&quot;error&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">&quot;error&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">show-icon</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">close</span>=<span class="string">&quot;error = null&quot;</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 菜单内容 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-menu</span></span></span><br><span class="line"><span class="tag">            <span class="attr">class</span>=<span class="string">&quot;app-menu&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">select</span>=<span class="string">&quot;handlerSelect&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;hasMenus&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:default-active</span>=<span class="string">&quot;&#x27;1&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">unique-opened</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:default-openeds</span>=<span class="string">&quot;defaultOpeneds&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-sub-menu</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:key</span>=<span class="string">&quot;menu.id&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">:index</span>=<span class="string">&quot;menu.id.toString()&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">template</span> #<span class="attr">title</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span><span class="tag">&lt;<span class="name">Folder</span> /&gt;</span><span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; menu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-menu-item</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;subMenu in menu.subMenu&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;subMenu.id&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:index</span>=<span class="string">&quot;subMenu.id.toString()&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span><span class="tag">&lt;<span class="name">Document</span> /&gt;</span><span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; subMenu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-sub-menu</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 空菜单提示 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-empty</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;!isLoading &amp;&amp; hasMenus === false &amp;&amp; !error&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">description</span>=<span class="string">&quot;暂无菜单数据&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">:icon</span>=<span class="string">&quot;Refresh&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;fetchMenus&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span>刷新&lt;/el-button</span><br><span class="line">            &gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-empty</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">&lt;!-- 主内容区域 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-main</span> <span class="attr">class</span>=<span class="string">&quot;app-main&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!-- 加载状态 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">v-if</span>=<span class="string">&quot;isLoading&quot;</span> <span class="attr">class</span>=<span class="string">&quot;loading-overlay&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-skeleton</span> <span class="attr">animated</span> <span class="attr">:rows</span>=<span class="string">&quot;8&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 错误提示 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-alert</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-if</span>=<span class="string">&quot;error &amp;&amp; currentComponent.value&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:title</span>=<span class="string">&quot;error&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">type</span>=<span class="string">&quot;error&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">show-icon</span></span></span><br><span class="line"><span class="tag">            <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 16px&quot;</span></span></span><br><span class="line"><span class="tag">            @<span class="attr">close</span>=<span class="string">&quot;error = null&quot;</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!-- 动态组件渲染 --&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;component-container&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;currentComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">keep-alive</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 全局布局 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#f0f2f5</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.main-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.content-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="built_in">calc</span>(<span class="number">100vh</span> - <span class="number">64px</span>);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 头部样式 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">64px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(<span class="number">90deg</span>, <span class="number">#2b5aff</span>, <span class="number">#409eff</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.1</span>);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.header-content</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">gap</span>: <span class="number">12px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.header-icon</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-title</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">1.6rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">700</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">letter-spacing</span>: <span class="number">0.5px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-subtitle</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">0.95rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">400</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">opacity</span>: <span class="number">0.85</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 侧边栏样式 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-sidebar</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-right</span>: <span class="number">1px</span> solid <span class="number">#e8ecef</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: width <span class="number">0.3s</span> ease;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">2px</span> <span class="number">0</span> <span class="number">8px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.05</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">scrollbar-width</span>: none; <span class="comment">/* Firefox */</span></span></span><br><span class="line"><span class="language-css">    -ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* IE and Edge */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-sidebar</span>::-webkit-scrollbar &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none; <span class="comment">/* Chrome, Safari, Opera */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.menu-header</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">16px</span> <span class="number">20px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">600</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">1.15rem</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#303133</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-bottom</span>: <span class="number">1px</span> solid <span class="number">#e8ecef</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">gap</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-menu</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-right</span>: none;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: transparent;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-menu</span> :<span class="built_in">deep</span>(.el-sub-menu__title),</span></span><br><span class="line"><span class="language-css">  .app-menu :<span class="built_in">deep</span>(.el-menu-item) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#303133</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">0.95rem</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-menu</span> :<span class="built_in">deep</span>(.el-sub-menu__title:hover),</span></span><br><span class="line"><span class="language-css">  .app-menu :<span class="built_in">deep</span>(.el-menu-item:hover) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#e6f0ff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#2b5aff</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-menu</span> :<span class="built_in">deep</span>(.el-menu-item.is-active) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#e6f0ff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="number">#2b5aff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-weight</span>: <span class="number">500</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 主内容区域 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-main</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="number">#ffffff</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow-y</span>: auto;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: relative;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">margin</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">2px</span> <span class="number">12px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.06</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">scrollbar-width</span>: none; <span class="comment">/* Firefox */</span></span></span><br><span class="line"><span class="language-css">    -ms-<span class="attribute">overflow</span>-style: none; <span class="comment">/* IE and Edge */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.app-main</span>::-webkit-scrollbar &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: none; <span class="comment">/* Chrome, Safari, Opera */</span></span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 加载状态 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.loading-overlay</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">position</span>: absolute;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">top</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">left</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">right</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.95</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">z-index</span>: <span class="number">10</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding</span>: <span class="number">24px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex-direction</span>: column;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: center;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 组件容器 */</span></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.component-container</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">width</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">100%</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="comment">/* 响应式调整 */</span></span></span><br><span class="line"><span class="language-css">  <span class="keyword">@media</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.app-sidebar</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">width</span>: <span class="number">200px</span> <span class="meta">!important</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.app-header</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.app-title</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">font-size</span>: <span class="number">1.3rem</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">    <span class="selector-class">.app-main</span> &#123;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">margin</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">      <span class="attribute">padding</span>: <span class="number">16px</span>;</span></span><br><span class="line"><span class="language-css">    &#125;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="1接口测试工具-postman-的安装和使用"><a class="markdownIt-Anchor" href="#1接口测试工具-postman-的安装和使用"></a> 1.接口测试工具 Postman 的安装和使用</h3><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/softwaretesterpz/p/13205666.html">API 测试之 Postman 使用完全指南(Postman 教程，这篇文章就够了)</a></p><p>建议使用 Apifox，对中文友好</p><p><a target="_blank" rel="noopener" href="https://apifox.com/">Apifox 下载地址</a></p><p><a target="_blank" rel="noopener" href="https://apifox.com/blog/how-to-send-json-in-apifox/#1%E6%96%B0%E5%BB%BA-post-%E8%AF%B7%E6%B1%82">Apifox 如何发送 json 格式的 post 请求？</a></p><p><a target="_blank" rel="noopener" href="https://apifox.com/blog/a-cup-of-tea-time-to-understand-restful-api/#rest">什么是 RESTful API</a></p><h3 id="2-实现系统菜单节点管理页面"><a class="markdownIt-Anchor" href="#2-实现系统菜单节点管理页面"></a> 2 实现系统菜单节点管理页面</h3><p>根据教程<a target="_blank" rel="noopener" href="https://www.cnblogs.com/cjsblog/p/14714444.html">树形结构的菜单表设计与查询</a>和 ai 辅助，修改方法如下</p><h4 id="后端实现-12"><a class="markdownIt-Anchor" href="#后端实现-12"></a> 后端实现</h4><p><strong>数据库修改菜单表，添加几个条目</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">DROP</span> <span class="keyword">TABLE</span> IF <span class="keyword">EXISTS</span> `t_menu`;</span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_menu` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID (主键)&#x27;</span>,</span><br><span class="line">  `label` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;导航名称&#x27;</span>,</span><br><span class="line">  `component` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;子id&#x27;</span>,</span><br><span class="line">  `pid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;父id&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">22</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;前端菜单表&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;客户管理&#x27;</span>, <span class="keyword">NULL</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;添加客户&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;查询客户&#x27;</span>, <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;售后服务&#x27;</span>, <span class="number">2</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;客户订单&#x27;</span>, <span class="number">3</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;销售过程&#x27;</span>, <span class="number">4</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;销售过程列表&#x27;</span>, <span class="number">7</span>, <span class="number">1</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">8</span>, <span class="string">&#x27;数据统计&#x27;</span>, <span class="keyword">NULL</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">9</span>, <span class="string">&#x27;客户统计&#x27;</span>, <span class="number">5</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">10</span>, <span class="string">&#x27;库存统计&#x27;</span>, <span class="number">6</span>, <span class="number">8</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">11</span>, <span class="string">&#x27;系统管理&#x27;</span>, <span class="keyword">NULL</span>, <span class="number">0</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">12</span>, <span class="string">&#x27;添加菜单&#x27;</span>, <span class="number">8</span>, <span class="number">11</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">13</span>, <span class="string">&#x27;用户管理&#x27;</span>, <span class="number">9</span>, <span class="number">11</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`) <span class="keyword">VALUES</span> (<span class="number">14</span>, <span class="string">&#x27;角色管理&#x27;</span>, <span class="number">10</span>, <span class="number">11</span>);</span><br></pre></td></tr></table></figure><p><strong>MenuService 添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*添加菜单节点*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveMenusService</span><span class="params">(Menu menu)</span>;</span><br></pre></td></tr></table></figure><p><strong>MenuServiceImpl 实现接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveMenusService</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">    QueryWrapper&lt;Menu&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">    wrapper.select(<span class="string">&quot;max(component) maxv&quot;</span>);</span><br><span class="line">    <span class="comment">//获得component的最大值</span></span><br><span class="line">    <span class="type">Menu</span> <span class="variable">ms</span> <span class="operator">=</span> MenuMapper.selectOne(wrapper);</span><br><span class="line">    <span class="comment">//component组件属性的值，是数据库最大值加1</span></span><br><span class="line">    menu.setComponent(ms.getMaxv()+<span class="number">1</span>);</span><br><span class="line">    MenuMapper.insert(menu);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>MenusController 添加增删改方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MenuService menusService;</span><br><span class="line"><span class="comment">/*处理菜单节点信息的添加请求*/</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveMenus</span><span class="params">(<span class="meta">@RequestBody</span> Menu menu)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            menusService.saveMenusService(menu);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;添加菜单节点成功.......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理菜单节点信息的修改请求*/</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/updateMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateMenus</span><span class="params">(<span class="meta">@RequestBody</span> Menu menu)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            menusService.updateById(menu);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;修改菜单节点成功.......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理菜单节点信息的删除请求*/</span></span><br><span class="line">    <span class="meta">@CrossOrigin</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/deleteMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">deleteMenus</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            menusService.removeById(id);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;删除菜单节点成功.......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="前端实现-11"><a class="markdownIt-Anchor" href="#前端实现-11"></a> 前端实现</h4><p><strong>实现 AddMenus.vue 页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>管理菜单<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>选择新增节点的父节点:<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tree</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:props</span>=<span class="string">&quot;props&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">&quot;treeNodeList&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">default-expand-all</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:expand-on-click-node</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;treeRef&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">node-click</span>=<span class="string">&quot;hanldNodeClick&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">highlight-current</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; node, data &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;custom-tree-node&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; node.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;openEditDialog(data)&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;color: var(--el-color-primary)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              修改</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;margin-left: 8px; color: var(--el-color-danger)&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;delMenus(node, data)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              删除</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加表单控件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;menuForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;新增菜单名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;menuForm.label&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subMenuForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 修改弹窗 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;修改菜单&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;editForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;菜单名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;editForm.label&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateMenu&quot;</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义tree控件的配置参数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> props = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="string">&quot;id&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;label&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">children</span>: <span class="string">&quot;subMenu&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义tree控件节点的集合</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> treeNodeList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义添加菜单的form表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> menuForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">component</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 添加弹窗状态和编辑表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> editForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">component</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 发送ajax请求，加载菜单节点树</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadMenuTree</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listMenus&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        treeNodeList.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 声明变量保存当前选中树节点的id</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> id = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义tree控件节点的点击回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">hanldNodeClick</span>(<span class="params">node</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    id = node.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开编辑弹窗</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openEditDialog</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">id</span> = data.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">label</span> = data.<span class="property">label</span>;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">component</span> = data.<span class="property">component</span>;</span></span><br><span class="line"><span class="language-javascript">    dialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 更新菜单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">updateMenu</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">put</span>(<span class="string">&quot;http://localhost:8080/updateMenus&quot;</span>, editForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">          dialogVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>: response.<span class="property">data</span>.<span class="property">msg</span> || <span class="string">&quot;更新成功&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 重置表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">id</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">label</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">component</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    id = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 发送保存菜单的请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subMenuForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (id === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>(<span class="string">&quot;请选择当前新增菜单节点的父节点......&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">pid</span> = id;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/saveMenus&quot;</span>, menuForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>: response.<span class="property">data</span>.<span class="property">msg</span> || <span class="string">&quot;添加成功&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;添加失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 删除菜单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">delMenus</span>(<span class="params">node, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (data.<span class="property">subMenu</span> &amp;&amp; data.<span class="property">subMenu</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>(data.<span class="property">label</span> + <span class="string">&quot;,节点存在子节点不能删除.......&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">delete</span>(<span class="string">&quot;http://localhost:8080/deleteMenus?id=&quot;</span> + data.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>: response.<span class="property">data</span>.<span class="property">msg</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree-node.is-current &gt; .el-tree-node__content &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--el-color-primary-light-<span class="number">9</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="built_in">var</span>(--el-color-primary);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree-node__content:hover &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--el-fill-color-light);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attr">--el-tree-node-hover-bg-color</span>: <span class="built_in">var</span>(--el-fill-color-light);</span></span><br><span class="line"><span class="language-css">    <span class="attr">--el-tree-text-color</span>: <span class="built_in">var</span>(--el-text-color-regular);</span></span><br><span class="line"><span class="language-css">    <span class="attr">--el-tree-expand-icon-color</span>: <span class="built_in">var</span>(--el-text-color-placeholder);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.custom-tree-node</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-right</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在主页中注册新增页面</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddMenus.vue&quot;</span>; <span class="comment">// 导入 &quot;管理菜单&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法，修改以下内容:</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  <span class="title class_">ListAfterSale</span>,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  ,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">  <span class="title class_">AddMenus</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法，修改以下内容：</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddMenus</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="3实现菜单拖拽改变顺序和父子关系"><a class="markdownIt-Anchor" href="#3实现菜单拖拽改变顺序和父子关系"></a> 3.实现菜单拖拽改变顺序和父子关系</h3><h4 id="后端实现-13"><a class="markdownIt-Anchor" href="#后端实现-13"></a> 后端实现</h4><p><strong>表格添加顺序列</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> `t_menu`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> `sort_order` <span class="type">INT</span> <span class="keyword">DEFAULT</span> <span class="number">0</span> COMMENT <span class="string">&#x27;同一父节点下的排序字段，值越小越靠前&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>修改对应 pojo，添加排序字段</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 排序</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">private</span> Integer sortOrder;</span><br></pre></td></tr></table></figure><p><strong>修改对应 vo，添加父节点字段和排序字段，方便前端修改</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuVo</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> Integer pid;</span><br><span class="line">    <span class="keyword">private</span> String label;</span><br><span class="line">    <span class="keyword">private</span> Integer component;</span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuVo&gt; subMenu;</span><br><span class="line">    <span class="keyword">private</span> Integer sortOrder;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>service 添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*更新菜单顺序*/</span></span><br><span class="line">   <span class="keyword">void</span> <span class="title function_">updateMenusOrder</span><span class="params">(List&lt;MenuVo&gt; menuUpdates)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现该方法，修改之前的排序等方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">MenuServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;MenuMapper, Menu&gt; <span class="keyword">implements</span> <span class="title class_">MenuService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MenuMapper menuMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;MenuVo&gt; <span class="title function_">queryMenuListService</span><span class="params">()</span> &#123;</span><br><span class="line">        QueryWrapper&lt;Menu&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 按 pid 升序，再按 sort_order 升序</span></span><br><span class="line">        queryWrapper.orderByAsc(<span class="string">&quot;pid&quot;</span>, <span class="string">&quot;sort_order&quot;</span>);</span><br><span class="line">        List&lt;Menu&gt; allMenu = <span class="built_in">this</span>.list(queryWrapper);</span><br><span class="line">        <span class="keyword">return</span> buildSubmenu(allMenu, <span class="number">0</span>); <span class="comment">// 假设根节点的 pid 为 0</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;MenuVo&gt; <span class="title function_">buildSubmenu</span><span class="params">(List&lt;Menu&gt; allMenu, Integer parentId)</span> &#123;</span><br><span class="line">        List&lt;MenuVo&gt; submenuTree = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">// 直接从已排序的 allMenu 中筛选，它们自然保持了 sort_order 的顺序</span></span><br><span class="line">        <span class="keyword">for</span> (Menu menu : allMenu) &#123;</span><br><span class="line">            <span class="keyword">if</span> (menu.getPid() != <span class="literal">null</span> &amp;&amp; menu.getPid().equals(parentId)) &#123;</span><br><span class="line">                <span class="type">MenuVo</span> <span class="variable">menuVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MenuVo</span>();</span><br><span class="line">                BeanUtils.copyProperties(menu, menuVo);</span><br><span class="line">                <span class="comment">// 递归查找子菜单时，子菜单也已经是排序好的了</span></span><br><span class="line">                menuVo.setSubMenu(buildSubmenu(allMenu, menu.getId()));</span><br><span class="line">                submenuTree.add(menuVo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> submenuTree;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveMenusService</span><span class="params">(Menu menu)</span> &#123;</span><br><span class="line">        QueryWrapper&lt;Menu&gt; wrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;max(component) maxv&quot;</span>);</span><br><span class="line">        <span class="type">Menu</span> <span class="variable">ms</span> <span class="operator">=</span> menuMapper.selectOne(wrapper);</span><br><span class="line">        menu.setComponent(ms == <span class="literal">null</span> || ms.getMaxv() == <span class="literal">null</span> ? <span class="number">0</span> : ms.getMaxv() + <span class="number">1</span>); <span class="comment">// 处理ms或maxv为null的情况</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 设置新菜单的 sort_order，例如排在同级最后</span></span><br><span class="line">        QueryWrapper&lt;Menu&gt; countWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        countWrapper.eq(<span class="string">&quot;pid&quot;</span>, menu.getPid());</span><br><span class="line">        <span class="type">long</span> <span class="variable">count</span> <span class="operator">=</span> <span class="built_in">this</span>.count(countWrapper);</span><br><span class="line">        menu.setSortOrder((<span class="type">int</span>) count);</span><br><span class="line"></span><br><span class="line">        menuMapper.insert(menu);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 新增方法：用于处理前端拖拽后的顺序更新</span></span><br><span class="line">    <span class="meta">@Transactional</span> <span class="comment">// 保证操作的原子性</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateMenusOrder</span><span class="params">(List&lt;MenuVo&gt; menuUpdates)</span> &#123; <span class="comment">// 直接使用MenuVo作为DTO，或者创建一个专门的DTO</span></span><br><span class="line">        <span class="keyword">if</span> (menuUpdates == <span class="literal">null</span> || menuUpdates.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (MenuVo menuUpdate : menuUpdates) &#123;</span><br><span class="line">            <span class="keyword">if</span> (menuUpdate.getId() == <span class="literal">null</span>) <span class="keyword">continue</span>; <span class="comment">// ID 不能为空</span></span><br><span class="line"></span><br><span class="line">            UpdateWrapper&lt;Menu&gt; updateWrapper = <span class="keyword">new</span> <span class="title class_">UpdateWrapper</span>&lt;&gt;();</span><br><span class="line">            updateWrapper.eq(<span class="string">&quot;id&quot;</span>, menuUpdate.getId())</span><br><span class="line">                    .set(<span class="string">&quot;pid&quot;</span>, menuUpdate.getPid())</span><br><span class="line">                    .set(<span class="string">&quot;sort_order&quot;</span>, menuUpdate.getSortOrder());</span><br><span class="line">            <span class="built_in">this</span>.update(<span class="literal">null</span>, updateWrapper);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 Controller 方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理菜单节点信息的修改请求*/</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/updateMenusOrder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateMenusOrder</span><span class="params">(<span class="meta">@RequestBody</span> List&lt;MenuVo&gt; menuUpdates)</span>&#123;</span><br><span class="line">    Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">    result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;菜单顺序更新失败!&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span>&#123;</span><br><span class="line">        menuService.updateMenusOrder(menuUpdates);</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;菜单顺序更新成功!&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">        ex.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-12"><a class="markdownIt-Anchor" href="#前端实现-12"></a> 前端实现</h4><p><strong>修改 Vue 页面，使其能把调整的顺序和父子关系传到后端</strong></p><ul><li><strong>拖拽功能 (draggable, allow-drop, allow-drag, @node-drop)：</strong><ul><li>allowDrag: 控制哪些节点可以被拖拽。</li><li>allowDrop: 定义复杂的拖拽放置规则（例如，限制层级深度，判断是否允许成为子节点等）。这部分的逻辑 (getNodeLevel, isPidOfLevelOneNode 等辅助函数以及 allowDrop 内部的规则判断) 体现了对树形结构操作的细致思考。</li><li>@node-drop: 当拖拽操作完成并释放后触发此事件。在此事件的回调函数 (handleDrop) 中，处理了前端树结构的变化，并收集变更信息发送给后端进行持久化。</li></ul></li><li><strong>前后端数据同步的复杂性处理 (拖拽后)：</strong><ul><li><strong>前端先行，后端确认：</strong> el-tree 组件在拖拽操作完成后，会<strong>首先在前端内部更新其数据模型</strong>（treeNodeList.value 的结构会发生变化）。</li><li><strong>收集变更并发送：</strong> 在 @node-drop 事件触发后，前端代码需要<strong>基于这个已经变化的前端数据结构，重新计算每个节点的 pid 和 sort_order</strong>，然后将这些变更信息 (updatesToSendToBackend) 发送给后端。</li><li><strong>后端批量更新：</strong> 后端接收到这些变更信息后，进行批量数据库更新。</li><li><strong>错误处理与回滚：</strong> 如果后端更新失败，前端需要有机制从后端重新加载数据以恢复到正确的状态 (loadMenuTree())。</li></ul></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>管理菜单<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>选择新增节点的父节点（支持拖拽调整顺序）<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tree</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:props</span>=<span class="string">&quot;props&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">&quot;treeNodeList&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">default-expand-all</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:expand-on-click-node</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;treeRef&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">node-click</span>=<span class="string">&quot;hanldNodeClick&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:highlight-current</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">draggable</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:allow-drop</span>=<span class="string">&quot;allowDrop&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:allow-drag</span>=<span class="string">&quot;allowDrag&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">node-drop</span>=<span class="string">&quot;handleDrop&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; node, data &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;custom-tree-node&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; node.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;openEditDialog(data)&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;color: var(--el-color-primary)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              修改</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">a</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;margin-left: 8px; color: var(--el-color-danger)&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;delMenus(node, data)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              删除</span><br><span class="line">            <span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加表单控件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;menuForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;新增菜单名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;menuForm.label&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subMenuForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;clearTreeSelection&quot;</span> <span class="attr">style</span>=<span class="string">&quot;margin-left: 10px;&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span>取消当前选中节点&lt;/el-button</span><br><span class="line">      &gt;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 修改弹窗 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;修改菜单&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;30%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;editForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;菜单名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;editForm.label&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateMenu&quot;</span>&gt;</span>更新<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref, nextTick &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> props = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;label&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">children</span>: <span class="string">&quot;subMenu&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> treeNodeList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> treeRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> menuForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">component</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">pid</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> editForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">component</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadMenuTree</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listMenus&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        treeNodeList.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;菜单加载失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> currentSelectedPidForAdd = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">hanldNodeClick</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    currentSelectedPidForAdd = data.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// console.log(&quot;Selected parent for new node:&quot;, currentSelectedPidForAdd);</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openEditDialog</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">id</span> = data.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">label</span> = data.<span class="property">label</span>;</span></span><br><span class="line"><span class="language-javascript">    editForm.<span class="property">component</span> = data.<span class="property">component</span>;</span></span><br><span class="line"><span class="language-javascript">    dialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">updateMenu</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">put</span>(<span class="string">&quot;http://localhost:8080/updateMenus&quot;</span>, editForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">          dialogVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>:</span></span><br><span class="line"><span class="language-javascript">            response.<span class="property">data</span>.<span class="property">msg</span> ||</span></span><br><span class="line"><span class="language-javascript">            (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;更新成功&quot;</span> : <span class="string">&quot;更新失败&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;修改失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">label</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">component</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    currentSelectedPidForAdd = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (treeRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      treeRef.<span class="property">value</span>.<span class="title function_">setCurrentKey</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 取消树节点选中 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">clearTreeSelection</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (treeRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      treeRef.<span class="property">value</span>.<span class="title function_">setCurrentKey</span>(<span class="literal">null</span>); <span class="comment">// 取消 Element Plus Tree 的当前高亮节点</span></span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    currentSelectedPidForAdd = <span class="number">0</span>; <span class="comment">// 重置用于添加新节点的父节点ID</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;已取消节点选择&quot;</span>); <span class="comment">// 可选：给用户一个反馈</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subMenuForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!menuForm.<span class="property">label</span>.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;菜单名称不能为空&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    menuForm.<span class="property">pid</span> = currentSelectedPidForAdd;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/saveMenus&quot;</span>, menuForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>:</span></span><br><span class="line"><span class="language-javascript">            response.<span class="property">data</span>.<span class="property">msg</span> ||</span></span><br><span class="line"><span class="language-javascript">            (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;添加成功&quot;</span> : <span class="string">&quot;添加失败&quot;</span>),</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;添加失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">delMenus</span>(<span class="params">node, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (data.<span class="property">subMenu</span> &amp;&amp; data.<span class="property">subMenu</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(data.<span class="property">label</span> + <span class="string">&quot;, 节点存在子节点不能删除!&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">await</span> <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">`确定要删除菜单 &quot;<span class="subst">$&#123;data.label&#125;</span>&quot; 吗?`</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">delete</span>(</span></span><br><span class="line"><span class="language-javascript">        <span class="string">&quot;http://localhost:8080/deleteMenus?id=&quot;</span> + data.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">      );</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">loadMenuTree</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span> ? <span class="string">&quot;success&quot;</span> : <span class="string">&quot;error&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: response.<span class="property">data</span>.<span class="property">msg</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (error !== <span class="string">&quot;cancel&quot;</span> &amp;&amp; error !== <span class="string">&quot;close&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除操作失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;已取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 拖拽相关方法 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">allowDrag</span> = (<span class="params">draggingNode</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 辅助函数，用于getNodeLevel</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">isPidOfLevelOneNode</span> = (<span class="params">pidToCheck</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!treeNodeList.<span class="property">value</span> || treeNodeList.<span class="property">value</span>.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> treeNodeList.<span class="property">value</span>.<span class="title function_">some</span>(</span></span><br><span class="line"><span class="language-javascript">      <span class="function">(<span class="params">levelOneNode</span>) =&gt;</span> levelOneNode.<span class="property">id</span> === pidToCheck</span></span><br><span class="line"><span class="language-javascript">    );</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">getNodeLevel</span> = (<span class="params">node</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!node || !node.<span class="property">data</span> || <span class="keyword">typeof</span> node.<span class="property">data</span>.<span class="property">pid</span> === <span class="string">&quot;undefined&quot;</span>) <span class="keyword">return</span> <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (node.<span class="property">data</span>.<span class="property">pid</span> === <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">// 直接判断pid是否为0</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (node.<span class="property">data</span>.<span class="property">pid</span> !== <span class="number">0</span> &amp;&amp; <span class="title function_">isPidOfLevelOneNode</span>(node.<span class="property">data</span>.<span class="property">pid</span>)) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// isPidOfLevelOneNode 遍历 treeNodeList</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="number">2</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">// 未知或无效层级</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">allowDrop</span> = (<span class="params">draggingNode, dropNode, type</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> draggingLevel = <span class="title function_">getNodeLevel</span>(draggingNode);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> dropLevel = <span class="title function_">getNodeLevel</span>(dropNode);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 节点是否有子节点 (基于 draggingNode.data.subMenu，这依赖于后端返回的数据结构)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 或者直接检查 draggingNode (Node对象) 的 childNodes</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> draggingNodeHasChildren =</span></span><br><span class="line"><span class="language-javascript">      draggingNode.<span class="property">childNodes</span> &amp;&amp; draggingNode.<span class="property">childNodes</span>.<span class="property">length</span> &gt; <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 基本校验：无效层级或拖拽自身</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (</span></span><br><span class="line"><span class="language-javascript">      draggingLevel === <span class="number">0</span> ||</span></span><br><span class="line"><span class="language-javascript">      dropLevel === <span class="number">0</span> ||</span></span><br><span class="line"><span class="language-javascript">      draggingNode.<span class="property">key</span> === dropNode.<span class="property">key</span></span></span><br><span class="line"><span class="language-javascript">    ) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// --- 规则开始 ---</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 规则1: 拖拽一级节点 (父节点)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (draggingLevel === <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (dropLevel === <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 目标也是一级节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (type === <span class="string">&quot;inner&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 条件：允许一级节点A放入一级节点B内部，前提是A没有子节点</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 此时A将从一级降为二级</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (draggingNodeHasChildren) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// ElMessage.warning(&#x27;有子节点的父菜单不能直接成为其他父菜单的子菜单。&#x27;);</span></span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 有子节点的一级不能直接降级并带子节点进入 (避免三级)</span></span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 允许无子节点的一级节点成为另一一级节点的子节点</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 允许一级节点之间同级排序 (prev/next)</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (dropLevel === <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 目标是二级节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 通常不允许一级节点直接操作二级节点来改变层级或排序，除非特定场景</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 例如：如果想把一级节点P1放到二级节点S1的父节点下，与S1同级，</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 这种情况应该通过拖拽P1到S1的父节点P2的 prev/next/inner 来实现。</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 这里先保守禁止，一级节点不能直接以二级节点为目标改变结构。</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 规则2: 拖拽二级节点 (子节点)</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (draggingLevel === <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (dropLevel === <span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 目标是一级节点 (父节点)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 二级节点可以拖入一级节点内部成为其子节点 (type === &#x27;inner&#x27;)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 二级节点也可以拖到一级节点的前后，实现升级为新的一级节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (type === <span class="string">&quot;prev&quot;</span> || type === <span class="string">&quot;next&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 允许二级节点升级为一级节点，与目标一级节点同级</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// type === &#x27;inner&#x27;，成为其子节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (dropLevel === <span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 目标也是二级节点</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (type === <span class="string">&quot;inner&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 严格禁止二级节点下面再有子节点 (防止三级)</span></span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">return</span> <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 允许二级节点之间同级排序 (prev/next)</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span> <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="literal">false</span>; <span class="comment">// 其他未明确定义的拖拽均不允许</span></span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">handleDrop</span> = <span class="keyword">async</span> (<span class="params">draggingNode, dropNode, dropType, ev</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (dropType === <span class="string">&quot;none&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// ElMessage.info(`节点 &quot;$&#123;draggingNode.data.label&#125;&quot; 已拖拽到 &quot;$&#123;dropNode.data.label&#125;&quot; $&#123;dropType&#125;`);</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// Element Plus 的 el-tree 会在触发此事件前，在内部更新其数据模型 (treeNodeList.value 的结构)。</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 我们需要确保基于这个新结构，节点的 pid 也被正确更新。</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">await</span> <span class="title function_">nextTick</span>(); <span class="comment">// 等待DOM和el-tree内部数据更新</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重新构建树的PID和排序信息，并直接更新到 treeNodeList.value 中的节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 这一步至关重要，确保后续的 getNodeLevel 能获取到最新的 pid</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> <span class="title function_">updateNodePidsAndCollectChanges</span> = (<span class="params">nodes, parentId</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> changes = [];</span></span><br><span class="line"><span class="language-javascript">      nodes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">nodeData, index</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 直接更新前端数据中的 pid 和 sortOrder (如果需要)</span></span></span><br><span class="line"><span class="language-javascript">        nodeData.<span class="property">pid</span> = parentId;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        changes.<span class="title function_">push</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">id</span>: nodeData.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">pid</span>: parentId,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">sortOrder</span>: index,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">label</span>: nodeData.<span class="property">label</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (nodeData.<span class="property">subMenu</span> &amp;&amp; nodeData.<span class="property">subMenu</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 递归调用，并将其子节点收集的变更合并</span></span></span><br><span class="line"><span class="language-javascript">          changes.<span class="title function_">push</span>(</span></span><br><span class="line"><span class="language-javascript">            ...<span class="title function_">updateNodePidsAndCollectChanges</span>(nodeData.<span class="property">subMenu</span>, nodeData.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">          );</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (!nodeData.<span class="property">subMenu</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 确保空的父节点在拖拽后仍然有 subMenu: []</span></span></span><br><span class="line"><span class="language-javascript">          nodeData.<span class="property">subMenu</span> = [];</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span> changes;</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 基于当前 treeNodeList.value (el-tree 拖拽后更新的结构) 来更新 PID 并收集变更</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> updatesToSendToBackend = <span class="title function_">updateNodePidsAndCollectChanges</span>(</span></span><br><span class="line"><span class="language-javascript">      treeNodeList.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">    );</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (updatesToSendToBackend.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">try</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> response = <span class="keyword">await</span> axios.<span class="title function_">post</span>(</span></span><br><span class="line"><span class="language-javascript">          <span class="string">&quot;http://localhost:8080/updateMenusOrder&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          updatesToSendToBackend</span></span><br><span class="line"><span class="language-javascript">        );</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;菜单顺序已同步到后端&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 通常不需要刷新，因为 treeNodeList.value 已是最新。</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 若后端有其他副作用或为了绝对保险，可以取消注释下一行</span></span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// loadMenuTree();</span></span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">msg</span> || <span class="string">&quot;后端同步失败，正在还原...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadMenuTree</span>(); <span class="comment">// 同步失败，从后端恢复</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">catch</span> (error) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;Error updating menu order:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;同步菜单顺序失败，正在还原...&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="title function_">loadMenuTree</span>(); <span class="comment">// 网络错误等，也从后端恢复</span></span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree-node.is-current &gt; .el-tree-node__content &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--el-color-primary-light-<span class="number">9</span>);</span></span><br><span class="line"><span class="language-css">    <span class="attribute">color</span>: <span class="built_in">var</span>(--el-color-primary);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree-node__content:hover &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--el-fill-color-light);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  ::v-deep .el-tree &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attr">--el-tree-node-hover-bg-color</span>: <span class="built_in">var</span>(--el-fill-color-light);</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.custom-tree-node</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-right</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4实现主页菜单同步修改"><a class="markdownIt-Anchor" href="#4实现主页菜单同步修改"></a> 4.实现主页菜单同步修改</h3><p><strong>跨组件状态同步 (Event Bus - mitt)：</strong></p><ul><li><strong>问题场景：</strong> 当在 AddMenus.vue 页面修改了菜单结构（增、删、改、拖拽排序）后，主页 (index.vue，假设它也展示了菜单) 的菜单显示需要同步更新。由于这两个组件可能没有直接的父子关系，简单的 props/emit 可能不适用。</li><li><strong>解决方案：</strong> 引入了<strong>事件总线 (Event Bus)</strong> 机制，这里使用了 mitt 库。<ul><li>创建一个全局的事件总线实例 (src/eventBus.js)。</li><li>在菜单结构发生变化的组件 (AddMenus.vue) 中，当操作成功后，通过 emitter.emit(‘menu-structure-changed’) <strong>发布</strong>一个事件。</li><li>在需要响应这个变化的组件（主页 index.vue）中，通过 emitter.on(‘menu-structure-changed’, handleMenuStructureChanged) <strong>订阅</strong>这个事件，并在事件触发时执行相应的更新逻辑 (如重新获取菜单 fetchMenus())。</li><li><strong>生命周期管理：</strong> 在订阅事件的组件卸载前 (onBeforeUnmount)，需要通过 emitter.off() <strong>移除监听器</strong>，以防止内存泄漏。</li></ul></li><li>这里学会了一种在 Vue 应用中进行<strong>非父子组件间通信和状态同步</strong>的常用方法。事件总线提供了一种解耦的通信方式，使得组件间不需要直接相互依赖。</li></ul><h4 id="修改前端代码"><a class="markdownIt-Anchor" href="#修改前端代码"></a> 修改前端代码</h4><p>根据教程<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yeminglong/p/16020509.html">vue – 事件总线 EventBus</a>和 ai 辅助，得知可以添加<strong>Event Bus (事件总线)</strong>，以同步更新</p><p><strong>首先，安装依赖</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mitt</span><br></pre></td></tr></table></figure><p><strong>创建一个事件总线文件，如 src/eventBus.js</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mitt <span class="keyword">from</span> <span class="string">&quot;mitt&quot;</span>;</span><br><span class="line"><span class="keyword">const</span> emitter = <span class="title function_">mitt</span>();</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> emitter;</span><br></pre></td></tr></table></figure><p><strong>主页代码修改如下</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&quot;@/eventBus&quot;</span>;</span><br><span class="line"><span class="comment">// Vue核心引入onBeforeUnmount</span></span><br><span class="line"><span class="keyword">import</span> &#123; computed, onMounted, ref, watch, onBeforeUnmount &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//修改以下方法，已实现和AddMenus.vue同步更改</span></span><br><span class="line"><span class="comment">// 定义默认展开的菜单项</span></span><br><span class="line"><span class="keyword">const</span> defaultOpeneds = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 当 menus 更新时，这个计算属性会自动重新计算</span></span><br><span class="line">  <span class="keyword">return</span> menus.<span class="property">value</span>.<span class="title function_">map</span>(<span class="function">(<span class="params">menu</span>) =&gt;</span> menu.<span class="property">id</span>.<span class="title function_">toString</span>());</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// --- 事件处理函数，用于响应菜单结构变化 ---</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">handleMenuStructureChanged</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">  <span class="title function_">fetchMenus</span>(); <span class="comment">// 重新获取菜单</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  <span class="title function_">fetchMenus</span>(); <span class="comment">// 页面加载时获取菜单</span></span><br><span class="line">  emitter.<span class="title function_">on</span>(<span class="string">&quot;menu-structure-changed&quot;</span>, handleMenuStructureChanged); <span class="comment">// &lt;--- 监听事件</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="title function_">onBeforeUnmount</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">  emitter.<span class="title function_">off</span>(<span class="string">&quot;menu-structure-changed&quot;</span>, handleMenuStructureChanged); <span class="comment">// &lt;--- 组件卸载前移除监听器，防止内存泄漏</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p><strong>AddMenus.vue 代码修改如下</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> emitter <span class="keyword">from</span> <span class="string">&quot;@/eventBus&quot;</span>; <span class="comment">//同样引入依赖</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//在每一个修改相关操作成功时添加下面这句话触发更新事件，例如我之前的updateMenu，subMenuForm，delMenus，handleDrop这些方法</span></span><br><span class="line">emitter.<span class="title function_">emit</span>(<span class="string">&quot;menu-structure-changed&quot;</span>);</span><br></pre></td></tr></table></figure><h2 id="day8"><a class="markdownIt-Anchor" href="#day8"></a> Day8</h2><h3 id="0实现后端存-icon前端显示"><a class="markdownIt-Anchor" href="#0实现后端存-icon前端显示"></a> 0.实现后端存 icon，前端显示</h3><ul><li><strong>后端存储图标名称：</strong> 在 t_menu 表和对应的 POJO/VO 中增加了 icon_name 字段，用于存储 Element Plus 图标的名称 (如 “User”, “Setting”)。</li><li><strong>前端动态渲染图标：</strong><ul><li>在主页 (index.vue) 中，不再写死菜单图标，而是通过 :is=“getIcon(menu.iconName)” 动态地渲染<el-icon>内部的组件。</el-icon></li><li>getIcon 函数负责根据后端返回的 iconName 从 @element-plus/icons-vue 中查找并返回对应的图标组件。如果找不到或 iconName 为空，则返回一个默认图标 (如 Document)。</li></ul></li></ul><h4 id="后端实现-14"><a class="markdownIt-Anchor" href="#后端实现-14"></a> 后端实现</h4><p><strong>数据库对 menu 表添加图标字段</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER TABLE</span> `t_menu`</span><br><span class="line"><span class="keyword">ADD</span> <span class="keyword">COLUMN</span> `icon_name` <span class="type">VARCHAR</span>(<span class="number">50</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;Element Plus 图标名称 (例如 User, Setting, Folder)&#x27;</span> AFTER `sort_order`;</span><br></pre></td></tr></table></figure><p><strong>menu pojo 添加对应字段</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">* 图标名称</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableField(&quot;icon_name&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String iconName;</span><br></pre></td></tr></table></figure><p><strong>menu vo 添加字段</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> String iconName;</span><br></pre></td></tr></table></figure><p><strong>mapper 添加字段</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.example.demo.pojo.Menu&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;label&quot;</span> <span class="attr">column</span>=<span class="string">&quot;label&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;component&quot;</span> <span class="attr">column</span>=<span class="string">&quot;component&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;pid&quot;</span> <span class="attr">column</span>=<span class="string">&quot;pid&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;icon_name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;icon_name&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;Base_Column_List&quot;</span>&gt;</span></span><br><span class="line">    id,label,component,pid,icon_name</span><br><span class="line"><span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>serviceimpl 添加一行映射图标</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> List&lt;MenuVo&gt; <span class="title function_">buildSubmenu</span><span class="params">(List&lt;Menu&gt; allMenu, Integer parentId)</span> &#123;</span><br><span class="line">        List&lt;MenuVo&gt; submenuTree = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span> (Menu menu : allMenu) &#123;</span><br><span class="line">            <span class="keyword">if</span> (menu.getPid() != <span class="literal">null</span> &amp;&amp; menu.getPid().equals(parentId)) &#123;</span><br><span class="line">                <span class="type">MenuVo</span> <span class="variable">menuVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">MenuVo</span>();</span><br><span class="line">                BeanUtils.copyProperties(menu, menuVo);</span><br><span class="line">                menuVo.setIconName(menu.getIconName()); <span class="comment">// 手动赋值 icon_name</span></span><br><span class="line">                menuVo.setSubMenu(buildSubmenu(allMenu, menu.getId()));</span><br><span class="line">                submenuTree.add(menuVo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> submenuTree;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-13"><a class="markdownIt-Anchor" href="#前端实现-13"></a> 前端实现</h4><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Element Plus 图标，修改引入依赖</span></span><br><span class="line"><span class="keyword">import</span> * <span class="keyword">as</span> <span class="title class_">ElementPlusIconsVue</span> <span class="keyword">from</span> <span class="string">&quot;@element-plus/icons-vue&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增图标映射函数</span></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">getIcon</span> = (<span class="params">iconName</span>) =&gt; &#123;</span><br><span class="line">  <span class="comment">// 如果没有图标名称，返回默认图标</span></span><br><span class="line">  <span class="keyword">if</span> (!iconName) <span class="keyword">return</span> <span class="title class_">ElementPlusIconsVue</span>.<span class="property">Document</span>;</span><br><span class="line">  <span class="comment">// 尝试获取图标组件</span></span><br><span class="line">  <span class="keyword">const</span> icon = <span class="title class_">ElementPlusIconsVue</span>[iconName];</span><br><span class="line">  <span class="comment">// 如果图标存在则返回，否则返回默认图标</span></span><br><span class="line">  <span class="keyword">return</span> icon || <span class="title class_">ElementPlusIconsVue</span>.<span class="property">Document</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>修改写死的图标映射方式</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-menu</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;app-menu&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">select</span>=<span class="string">&quot;handlerSelect&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-if</span>=<span class="string">&quot;hasMenus&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:default-active</span>=<span class="string">&quot;&#x27;1&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">unique-opened</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:default-openeds</span>=<span class="string">&quot;defaultOpeneds&quot;</span></span></span><br><span class="line"><span class="tag">&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-sub-menu</span> <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> <span class="attr">:key</span>=<span class="string">&quot;menu.id&quot;</span> <span class="attr">:index</span>=<span class="string">&quot;menu.id.toString()&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">title</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 动态渲染主菜单图标 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;getIcon(menu.iconName)&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; menu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-menu-item</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-for</span>=<span class="string">&quot;subMenu in menu.subMenu&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:key</span>=<span class="string">&quot;subMenu.id&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:index</span>=<span class="string">&quot;subMenu.id.toString()&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 动态渲染子菜单图标 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;getIcon(subMenu.iconName)&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; subMenu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-sub-menu</span>&gt;</span>&lt;/el-menu</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><h3 id="1实现角色增删改查"><a class="markdownIt-Anchor" href="#1实现角色增删改查"></a> 1.实现角色增删改查</h3><h4 id="后端实现-15"><a class="markdownIt-Anchor" href="#后端实现-15"></a> 后端实现</h4><p>Roleservice 添加接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryRolePageListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p>实现接口方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RolerMapper rolerMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryRolePageListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//指定分页查询参数</span></span><br><span class="line">        Page&lt;Roler&gt; page=<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize);</span><br><span class="line">        List&lt;Roler&gt; rolerList = rolerMapper.selectList(page, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">        result.put(<span class="string">&quot;rolerList&quot;</span>,rolerList);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p><strong>实现控制层</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">RolerController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RolerService rolerService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理分页查询请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/rolerList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">rolerList</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">            , <span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rolerService.queryRolePageListService(pageNum,pageSize);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理角色信息修改的请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/updateRoler&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateRoler</span><span class="params">(<span class="meta">@RequestBody</span> Roler roler)</span>&#123;</span><br><span class="line"></span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败.......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            rolerService.updateById(roler);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;更新角色信息成功......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理角色信息添加的请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveRoler&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveRoler</span><span class="params">(<span class="meta">@RequestBody</span> Roler roler)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败.......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            rolerService.save(roler);</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;保存角色信息成功......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理角色信息删除的请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/deleteRoler&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">deleteRoler</span><span class="params">(<span class="meta">@RequestBody</span> Roler roler)</span>&#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败.......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            rolerService.removeById(roler.getId());</span><br><span class="line">            result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">            result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;删除角色信息成功......&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="前端实现-14"><a class="markdownIt-Anchor" href="#前端实现-14"></a> 前端实现</h4><ul><li>实现了一种<strong>表格内编辑</strong>的功能。通过点击“编辑”按钮，行内对应的 el-input 变为可编辑状态，编辑完成后点击“保存”按钮提交更新。这是通过在行数据 (scope.row) 上添加一个 edit 标志位来控制的。</li><li><strong>特色（表格内编辑）：</strong> 这种交互方式比传统的“点击编辑 -&gt; 打开新对话框/页面 -&gt; 保存” 更为直接和便捷，尤其适用于少量字段的快速修改。</li></ul><p><strong>添加 RolerManager.vue 页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>角色管理<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openRoleDialog&quot;</span>&gt;</span>添加角色<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;rolerList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;编号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;角色&quot;</span> <span class="attr">width</span>=<span class="string">&quot;260&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.edit&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;scope.row.rname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span>&#123;&#123; scope.row.rname &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;描述&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.edit&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;scope.row.rdesc&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span>&#123;&#123; scope.row.rdesc &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">header</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;!scope.row.edit&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;handleEdit(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>编辑&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-else</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;success&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;handleSave(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>保存&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;mini&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDelete(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;rolerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 角色信息对话框 --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 回显客户信息的对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogRoleVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>角色信息<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 对话框中添加form --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;rolerForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;角色名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;rolerForm.rname&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;角色描述&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;rolerForm.rdesc&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;saveRoleForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义角色集合列表数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> rolerList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//发送请求加载角色列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryRoleList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/rolerList?pageNum=&quot;</span> + pageNum)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        rolerList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">rolerList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//加载页码调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryRoleList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义分页按钮函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">rolerPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryRoleList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数实现表格编辑效果</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleEdit</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    row.<span class="property">edit</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数实现编辑后保存</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleSave</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//row.edit=false;</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//console.log(row);</span></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发送ajax请求进行数据更新</span></span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/updateRoler&quot;</span>, row)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          row.<span class="property">edit</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">msg</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数实现删除角色</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleDelete</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确认要删除该角色吗？&quot;</span>, <span class="string">&quot;警告&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        axios</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/deleteRoler&quot;</span>, row)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">queryRoleList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">msg</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>(<span class="string">&quot;删除失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(<span class="string">&quot;已取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义对话框状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogRoleVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义form表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> rolerForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">rname</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">rdesc</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义打开添加角色信息的对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openRoleDialog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogRoleVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数提交角色信息保存的ajax请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">saveRoleForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/saveRoler&quot;</span>, rolerForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          dialogRoleVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          rolerForm.<span class="property">rname</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          rolerForm.<span class="property">rdesc</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryRoleList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">msg</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注册此页面</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/RolerManager.vue&quot;</span>; <span class="comment">// 导入 &quot;管理菜单&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法，修改以下内容:</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  <span class="title class_">ListAfterSale</span>,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  ,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">  <span class="title class_">AddMenus</span>,</span><br><span class="line">  <span class="title class_">RolerManager</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法，修改以下内容：</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddMenus</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">RolerManager</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="2实现角色权限管理"><a class="markdownIt-Anchor" href="#2实现角色权限管理"></a> 2.实现角色权限管理</h3><h4 id="后端实现-16"><a class="markdownIt-Anchor" href="#后端实现-16"></a> 后端实现</h4><ul><li>listRoleMenus (GET): 根据角色 ID (roleId) 查询该角色已经拥有的菜单 ID 列表。这对应 RoleMenuMapper.xml 中的 getMenusByRoleId。</li><li>grantRoleMenus (POST): 接收一个包含角色 ID 和多个菜单 ID 的数组，为该角色重新授权菜单。这对应 RoleMenuMapper.xml 中的 deleteByRoleId (先删除旧权限) 和 batchInsert (批量插入新权限)。这个操作同样使用了 @Transactional 来保证原子性。</li></ul><p><strong>Role<u>Menu</u>Mapper.xml 添加方法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 根据角色ID获取菜单ID列表 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;getMenusByRoleId&quot; resultType<span class="operator">=</span>&quot;java.lang.Integer&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">SELECT</span> mid <span class="keyword">FROM</span> t_role_menu <span class="keyword">WHERE</span> rid <span class="operator">=</span> #&#123;roleId&#125;</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 删除角色所有权限 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">delete</span> id<span class="operator">=</span>&quot;deleteByRoleId&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">DELETE</span> <span class="keyword">FROM</span> t_role_menu <span class="keyword">WHERE</span> rid <span class="operator">=</span> #&#123;roleId&#125;</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">delete</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 批量插入角色菜单权限 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">insert</span> id<span class="operator">=</span>&quot;batchInsert&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">INSERT INTO</span> t_role_menu(rid, mid) <span class="keyword">VALUES</span></span><br><span class="line">    <span class="operator">&lt;</span>foreach collection<span class="operator">=</span>&quot;menuIds&quot; item<span class="operator">=</span>&quot;mid&quot; separator<span class="operator">=</span>&quot;,&quot;<span class="operator">&gt;</span></span><br><span class="line">        (#&#123;roleId&#125;, #&#123;mid&#125;)</span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span>foreach<span class="operator">&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">insert</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>对应 RoleMenuService 接口添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">List&lt;Integer&gt; <span class="title function_">getMenusByRoleId</span><span class="params">(Integer roleId)</span>;</span><br><span class="line"><span class="type">boolean</span> <span class="title function_">grantRoleMenus</span><span class="params">(Integer[] ids)</span>;</span><br></pre></td></tr></table></figure><p>实现方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">getMenusByRoleId</span><span class="params">(Integer roleId)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> baseMapper.getMenusByRoleId(roleId);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">grantRoleMenus</span><span class="params">(Integer[] ids)</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (ids.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="type">Integer</span> <span class="variable">roleId</span> <span class="operator">=</span> ids[<span class="number">0</span>];</span><br><span class="line">        List&lt;Integer&gt; menuIds = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>; i&lt;ids.length; i++) &#123;</span><br><span class="line">            menuIds.add(ids[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 先删除原有权限</span></span><br><span class="line">        baseMapper.deleteByRoleId(roleId);</span><br><span class="line">        <span class="comment">// 批量插入新权限</span></span><br><span class="line">        <span class="keyword">if</span> (menuIds != <span class="literal">null</span> &amp;&amp; !menuIds.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> baseMapper.batchInsert(roleId, menuIds) &gt; <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>在 RolerController 添加方法（注意不是 RolerMenuController）</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> RoleMenuService roleMenuService;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*获取角色菜单权限接口*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/listRoleMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">listRoleMenus</span><span class="params">(Integer roleId)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> roleMenuService.getMenusByRoleId(roleId);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*授予角色菜单权限接口*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/grantRoleMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">grantRoleMenus</span><span class="params">(<span class="meta">@RequestBody</span> Integer[] ids)</span> &#123;</span><br><span class="line">        Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;授权失败......&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(roleMenuService.grantRoleMenus(ids)) &#123;</span><br><span class="line">                result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">                result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;授权成功.......&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">catch</span>(Exception ex)&#123;</span><br><span class="line">            ex.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-15"><a class="markdownIt-Anchor" href="#前端实现-15"></a> 前端实现</h4><ul><li>点击“授权”按钮，弹出一个包含完整菜单树 (el-tree 且 show-checkbox 为 true) 的对话框。</li><li><strong>加载并回显已有权限：</strong> 打开对话框时，会先加载完整的菜单树，然后调用 /listRoleMenus 接口获取当前角色已有的菜单 ID，并使用 treeRef.value.setCheckedKeys(leafNodeIds) 将这些菜单在树中设置为选中状态。</li><li><strong>处理父子节点联动选中：</strong> el-tree 的 show-checkbox 默认会处理父子节点的联动选中。前端代码中 filterLeafNodeIds 的逻辑是为了确保只将叶子节点的 ID 传递给 setCheckedKeys，这样 Element Plus Tree 组件会自动处理父节点的半选中或全选中状态，符合用户直观的授权体验。</li><li><strong>保存授权：</strong> 用户在树中勾选/取消勾选菜单后，点击“保存授权”按钮，前端会收集所有被选中的菜单节点的 ID (通过 treeRef.value.getCheckedNodes(false, true)，其中 false 表示不只获取叶子节点，true 表示获取包括半选中状态的父节点，这里可以根据实际需求调整)，连同角色 ID 一起发送给后端的 /grantRoleMenus 接口。</li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 修改操作组件，添加按钮 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">align</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">header</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">span</span>&gt;</span>操作<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleAuthorize(scope.row)&quot;</span>&gt;</span>授权<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">      <span class="attr">v-if</span>=<span class="string">&quot;!scope.row.edit&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">click</span>=<span class="string">&quot;handleEdit(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span>编辑&lt;/el-button</span><br><span class="line">    &gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">v-else</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleSave(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span>保存&lt;/el-button</span><br><span class="line">    &gt;</span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDelete(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span>删除&lt;/el-button</span><br><span class="line">    &gt;</span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--在模版组件最后面添加授权对话框--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">title</span>=<span class="string">&quot;角色授权&quot;</span> <span class="attr">v-model</span>=<span class="string">&quot;authDialogVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;40%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>请选择该角色可访问的菜单<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tree</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:props</span>=<span class="string">&quot;props&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">&quot;treeNodeList&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">show-checkbox</span></span></span><br><span class="line"><span class="tag">      <span class="attr">default-expand-all</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;treeRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:highlight-current</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; node, data &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;custom-tree-node&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; node.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;authDialogVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;saveRoleAuth&quot;</span>&gt;</span>保存授权<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//添加相关变量和方法</span></span><br><span class="line"><span class="comment">// 树形菜单相关数据</span></span><br><span class="line"><span class="keyword">const</span> treeNodeList = <span class="title function_">ref</span>([]);</span><br><span class="line"><span class="keyword">const</span> treeRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> props = &#123;</span><br><span class="line">  <span class="attr">label</span>: <span class="string">&quot;label&quot;</span>,</span><br><span class="line">  <span class="attr">children</span>: <span class="string">&quot;subMenu&quot;</span>, <span class="comment">// 改为与后端返回的字段名一致</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 授权对话框状态</span></span><br><span class="line"><span class="keyword">const</span> authDialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="keyword">const</span> currentRoleId = <span class="title function_">ref</span>(<span class="literal">null</span>);</span><br><span class="line"><span class="keyword">const</span> currentRoleName = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 处理授权按钮点击事件</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">handleAuthorize</span>(<span class="params">row</span>) &#123;</span><br><span class="line">  currentRoleId.<span class="property">value</span> = row.<span class="property">id</span>;</span><br><span class="line">  currentRoleName.<span class="property">value</span> = row.<span class="property">rname</span>;</span><br><span class="line">  <span class="title function_">loadMenuTree</span>();</span><br><span class="line">  <span class="title function_">loadRoleMenus</span>(row.<span class="property">id</span>);</span><br><span class="line">  authDialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载菜单树</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadMenuTree</span>(<span class="params"></span>) &#123;</span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/listMenus&quot;</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      treeNodeList.<span class="property">value</span> = response.<span class="property">data</span>;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;菜单加载失败&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 加载角色已有的菜单权限</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">loadRoleMenus</span>(<span class="params">roleId</span>) &#123;</span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">get</span>(<span class="string">`http://localhost:8080/listRoleMenus?roleId=<span class="subst">$&#123;roleId&#125;</span>`</span>)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// 等待树加载完成后再设置选中状态</span></span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (treeRef.<span class="property">value</span>) &#123;</span><br><span class="line">          <span class="comment">// 清除之前的选择</span></span><br><span class="line">          treeRef.<span class="property">value</span>.<span class="title function_">setCheckedKeys</span>([]);</span><br><span class="line">          <span class="comment">// 设置新的选中项</span></span><br><span class="line">          <span class="keyword">if</span> (response.<span class="property">data</span> &amp;&amp; response.<span class="property">data</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="comment">// 先找出只包含叶子节点的ID</span></span><br><span class="line">            <span class="keyword">const</span> leafNodeIds = <span class="title function_">filterLeafNodeIds</span>(</span><br><span class="line">              response.<span class="property">data</span>,</span><br><span class="line">              treeNodeList.<span class="property">value</span></span><br><span class="line">            );</span><br><span class="line">            <span class="comment">// 只选中叶子节点，父节点会自动变为半选中状态</span></span><br><span class="line">            treeRef.<span class="property">value</span>.<span class="title function_">setCheckedKeys</span>(leafNodeIds);</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;, <span class="number">100</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;角色菜单权限加载失败&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 递归检查节点ID是否为叶子节点，并过滤出叶子节点ID</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">filterLeafNodeIds</span>(<span class="params">ids, nodes</span>) &#123;</span><br><span class="line">  <span class="comment">// 存储所有非叶子节点的ID</span></span><br><span class="line">  <span class="keyword">const</span> parentIds = <span class="keyword">new</span> <span class="title class_">Set</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 递归收集所有非叶子节点ID</span></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">collectParentIds</span>(<span class="params">nodeList</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!nodeList || nodeList.<span class="property">length</span> === <span class="number">0</span>) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> node <span class="keyword">of</span> nodeList) &#123;</span><br><span class="line">      <span class="keyword">if</span> (node.<span class="property">subMenu</span> &amp;&amp; node.<span class="property">subMenu</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">// 这是一个父节点</span></span><br><span class="line">        parentIds.<span class="title function_">add</span>(node.<span class="property">id</span>);</span><br><span class="line">        <span class="comment">// 递归检查子节点</span></span><br><span class="line">        <span class="title function_">collectParentIds</span>(node.<span class="property">subMenu</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 收集所有父节点ID</span></span><br><span class="line">  <span class="title function_">collectParentIds</span>(nodes);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 过滤出只有叶子节点的ID</span></span><br><span class="line">  <span class="keyword">return</span> ids.<span class="title function_">filter</span>(<span class="function">(<span class="params">id</span>) =&gt;</span> !parentIds.<span class="title function_">has</span>(id));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 保存角色授权</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">saveRoleAuth</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!treeRef.<span class="property">value</span> || !currentRoleId.<span class="property">value</span>) &#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;请先选择角色和菜单&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 获取所有选中的节点（包含父节点）</span></span><br><span class="line">  <span class="keyword">const</span> nodes = treeRef.<span class="property">value</span>.<span class="title function_">getCheckedNodes</span>(<span class="literal">false</span>, <span class="literal">true</span>);</span><br><span class="line">  <span class="keyword">const</span> arr = [currentRoleId.<span class="property">value</span>];</span><br><span class="line">  nodes.<span class="title function_">forEach</span>(<span class="function">(<span class="params">item</span>) =&gt;</span> &#123;</span><br><span class="line">    arr.<span class="title function_">push</span>(item.<span class="property">id</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/grantRoleMenus&quot;</span>, arr)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(<span class="string">&quot;授权成功&quot;</span>);</span><br><span class="line">        authDialogVisible.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">msg</span> || <span class="string">&quot;授权失败&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;授权失败，请稍后重试&quot;</span>);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="day9"><a class="markdownIt-Anchor" href="#day9"></a> Day9</h2><h3 id="补全昨天的逻辑"><a class="markdownIt-Anchor" href="#补全昨天的逻辑"></a> 补全昨天的逻辑</h3><p><strong>后端删除时，应该联级删除</strong></p><ul><li>当删除一个角色时，仅仅删除 t_roler 表中的记录是不够的，还需要删除 t_role_menu 表中与该角色相关的所有权限关联记录，否则会产生孤儿数据。</li><li><strong>解决：</strong> 在 RolerController 的 deleteRoler 方法中，在删除角色本身 (rolerService.removeById(roler.getId())) 之前，先使用 QueryWrapper 构建条件，调用 roleMenuService.remove(queryWrapper) 来删除 t_role_menu 表中所有 rid 等于被删除角色 ID 的记录。</li></ul><p>修改昨天的删除代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理角色信息删除的请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/deleteRoler&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteRoler</span><span class="params">(<span class="meta">@RequestBody</span> Roler roler)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">    result.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;操作失败.......&quot;</span>);</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        QueryWrapper&lt;RoleMenu&gt; queryWrapper = <span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;rid&quot;</span>, roler.getId());</span><br><span class="line">        roleMenuService.remove(queryWrapper);</span><br><span class="line">        rolerService.removeById(roler.getId());</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        result.put(<span class="string">&quot;msg&quot;</span>, <span class="string">&quot;删除角色信息成功......&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception ex) &#123;</span><br><span class="line">        ex.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="day10"><a class="markdownIt-Anchor" href="#day10"></a> Day10</h2><h3 id="1实现用户管理页"><a class="markdownIt-Anchor" href="#1实现用户管理页"></a> 1.实现用户管理页</h3><p>在添加这个功能之前，我简化了前后端的 api 调用代码方法，具体方法看杂项里的内容</p><h4 id="后端实现-17"><a class="markdownIt-Anchor" href="#后端实现-17"></a> 后端实现</h4><p>这个位置完整地实现了 RBAC 模型中“用户-角色”这一核心关联的管理。</p><ul><li><strong>用户与角色的多对多关系处理：</strong><ul><li><strong>后端数据结构：</strong> 在 User 实体类中添加了 @TableField(exist = false) 的 rids (角色 ID 数组) 属性，用于在前端提交用户数据时，同时传递该用户被分配的角色信息。</li><li><strong>后端保存逻辑 (saveUserRolerService)：</strong><ul><li>先保存用户基本信息到 t_user 表。一个重要的细节是，通过自定义 Mapper XML (saveUserMapper 使用 useGeneratedKeys=“true” keyProperty=“id”)，在插入用户数据后<strong>获取数据库自增生成的主键 ID</strong>。这个 ID 后续用于在 t_user_role 关联表中建立关系。</li><li>然后遍历 user.getRids()，将用户 ID 和每个角色 ID 插入到 t_user_role 表中，从而建立用户和角色的关联。</li></ul></li><li><strong>后端更新逻辑 (updateUserRoleService)：</strong><ul><li>先根据用户 ID 删除 t_user_role 表中该用户已有的所有角色关联（“先删后插”的策略）。</li><li>然后更新 t_user 表中的用户基本信息。</li><li>最后，根据 user.getRids() 重新插入新的用户角色关联。</li></ul></li><li><strong>后端删除逻辑 (deleteUserRoleService)：</strong> 删除用户时，除了删除 t_user 表中的用户记录，还需要<strong>级联删除</strong> t_user_role 表中与该用户相关的所有角色关联记录。</li><li><strong>后端查询用户已分配角色 (queryUserRids)：</strong> 提供接口根据用户 ID 查询其在 t_user_role 表中关联的所有角色 ID，用于前端编辑用户时回显已分配的角色。</li></ul></li></ul><p><strong>修改 user 实体类</strong></p><ul><li>用户密码添加注解防止前端直接显示密码</li><li>扩展属性保存用户角色 id</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 用户密码</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@JsonIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String upwd;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//扩展属性保存用户角色id集合</span></span><br><span class="line"><span class="meta">@TableField</span> (exist = <span class="literal">false</span>)</span><br><span class="line"><span class="keyword">private</span> Integer[] rids;</span><br></pre></td></tr></table></figure><p><strong>usermapper 添加接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*保存用户信息*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUserMapper</span><span class="params">(User user)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现此接口</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--定义sql保存用户信息</span></span><br><span class="line"><span class="comment">    保存数据，数据库id自增，保存数据完成后产生的自增的id，封装到方法传入的</span></span><br><span class="line"><span class="comment">    user参数的id属性</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;saveUserMapper&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;com.example.demo.pojo.User&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">useGeneratedKeys</span>=<span class="string">&quot;true&quot;</span> <span class="attr">keyProperty</span>=<span class="string">&quot;id&quot;</span>&gt;</span></span><br><span class="line">    insert into t_user values(null,#&#123;uname&#125;,#&#123;upwd&#125;,#&#123;phone&#125;,</span><br><span class="line">                              #&#123;edu&#125;,#&#123;age&#125;,#&#123;title&#125;)</span><br><span class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>userservice 添加逻辑实现接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现用户信息分页查询*/</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">queryUserListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*实现用户信息保存*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUserRolerService</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*更新用户信息*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUserRoleService</span><span class="params">(User user)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*实现用户信息的删除*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUserRoleService</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line">  <span class="meta">@Autowired</span></span><br><span class="line">  <span class="keyword">private</span> UserRoleMapper userRoleMapper;</span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryUserListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line">      Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">      <span class="comment">//指定分页参数</span></span><br><span class="line">      Page&lt;User&gt; page=<span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum,pageSize);</span><br><span class="line">      List&lt;User&gt; userList = userMapper.selectList(page, <span class="literal">null</span>);</span><br><span class="line"></span><br><span class="line">      result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">      result.put(<span class="string">&quot;userList&quot;</span>,userList);</span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Transactional</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveUserRolerService</span><span class="params">(User user)</span> &#123;</span><br><span class="line"></span><br><span class="line">      System.out.println(<span class="string">&quot;1----&quot;</span>+user.getId());</span><br><span class="line">      <span class="comment">//保存用户基本信息后需要获得数据库自增产生的用户id</span></span><br><span class="line">      <span class="comment">//userMapper.insert(user);</span></span><br><span class="line">      userMapper.saveUserMapper(user);</span><br><span class="line">      <span class="comment">//获得数据库自增产生的id</span></span><br><span class="line">      System.out.println(<span class="string">&quot;2----&quot;</span>+user.getId());</span><br><span class="line">      Integer uid=user.getId();</span><br><span class="line">      <span class="comment">//获得当前用户分配的角色id的集合,从前台提交</span></span><br><span class="line">      Integer[] rids=user.getRids();</span><br><span class="line">      <span class="keyword">for</span>(Integer rid:rids)&#123;</span><br><span class="line">          <span class="comment">//保存用户和角色的关系</span></span><br><span class="line">          UserRole ur=<span class="keyword">new</span> <span class="title class_">UserRole</span>();</span><br><span class="line">          ur.setUid(uid); <span class="comment">//用户id赋值</span></span><br><span class="line">          ur.setRid(rid); <span class="comment">//角色id赋值</span></span><br><span class="line">          userRoleMapper.insert(ur);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="meta">@Transactional</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">updateUserRoleService</span><span class="params">(User user)</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">      <span class="comment">//删除当前更新用户和角色的所有关系，断开关系</span></span><br><span class="line">      QueryWrapper&lt;UserRole&gt; del=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">      del.eq(<span class="string">&quot;uid&quot;</span>,user.getId());  <span class="comment">//where uid=?</span></span><br><span class="line">      userRoleMapper.delete(del);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//更新用户信息</span></span><br><span class="line">      userMapper.updateById(user);</span><br><span class="line"></span><br><span class="line">      <span class="comment">//中间关系表重新添加数据</span></span><br><span class="line">      Integer[] rids = user.getRids();</span><br><span class="line">      <span class="keyword">for</span>(Integer rid:rids)&#123;</span><br><span class="line">          UserRole ur=<span class="keyword">new</span> <span class="title class_">UserRole</span>();</span><br><span class="line">          ur.setUid(user.getId());</span><br><span class="line">          ur.setRid(rid);</span><br><span class="line">          userRoleMapper.insert(ur);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="meta">@Transactional</span></span><br><span class="line">  <span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteUserRoleService</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">      <span class="comment">//删除用户</span></span><br><span class="line">      userMapper.deleteById(id);</span><br><span class="line"></span><br><span class="line">      QueryWrapper&lt;UserRole&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">      wrapper.eq(<span class="string">&quot;uid&quot;</span>,id);</span><br><span class="line">      <span class="comment">//删除用户角色信息</span></span><br><span class="line">      userRoleMapper.delete(wrapper);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>添加 UserController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserRoleService userRoleService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理用户信息分页查询氢气*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/userList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">userList</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">            ,<span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.queryUserListService(pageNum,pageSize);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*添加方法处理用户信息添加请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">        userService.saveUserRolerService(user);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;保存用户信息成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*根据用户id查询某个用户的所有角色id*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/queryUserRids/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">queryUserRids</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        QueryWrapper wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>();</span><br><span class="line">        wrapper.eq(<span class="string">&quot;uid&quot;</span>,id);</span><br><span class="line">        wrapper.select(<span class="string">&quot;rid&quot;</span>);</span><br><span class="line">        List&lt;Integer&gt; list = userRoleService.listObjs(wrapper);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理用户信息修改请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/updateUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">        userService.updateUserRoleService(user);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;修改用户信息成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理用户信息删除请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/deleteUser&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">deleteUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span>&#123;</span><br><span class="line">        userService.deleteUserRoleService(user.getId());</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;删除用户信息成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-16"><a class="markdownIt-Anchor" href="#前端实现-16"></a> 前端实现</h4><p><strong>添加页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>用户列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加按钮 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openUserDialog&quot;</span>&gt;</span>添加用户<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- table组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;userList&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;id&quot;</span> <span class="attr">label</span>=<span class="string">&quot;用户编号&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;uname&quot;</span> <span class="attr">label</span>=<span class="string">&quot;用户名&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">label</span>=<span class="string">&quot;电话&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;edu&quot;</span> <span class="attr">label</span>=<span class="string">&quot;学历&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;age&quot;</span> <span class="attr">label</span>=<span class="string">&quot;年龄&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;title&quot;</span> <span class="attr">label</span>=<span class="string">&quot;部门&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;deleteUser(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除</span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;showUserDialog(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改</span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- page分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;pageSize&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加用户信息对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">&quot;dialogUserVisible&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:title</span>=<span class="string">&quot;userForm.id ? &#x27;修改用户信息&#x27; : &#x27;添加用户信息&#x27;&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">close</span>=<span class="string">&quot;resetUserForm&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- 对话框中添加form --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;userFormRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">&quot;userForm&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:rules</span>=<span class="string">&quot;rules&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;用户名&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;uname&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userForm.uname&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;电话&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userForm.phone&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;学历&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;edu&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userForm.edu&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;年龄&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;age&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userForm.age&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;部门&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;title&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;userForm.title&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;角色&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;rids&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;userForm.rids&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择角色....&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">multiple</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">            <span class="attr">v-for</span>=<span class="string">&quot;opt in optRoles&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:label</span>=<span class="string">&quot;opt.rname&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:value</span>=<span class="string">&quot;opt.id&quot;</span></span></span><br><span class="line"><span class="tag">            <span class="attr">:key</span>=<span class="string">&quot;opt.id&quot;</span></span></span><br><span class="line"><span class="tag">          /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subUserForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;cancelUserForm&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; userApi &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/user&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; roleApi &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/role&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明user列表集合数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> userList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明总记录数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明分页大小</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> pageSize = <span class="title function_">ref</span>(<span class="number">10</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发送请求加载用户列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryUserList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    userApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getUserList</span>(pageNum, pageSize.<span class="property">value</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        userList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">userList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//加载调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryUserList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义分页按钮回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//调用分页查询函数</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryUserList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义添加用户信息对话框状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogUserVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 表单引用</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> userFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> userForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">uname</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">edu</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">title</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">rids</span>: [],</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 表单验证规则</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> rules = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">uname</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入用户名&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">min</span>: <span class="number">2</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">max</span>: <span class="number">20</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;长度应在 2 到 20 个字符之间&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入电话号码&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">pattern</span>: <span class="regexp">/^1[3-9]\d&#123;9&#125;$/</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;请输入正确的手机号码&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">age</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入年龄&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">type</span>: <span class="string">&quot;number&quot;</span>, <span class="attr">message</span>: <span class="string">&quot;年龄必须为数字&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">type</span>: <span class="string">&quot;number&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">min</span>: <span class="number">18</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">max</span>: <span class="number">70</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">message</span>: <span class="string">&quot;年龄必须在18到70之间&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">edu</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入学历&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">title</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入部门&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">rids</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择角色&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 定义重置表单的函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">resetUserForm</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置表单的验证状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (userFormRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      userFormRef.<span class="property">value</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置表单数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(userForm, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: <span class="literal">undefined</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">uname</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">age</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">edu</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">title</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">rids</span>: [],</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明角色的集合</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> optRoles = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">openUserDialog</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 先重置表单数据</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetUserForm</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 再打开对话框</span></span></span><br><span class="line"><span class="language-javascript">    dialogUserVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发送ajax请求加载所有角色信息</span></span></span><br><span class="line"><span class="language-javascript">    userApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">loadAllRoles</span>()</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        optRoles.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;加载角色信息失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">subUserForm</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!userFormRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;表单未正确加载，请重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    userFormRef.<span class="property">value</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!valid) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">const</span> operation = userForm.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">        ? userApi.<span class="title function_">updateUser</span>(userForm)</span></span><br><span class="line"><span class="language-javascript">        : userApi.<span class="title function_">saveUser</span>(userForm);</span></span><br><span class="line"><span class="language-javascript">      operation</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//关闭对话框</span></span></span><br><span class="line"><span class="language-javascript">            dialogUserVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 重置表单数据</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resetUserForm</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 刷新用户列表</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">queryUserList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;操作失败，请重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 取消按钮处理函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">cancelUserForm</span> = (<span class="params"></span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogUserVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetUserForm</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//打开对话框实现用户信息修改</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">showUserDialog</span> = (<span class="params">row</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogUserVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//将row赋值给userForm表单</span></span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">age</span> = row.<span class="property">age</span>;</span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">edu</span> = row.<span class="property">edu</span>;</span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">id</span> = row.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">uname</span> = row.<span class="property">uname</span>;</span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">phone</span> = row.<span class="property">phone</span>;</span></span><br><span class="line"><span class="language-javascript">    userForm.<span class="property">title</span> = row.<span class="property">title</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//加载下拉列表框所有角色信息</span></span></span><br><span class="line"><span class="language-javascript">    userApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">loadAllRoles</span>()</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        optRoles.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//根据用户id查询用户的角色id集合</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//将查询到的角色id集合赋值给表单的rids属性</span></span></span><br><span class="line"><span class="language-javascript">        userApi.<span class="title function_">queryUserRids</span>(row.<span class="property">id</span>).<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//将响应的角色id的集合赋值给表单的数组</span></span></span><br><span class="line"><span class="language-javascript">          userForm.<span class="property">rids</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//删除用户信息</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> <span class="title function_">deleteUser</span> = (<span class="params">row</span>) =&gt; &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;是否删除该用户?&quot;</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        userApi</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">deleteUser</span>(row.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">queryUserList</span>(<span class="number">1</span>); <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;info&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">message</span>: <span class="string">&quot;已取消删除&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在主页注册页面</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/UserManager.vue&quot;</span>; <span class="comment">// 导入 &quot;用户管理&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法，修改以下内容:</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  <span class="title class_">ListAfterSale</span>,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  ,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">  <span class="title class_">AddMenus</span>,</span><br><span class="line">  <span class="title class_">RolerManager</span>,</span><br><span class="line">  <span class="title class_">UserManager</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法，修改以下内容：</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddMenus</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">RolerManager</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">UserManager</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h3 id="2用-echarts-组件渲染图表"><a class="markdownIt-Anchor" href="#2用-echarts-组件渲染图表"></a> 2.用 Echarts 组件渲染图表</h3><h4 id="前端实现-17"><a class="markdownIt-Anchor" href="#前端实现-17"></a> 前端实现</h4><p><strong>安装 Echarts</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install --save echarts</span><br></pre></td></tr></table></figure><p><strong>添加测试页面</strong></p><p>因为估计下一次要实现库存统计页面，所以这里添加 StockStatistics.vue 页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;display: flex;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;pieChartContainer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%; height: 400px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">ref</span>=<span class="string">&quot;barChartContainer&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 50%; height: 400px;&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 员工地区分布数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> empData = <span class="title function_">ref</span>([</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">name</span>: <span class="string">&quot;北京&quot;</span>, <span class="attr">value</span>: <span class="number">100</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">name</span>: <span class="string">&quot;上海&quot;</span>, <span class="attr">value</span>: <span class="number">120</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">name</span>: <span class="string">&quot;天津&quot;</span>, <span class="attr">value</span>: <span class="number">130</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">name</span>: <span class="string">&quot;重庆&quot;</span>, <span class="attr">value</span>: <span class="number">70</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    &#123; <span class="attr">name</span>: <span class="string">&quot;武汉&quot;</span>, <span class="attr">value</span>: <span class="number">90</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">  ]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 模拟销售数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> sellData = <span class="title function_">ref</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">xdata</span>: [</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;1月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;2月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;3月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;4月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;5月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;6月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;7月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;8月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;9月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;10月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;11月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="string">&quot;12月&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">ydata</span>: <span class="title class_">Array</span>.<span class="title function_">from</span>(</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">length</span>: <span class="number">12</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="function">() =&gt;</span> <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * (<span class="number">10000</span> - <span class="number">500</span> + <span class="number">1</span>)) + <span class="number">500</span></span></span><br><span class="line"><span class="language-javascript">    ),</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// DOM容器引用</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> pieChartContainer = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> barChartContainer = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 渲染饼图</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">renderPieChart</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> myEcharts = echarts.<span class="title function_">init</span>(pieChartContainer.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">tooltip</span>: &#123; <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">legend</span>: &#123; <span class="attr">top</span>: <span class="string">&quot;5%&quot;</span>, <span class="attr">left</span>: <span class="string">&quot;center&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">name</span>: <span class="string">&quot;员工地区分布&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">itemStyle</span>: &#123; <span class="attr">borderRadius</span>: <span class="number">10</span>, <span class="attr">borderColor</span>: <span class="string">&quot;#fff&quot;</span>, <span class="attr">borderWidth</span>: <span class="number">2</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">label</span>: &#123; <span class="attr">show</span>: <span class="literal">false</span>, <span class="attr">position</span>: <span class="string">&quot;center&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">emphasis</span>: &#123; <span class="attr">label</span>: &#123; <span class="attr">show</span>: <span class="literal">true</span>, <span class="attr">fontSize</span>: <span class="number">40</span>, <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span> &#125; &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">labelLine</span>: &#123; <span class="attr">show</span>: <span class="literal">false</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">data</span>: empData.<span class="property">value</span>,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    myEcharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 渲染柱状图</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">renderBarChart</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> myCharts = echarts.<span class="title function_">init</span>(barChartContainer.<span class="property">value</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">xAxis</span>: &#123; <span class="attr">type</span>: <span class="string">&quot;category&quot;</span>, <span class="attr">data</span>: sellData.<span class="property">value</span>.<span class="property">xdata</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">yAxis</span>: &#123; <span class="attr">type</span>: <span class="string">&quot;value&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">        &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">data</span>: sellData.<span class="property">value</span>.<span class="property">ydata</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">type</span>: <span class="string">&quot;bar&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">showBackground</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">backgroundStyle</span>: &#123; <span class="attr">color</span>: <span class="string">&quot;rgba(180, 180, 180, 0.2)&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">        &#125;,</span></span><br><span class="line"><span class="language-javascript">      ],</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    myCharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">renderPieChart</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">renderBarChart</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在主页注册页面</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/StockStatistics.vue&quot;</span>; <span class="comment">// 导入 &quot;库存管理&quot; 视图组件</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//老师的方法，修改以下内容:</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title class_">AddCustomer</span>,</span><br><span class="line">  <span class="title class_">ListCustomer</span>,</span><br><span class="line">  <span class="title class_">ListAfterSale</span>,</span><br><span class="line">  <span class="title class_">ListCustOrder</span>,</span><br><span class="line">  <span class="title class_">AddSellJh</span>,</span><br><span class="line">  <span class="title class_">StockStatistics</span>,</span><br><span class="line">  ,</span><br><span class="line">  <span class="title class_">ListSellJh</span>,</span><br><span class="line">  <span class="title class_">AddMenus</span>,</span><br><span class="line">  <span class="title class_">RolerManager</span>,</span><br><span class="line">  <span class="title class_">UserManager</span>,</span><br><span class="line">];</span><br><span class="line"><span class="comment">//我的方法，修改以下内容：</span></span><br><span class="line"><span class="keyword">const</span> views = [</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustomer</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListAfterSale</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListCustOrder</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">StockStatistics</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">ListSellJh</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">AddMenus</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">RolerManager</span>),</span><br><span class="line">  <span class="title function_">markRaw</span>(<span class="title class_">UserManager</span>),</span><br><span class="line">];</span><br></pre></td></tr></table></figure><h2 id="day11"><a class="markdownIt-Anchor" href="#day11"></a> Day11</h2><h3 id="1实现商品类别管理页"><a class="markdownIt-Anchor" href="#1实现商品类别管理页"></a> 1.实现商品类别管理页</h3><ul><li><strong>后端递归构建树形 VO：</strong> 再次使用了递归 (toListTreeVo) 将从数据库查询到的平铺的商品分类列表 (List<category>) 转换为前端 el-tree 需要的树形结构 (List<treevo>)。这与之前菜单管理的实现类似，是对树形数据处理能力的巩固。</treevo></category></li></ul><h4 id="数据库实现"><a class="markdownIt-Anchor" href="#数据库实现"></a> 数据库实现</h4><p><strong>先在菜单中添加条目</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> `t_menu` (`id`, `label`, `component`, `pid`, `sort_order`, `icon_name`) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">15</span>, <span class="string">&#x27;商品管理&#x27;</span>, <span class="number">11</span>, <span class="number">0</span>, <span class="number">3</span>, <span class="string">&#x27;Goods&#x27;</span>),</span><br><span class="line">(<span class="number">16</span>, <span class="string">&#x27;商品分类&#x27;</span>, <span class="number">12</span>, <span class="number">15</span>, <span class="number">0</span>, <span class="string">&#x27;Grid&#x27;</span>),</span><br><span class="line">(<span class="number">17</span>, <span class="string">&#x27;商品入库&#x27;</span>, <span class="number">13</span>, <span class="number">15</span>, <span class="number">1</span>, <span class="string">&#x27;Download&#x27;</span>),</span><br><span class="line">(<span class="number">18</span>, <span class="string">&#x27;商品出库&#x27;</span>, <span class="number">14</span>, <span class="number">15</span>, <span class="number">2</span>, <span class="string">&#x27;Upload&#x27;</span>);</span><br></pre></td></tr></table></figure><p><strong>添加商品类目表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_category` (</span><br><span class="line">  `id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;ID (主键)&#x27;</span>, <span class="comment">-- 自增主键</span></span><br><span class="line">  `isbn` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">NOT NULL</span> COMMENT <span class="string">&#x27;ISBN 编号&#x27;</span>, <span class="comment">-- ISBN 编号，唯一标识</span></span><br><span class="line">  `cate_name` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;分类名称&#x27;</span>, <span class="comment">-- 商品分类名称</span></span><br><span class="line">  `remark` <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;备注信息&#x27;</span>, <span class="comment">-- 备注说明</span></span><br><span class="line">  `pid` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;父分类ID&#x27;</span>, <span class="comment">-- 父分类ID，用于构建分类层级</span></span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`id`) <span class="comment">-- 设置主键</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_0900_ai_ci COMMENT<span class="operator">=</span><span class="string">&#x27;商品分类表&#x27;</span>; <span class="comment">-- 表注释</span></span><br></pre></td></tr></table></figure><p><strong>给这个表插入一些数据</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">INSERT INTO</span> `t_category` (`id`, `isbn`, `cate_name`, `remark`, `pid`) <span class="keyword">VALUES</span></span><br><span class="line">(<span class="number">1</span>, <span class="string">&#x27;ISBN001&#x27;</span>, <span class="string">&#x27;电子产品&#x27;</span>, <span class="string">&#x27;主要分类&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">(<span class="number">2</span>, <span class="string">&#x27;ISBN002&#x27;</span>, <span class="string">&#x27;手机&#x27;</span>, <span class="string">&#x27;子分类&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="number">3</span>, <span class="string">&#x27;ISBN003&#x27;</span>, <span class="string">&#x27;笔记本电脑&#x27;</span>, <span class="string">&#x27;子分类&#x27;</span>, <span class="number">1</span>),</span><br><span class="line">(<span class="number">4</span>, <span class="string">&#x27;ISBN004&#x27;</span>, <span class="string">&#x27;服装&#x27;</span>, <span class="string">&#x27;主要分类&#x27;</span>, <span class="number">0</span>),</span><br><span class="line">(<span class="number">5</span>, <span class="string">&#x27;ISBN005&#x27;</span>, <span class="string">&#x27;男装&#x27;</span>, <span class="string">&#x27;子分类&#x27;</span>, <span class="number">4</span>),</span><br><span class="line">(<span class="number">6</span>, <span class="string">&#x27;ISBN006&#x27;</span>, <span class="string">&#x27;女装&#x27;</span>, <span class="string">&#x27;子分类&#x27;</span>, <span class="number">4</span>);</span><br></pre></td></tr></table></figure><h4 id="后端实现-18"><a class="markdownIt-Anchor" href="#后端实现-18"></a> 后端实现</h4><p><strong>在 idea 里用 mybatiesx 生成代码</strong></p><p><strong>CategoryService 添加服务接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*加载商品类目树*/</span></span><br><span class="line">List&lt;TreeVo&gt; <span class="title function_">queryCategoryListService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>实现接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> CategoryMapper categoryMapper;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;TreeVo&gt; <span class="title function_">queryCategoryListService</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="comment">//查询数据库获得所有商品类目</span></span><br><span class="line">    List&lt;Category&gt; categrories = categoryMapper.selectList(<span class="literal">null</span>);</span><br><span class="line">    <span class="keyword">return</span> toListTreeVo(categrories,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 声明方法，递归遍历categories集合，将该集合转化为List&lt;TreeVo&gt;</span></span><br><span class="line"><span class="keyword">private</span> List&lt;TreeVo&gt; <span class="title function_">toListTreeVo</span><span class="params">(List&lt;Category&gt; categories ,Integer id)</span>&#123;</span><br><span class="line">    List&lt;TreeVo&gt; result = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    System.out.println(<span class="string">&quot;转换开始 - 当前父ID: &quot;</span> + id + <span class="string">&quot;, 总记录数: &quot;</span> + categories.size());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>(Category category : categories)&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;处理节点: &quot;</span> + category.getCateName() + <span class="string">&quot;, PID: &quot;</span> + (category.getPid() != <span class="literal">null</span> ? category.getPid().toString() : <span class="string">&quot;null&quot;</span>) + <span class="string">&quot;, 当前ID: &quot;</span> + category.getId());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(Objects.equals(category.getPid(), id))&#123;  <span class="comment">// 使用Objects.equals()避免空指针异常</span></span><br><span class="line">            System.out.println(<span class="string">&quot;匹配到子节点: &quot;</span> + category.getCateName() + <span class="string">&quot;, PID: &quot;</span> + id);</span><br><span class="line">            <span class="type">TreeVo</span> <span class="variable">treeVo</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">TreeVo</span>();</span><br><span class="line">            treeVo.setId(category.getId());</span><br><span class="line">            treeVo.setLabel(category.getCateName());</span><br><span class="line">            treeVo.setChildren(toListTreeVo(categories, category.getId()));</span><br><span class="line">            result.add(treeVo);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;未匹配节点: &quot;</span> + category.getCateName() + <span class="string">&quot;, PID: &quot;</span> + category.getPid() + <span class="string">&quot;, 需要: &quot;</span> + id);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;转换结束 - 结果数量: &quot;</span> + result.size() + <span class="string">&quot;, 父ID: &quot;</span> + id);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 CategoryController 代码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CategoryController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CategoryService categoryService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理加载商品类目树请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/categoryList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;TreeVo&gt; <span class="title function_">categoryList</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryService.queryCategoryListService();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理商品类目添加请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveCategory&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveCategory</span><span class="params">(<span class="meta">@RequestBody</span> Category category)</span>&#123;</span><br><span class="line">        categoryService.save(category);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;添加商品类别成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理商品分类回显的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/loadCategory/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Category <span class="title function_">loadCategory</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> categoryService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理商品类目更新更新请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/updateCategory&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateCategory</span><span class="params">(<span class="meta">@RequestBody</span> Category category)</span>&#123;</span><br><span class="line">        categoryService.updateById(category);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;更新商品类别成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理商品类目删除请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/deleteCategory/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">deleteCategory</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        categoryService.removeById(id);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;删除商品类别成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-18"><a class="markdownIt-Anchor" href="#前端实现-18"></a> 前端实现</h4><ul><li><strong>前端树形交互与表单联动：</strong><ul><li>使用 el-tree 展示商品分类，并允许用户点击节点进行选中。</li><li>将选中的树节点作为新增分类的父节点 (categoryForm.pid = <a target="_blank" rel="noopener" href="http://node.id">node.id</a>)。</li><li>在修改分类时，先根据 ID 从后端加载分类信息回显到表单。</li><li>删除分类时，增加了判断，如果分类下有子分类则不允许删除。</li></ul></li></ul><p><strong>添加后端接口定义</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> request <span class="keyword">from</span> <span class="string">&quot;./config&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 商品分类管理相关接口</span></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> categoryApi = &#123;</span><br><span class="line">  <span class="comment">// 获取分类树</span></span><br><span class="line">  <span class="title function_">getCategoryTree</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">&quot;/categoryList&quot;</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取单个分类信息</span></span><br><span class="line">  <span class="title function_">getCategoryById</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">`/loadCategory/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 保存分类</span></span><br><span class="line">  <span class="title function_">saveCategory</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&quot;/saveCategory&quot;</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新分类</span></span><br><span class="line">  <span class="title function_">updateCategory</span>(<span class="params">data</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">post</span>(<span class="string">&quot;/updateCategory&quot;</span>, data);</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 删除分类</span></span><br><span class="line">  <span class="title function_">deleteCategory</span>(<span class="params">id</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> request.<span class="title function_">get</span>(<span class="string">`/deleteCategory/<span class="subst">$&#123;id&#125;</span>`</span>);</span><br><span class="line">  &#125;,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>实现页面代码</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>商品类目管理<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h4</span>&gt;</span>选择分类节点进行管理<span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- tree控件 --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tree</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:props</span>=<span class="string">&quot;config&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">&quot;categoryList&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">default-expand-all</span></span></span><br><span class="line"><span class="tag">      <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;treeRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:highlight-current</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:expand-on-click-node</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">node-click</span>=<span class="string">&quot;handleClickNode&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; node, data &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;custom-tree-node&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; node.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">span</span> <span class="attr">class</span>=<span class="string">&quot;operation-buttons&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">link</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;showCategory(node, data)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              修改</span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">link</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click.stop</span>=<span class="string">&quot;handleDelete(node, data)&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              删除</span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 添加商品类目表单 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;categoryForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;category-form&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类编号&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;categoryForm.isbn&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请输入分类编号&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类名称&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;categoryForm.cateName&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请输入分类名称&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;分类描述&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;categoryForm.remark&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请输入分类描述&quot;</span></span></span><br><span class="line"><span class="tag">      /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;saveCategoryForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetForm&quot;</span>&gt;</span>重置表单<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; categoryApi &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/category&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 树配置 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> config = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="string">&quot;id&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;label&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">children</span>: <span class="string">&quot;children&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> treeRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> categoryList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 数据加载 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryCategoryTree</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    categoryApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getCategoryTree</span>()</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        categoryList.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;加载分类树失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;加载分类树失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryCategoryTree</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 表单处理 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> categoryForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">isbn</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">cateName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">remark</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">pid</span>: <span class="number">0</span>, <span class="comment">// 默认为0，表示一级节点</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">let</span> pnode = <span class="literal">null</span>; <span class="comment">// 记录当前选中的节点对象</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 节点操作函数 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleClickNode</span>(<span class="params">node</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    pnode = node;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 如果是新增模式，设置父节点</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (categoryForm.<span class="property">id</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      categoryForm.<span class="property">pid</span> = node.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置表单数据</span></span></span><br><span class="line"><span class="language-javascript">    categoryForm.<span class="property">id</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">    categoryForm.<span class="property">isbn</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    categoryForm.<span class="property">cateName</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    categoryForm.<span class="property">remark</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    categoryForm.<span class="property">pid</span> = <span class="number">0</span>; <span class="comment">// 重置为0，表示添加一级节点</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置树选择状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (treeRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      treeRef.<span class="property">value</span>.<span class="title function_">setCurrentKey</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    pnode = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 保存操作 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">saveCategoryForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!categoryForm.<span class="property">cateName</span>.<span class="title function_">trim</span>()) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;分类名称不能为空&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (categoryForm.<span class="property">id</span> === <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// 新增模式</span></span></span><br><span class="line"><span class="language-javascript">      <span class="comment">// pid为0时表示添加一级节点，否则为选中节点的子节点</span></span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (pnode) &#123;</span></span><br><span class="line"><span class="language-javascript">        categoryForm.<span class="property">pid</span> = pnode.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> apiCall =</span></span><br><span class="line"><span class="language-javascript">      categoryForm.<span class="property">id</span> === <span class="number">0</span></span></span><br><span class="line"><span class="language-javascript">        ? categoryApi.<span class="title function_">saveCategory</span>(categoryForm)</span></span><br><span class="line"><span class="language-javascript">        : categoryApi.<span class="title function_">updateCategory</span>(categoryForm);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    apiCall</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryCategoryTree</span>();</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;保存失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;保存失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 修改操作 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">showCategory</span>(<span class="params">node, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    categoryApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getCategoryById</span>(data.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">Object</span>.<span class="title function_">assign</span>(categoryForm, response.<span class="property">data</span>);</span></span><br><span class="line"><span class="language-javascript">        pnode = node;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;加载分类信息失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;加载分类信息失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// --- 删除操作 ---</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleDelete</span>(<span class="params">node, data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (data.<span class="property">children</span> &amp;&amp; data.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;该分类下还有子分类，不能删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定要删除该分类吗？&quot;</span>, <span class="string">&quot;警告&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        categoryApi</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">deleteCategory</span>(data.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">queryCategoryTree</span>();</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;已取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.custom-tree-node</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">flex</span>: <span class="number">1</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">display</span>: flex;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">align-items</span>: center;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">justify-content</span>: space-between;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-right</span>: <span class="number">8px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在主页注册页面</strong></p><p>之前写过很多次，这里不重复</p><h3><a class="markdownIt-Anchor" href="#"></a></h3><h2 id="day12-14-实现商品信息管理"><a class="markdownIt-Anchor" href="#day12-14-实现商品信息管理"></a> Day12-14 实现商品信息管理</h2><h3 id="数据库实现-2"><a class="markdownIt-Anchor" href="#数据库实现-2"></a> 数据库实现</h3><p>为商品信息引入了多个关联表（品牌 t_brand, 产地 t_place, 仓库 t_store, 供货商 t_supply, 规格单位 t_unit）。这些表作为“字典数据”或“基础数据”，用于商品信息中的下拉选择。</p><p>添加 品牌表，产地表，仓库表，供货商表，规格单位表</p><p>t_brand, t_place, t_store, t_supply, t_unit</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_brand`  (</span><br><span class="line">  `brand_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;品牌ID&#x27;</span>,</span><br><span class="line">  `brand_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;品牌名称&#x27;</span>,</span><br><span class="line">  `brand_leter` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;品牌首字母&#x27;</span>,</span><br><span class="line">  `brand_desc` <span class="type">varchar</span>(<span class="number">1000</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;品牌描述&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`brand_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">5</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;品牌表&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_brand` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;东东果蔬&#x27;</span>, <span class="string">&#x27;D&#x27;</span>, <span class="string">&#x27;别买了，不能吃...&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_brand` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;美的&#x27;</span>, <span class="string">&#x27;M&#x27;</span>, <span class="string">&#x27;还可以&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_brand` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;海尔&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;我家洗衣机就是海尔啊&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_brand` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;华为&#x27;</span>, <span class="string">&#x27;H&#x27;</span>, <span class="string">&#x27;中华有为&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_place`  (</span><br><span class="line">  `place_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;产地ID&#x27;</span>,</span><br><span class="line">  `place_name` <span class="type">varchar</span>(<span class="number">200</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产地名称&#x27;</span>,</span><br><span class="line">  `place_num` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产地编号&#x27;</span>,</span><br><span class="line">  `introduce` <span class="type">varchar</span>(<span class="number">300</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产地介绍&#x27;</span>,</span><br><span class="line">  `is_delete` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;逻辑删除标记(0:可用  1:不可用)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`place_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">8</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;产地表&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;湖南&#x27;</span>, <span class="string">&#x27;hunan&#x27;</span>, <span class="string">&#x27;湖南挺好的啊&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;湖北&#x27;</span>, <span class="string">&#x27;hubei&#x27;</span>, <span class="string">&#x27;湖北没有湖南好&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;陕西&#x27;</span>, <span class="string">&#x27;shanxi&#x27;</span>, <span class="string">&#x27;还是陕西更好&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;浙江&#x27;</span>, <span class="string">&#x27;zhejiang&#x27;</span>, <span class="string">&#x27;好地方&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;山东&#x27;</span>, <span class="string">&#x27;shandong&#x27;</span>, <span class="string">&#x27;很好&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;广东&#x27;</span>, <span class="string">&#x27;guangdong&#x27;</span>, <span class="string">&#x27;非常好&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_place` <span class="keyword">VALUES</span> (<span class="number">7</span>, <span class="string">&#x27;河北&#x27;</span>, <span class="string">&#x27;hebei&#x27;</span>, <span class="string">&#x27;知道有个叫唐山的地方&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_store`  (</span><br><span class="line">  `store_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;仓库ID&#x27;</span>,</span><br><span class="line">  `store_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库名称&#x27;</span>,</span><br><span class="line">  `store_num` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库编号&#x27;</span>,</span><br><span class="line">  `store_address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库地址&#x27;</span>,</span><br><span class="line">  `concat` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;联系人&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`store_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">5</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;仓库表&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_store` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;西安仓库&#x27;</span>, <span class="string">&#x27;xa1&#x27;</span>, <span class="string">&#x27;西安市雁塔区&#x27;</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;13829086629&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_store` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;北京仓库&#x27;</span>, <span class="string">&#x27;bj2&#x27;</span>, <span class="string">&#x27;北京市朝阳区 &#x27;</span>, <span class="string">&#x27;王麻子&#x27;</span>, <span class="string">&#x27;15229267291&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_store` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;上海仓库&#x27;</span>, <span class="string">&#x27;sh3&#x27;</span>, <span class="string">&#x27;上海市浦东区&#x27;</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;18092647320&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_supply`  (</span><br><span class="line">  `supply_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;供应商ID&#x27;</span>,</span><br><span class="line">  `supply_num` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商编号&#x27;</span>,</span><br><span class="line">  `supply_name` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商名称&#x27;</span>,</span><br><span class="line">  `supply_introduce` longtext <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商介绍&#x27;</span>,</span><br><span class="line">  `concat` <span class="type">varchar</span>(<span class="number">50</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;联系人&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;联系电话&#x27;</span>,</span><br><span class="line">  `address` <span class="type">varchar</span>(<span class="number">100</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商地址&#x27;</span>,</span><br><span class="line">  `is_delete` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="string">&#x27;0&#x27;</span> COMMENT <span class="string">&#x27;逻辑删除标记(0:可用  1:不可用)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`supply_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">6</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;供货商表&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_supply` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;zjsh&#x27;</span>, <span class="string">&#x27;浙江三禾竹木有限公司&#x27;</span>, <span class="string">&#x27;贷款是否会为加快和规范健康环境如何根据&#x27;</span>, <span class="string">&#x27;任伟&#x27;</span>, <span class="string">&#x27;15287653921&#x27;</span>, <span class="string">&#x27;浙江省丽水市&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_supply` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;lqlo&#x27;</span>, <span class="string">&#x27;龙泉绿欧食品有限公司&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;18134532830&#x27;</span>, <span class="string">&#x27;浙江省龙泉市&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_supply` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;dhgy&#x27;</span>, <span class="string">&#x27;帝豪供应链公司&#x27;</span>, <span class="keyword">NULL</span>, <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;17493976543&#x27;</span>, <span class="string">&#x27;陕西省西安市&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_supply` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;haier&#x27;</span>, <span class="string">&#x27;海尔集团&#x27;</span>, <span class="string">&#x27;海尔智家为用户提供衣、食、住、娱的智慧全场景解决方案，全面提升用户生活品质，以“云”体验、全链路服务、个性化智慧终端，实现交互、体验、销售、服务于一体的全流程生态平台。&#x27;</span>, <span class="string">&#x27;周云杰&#x27;</span>, <span class="string">&#x27;4006999511&#x27;</span>, <span class="string">&#x27;山东省青岛市&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_supply` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;midea&#x27;</span>, <span class="string">&#x27;美的集团股份有限公司&#x27;</span>, <span class="string">&#x27;科技尽善，生活尽美”– 美的集团秉承用科技创造美好生活的经营理念，如今已成为一家集智能家居事业群、机电事业群、暖通与楼宇事业部、机器人及自动化事业部、数字化创新业务五大板块为一体的全球化科技集团，产品及服务惠及全球200多个国家和地区约4亿用户。形成美的、小天鹅、东芝、华凌、布谷、COLMO、Clivet、Eureka、库卡、GMCC、威灵在内的多品牌组合。&#x27;</span>, <span class="string">&#x27;方洪波&#x27;</span>, <span class="string">&#x27;075726338788&#x27;</span>, <span class="string">&#x27;广东省佛山市&#x27;</span>, <span class="string">&#x27;0&#x27;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_unit`  (</span><br><span class="line">  `unit_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;单位ID&#x27;</span>,</span><br><span class="line">  `unit_name` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;单位名称&#x27;</span>,</span><br><span class="line">  `unit_desc` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;单位描述&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`unit_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">8</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;规格单位表&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">1</span>, <span class="string">&#x27;箱/件&#x27;</span>, <span class="string">&#x27;箱/件&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">2</span>, <span class="string">&#x27;个&#x27;</span>, <span class="string">&#x27;个&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">3</span>, <span class="string">&#x27;公斤&#x27;</span>, <span class="string">&#x27;公斤&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">4</span>, <span class="string">&#x27;只&#x27;</span>, <span class="string">&#x27;只&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">5</span>, <span class="string">&#x27;克&#x27;</span>, <span class="string">&#x27;克&#x27;</span>);</span><br><span class="line"><span class="keyword">INSERT INTO</span> `t_unit` <span class="keyword">VALUES</span> (<span class="number">6</span>, <span class="string">&#x27;台&#x27;</span>, <span class="string">&#x27;台&#x27;</span>);</span><br></pre></td></tr></table></figure><h3 id="后端实现-19"><a class="markdownIt-Anchor" href="#后端实现-19"></a> 后端实现</h3><h4 id="实现文件上传"><a class="markdownIt-Anchor" href="#实现文件上传"></a> 实现文件上传</h4><p>外部教程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tkuang/p/16094002.html">Spring 基础知识（19）- Spring MVC (九) | 文件上传、 文件下载</a></p><ul><li>添加了 commons-io 和 commons-fileupload 依赖。</li><li>创建了 FileController，使用 MultipartFile 接收前端上传的文件。</li><li>实现了文件保存逻辑：生成唯一文件名 (UUID + 后缀)，创建保存目录，使用 FileUtils.copyInputStreamToFile 将文件保存到服务器指定位置。</li><li>返回文件的可访问 URL 给前端。</li><li>通过 WebMvcConfigurer 配置了静态资源处理器 (addResourceHandlers)，使得上传到服务器本地目录的图片可以通过 URL 被外部访问。</li></ul><p><strong>添加依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-io<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.19.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 文件上传 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-fileupload<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加 FileController，使后端能接收前端的信息并存储</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">FileController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">UPLOAD_DIR</span> <span class="operator">=</span> <span class="string">&quot;uploads/imgs/&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/uploadImg&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">uploadImg</span><span class="params">(MultipartFile file)</span> &#123;</span><br><span class="line">        <span class="comment">// 检查文件是否为空</span></span><br><span class="line">        <span class="keyword">if</span> (file == <span class="literal">null</span> || file.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;文件为空&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 获取原始文件名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalName</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="keyword">if</span> (originalName == <span class="literal">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;文件名无效&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 生成新文件名</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">uuid</span> <span class="operator">=</span> UUID.randomUUID().toString();</span><br><span class="line">        <span class="type">String</span> <span class="variable">ext</span> <span class="operator">=</span> originalName.substring(originalName.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="type">String</span> <span class="variable">newName</span> <span class="operator">=</span> uuid + ext;</span><br><span class="line">        System.out.println(<span class="string">&quot;新文件名: &quot;</span> + newName);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建保存目录</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">dir</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(UPLOAD_DIR);</span><br><span class="line">        <span class="keyword">if</span> (!dir.exists()) &#123;</span><br><span class="line">            dir.mkdirs();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 创建目标文件</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">target</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(dir, newName);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// 保存文件</span></span><br><span class="line">            FileUtils.copyInputStreamToFile(file.getInputStream(), target);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="string">&quot;上传失败: &quot;</span> + e.getMessage();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 返回访问 URL</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;http://localhost:8080/uploads/imgs/&quot;</span> + newName;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 WebConfig，以配置 springboot，使后端能正常访问图片</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.ResourceHandlerRegistry;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.servlet.config.annotation.WebMvcConfigurer;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addResourceHandlers</span><span class="params">(ResourceHandlerRegistry registry)</span> &#123;</span><br><span class="line">        registry.addResourceHandler(<span class="string">&quot;/uploads/**&quot;</span>)</span><br><span class="line">                .addResourceLocations(<span class="string">&quot;file:./uploads/&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="实现前端字典接口"><a class="markdownIt-Anchor" href="#实现前端字典接口"></a> 实现前端字典接口</h4><ul><li>为上述每个关联表都创建了 Controller，提供了查询列表的接口（通常只查询 ID 和名称字段），专门用于前端的下拉框数据填充。这是典型的“数据字典”服务实现方式。</li></ul><p><strong>实现类似于字典的功能，方便前端展示下拉列表</strong></p><p>以下代码及其雷同，都是去查各个表的 id 和对应名称</p><p><strong>2. 创建 SupplyController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SupplyController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SupplyService supplyService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*加载供应商下拉列表框数据*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/supplyList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Supply&gt; <span class="title function_">querySupplyList</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Supply&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;supply_id&quot;</span>,<span class="string">&quot;supply_name&quot;</span>);</span><br><span class="line">        List&lt;Supply&gt; list = supplyService.list(wrapper);</span><br><span class="line">        <span class="keyword">return</span> list;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>3. 创建 PlaceController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PlaceController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PlaceService placeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理加载商品产地列表的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/placeList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Place&gt; <span class="title function_">queryPlaceList</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Place&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;place_id&quot;</span>,<span class="string">&quot;place_name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> placeService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>4. 创建 UnitController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UnitController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UnitService unitService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理加载商品单位的列表*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/unitList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Unit&gt; <span class="title function_">queryUnitList</span><span class="params">()</span>&#123;</span><br><span class="line"></span><br><span class="line">        QueryWrapper&lt;Unit&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;unit_id&quot;</span>,<span class="string">&quot;unit_name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> unitService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>5.创建 BrandController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BrandController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BrandService brandService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/brandList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Brand&gt; <span class="title function_">queryBrandList</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Brand&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;brand_id&quot;</span>,<span class="string">&quot;brand_name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> brandService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p><strong>6.创建 StoreController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">StoreController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StoreService storeService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理加载仓库选项的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/storeList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Store&gt; <span class="title function_">storeList</span><span class="params">()</span>&#123;</span><br><span class="line">        QueryWrapper&lt;Store&gt; wrapper=<span class="keyword">new</span> <span class="title class_">QueryWrapper</span>&lt;&gt;();</span><br><span class="line">        wrapper.select(<span class="string">&quot;store_id&quot;</span>,<span class="string">&quot;store_name&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> storeService.list(wrapper);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="实现对-item-的增删改查"><a class="markdownIt-Anchor" href="#实现对-item-的增删改查"></a> 实现对 item 的增删改查</h4><p><strong>修改 Item 实体类</strong></p><p>Item POJO 中添加了大量 @TableField(exist = false) 的扩展属性（如 brandName, placeName 等），用于在后端进行多表 INNER JOIN 查询后，将关联表的名称信息直接封装到 Item 对象中，方便前端直接展示。</p><p>添加注解，使前端能正常回显时间</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 生产日期</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date itemDate;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 到期日期</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class="line"><span class="keyword">private</span> Date endDate;</span><br></pre></td></tr></table></figure><p>添加字段，使其能回显字段对应名称</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//扩展属性封装名称</span></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String brandName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String placeName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String supplyName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String unitName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String cateName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String storeName;</span><br></pre></td></tr></table></figure><p><strong>新建 ItemCond 类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ItemCond</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String itemNum;</span><br><span class="line">    <span class="keyword">private</span> String itemName;</span><br><span class="line">    <span class="keyword">private</span> Integer statue;</span><br><span class="line">    <span class="keyword">private</span> Integer pageNum=<span class="number">1</span>;</span><br><span class="line">    <span class="keyword">private</span> Integer pageSize=<span class="number">3</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 mapper 方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现商品信息分页查询*/</span></span><br><span class="line">List&lt;Item&gt; <span class="title function_">queryItemListMapper</span><span class="params">(ItemCond itemCond)</span>;</span><br></pre></td></tr></table></figure><p>在 mapper.xml 里添加对应 sql</p><p>使用复杂的多表 INNER JOIN 和动态<where>及<if>条件（如按商品编号、名称、状态模糊查询），这比之前的动态查询更为复杂。</if></where></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryItemListMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.Item&quot;</span><br><span class="line">        parameterType<span class="operator">=</span>&quot;com.example.demo.vo.ItemCond&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> item.<span class="operator">*</span>,type.cate_name,brand.brand_name,store.store_name,</span><br><span class="line">    supply.supply_name,place.place_name,unit.unit_name <span class="keyword">from</span> t_item item</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_categrory type <span class="keyword">on</span> type.id<span class="operator">=</span>item.type_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_brand brand <span class="keyword">on</span> brand.brand_id<span class="operator">=</span>item.brand_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_store store <span class="keyword">on</span> store.store_id<span class="operator">=</span>item.store_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_supply supply <span class="keyword">on</span> supply.supply_id<span class="operator">=</span>item.supply_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_place place <span class="keyword">on</span> place.place_id<span class="operator">=</span>item.place_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_unit unit <span class="keyword">on</span> unit.unit_id<span class="operator">=</span>item.unit_id</span><br><span class="line">    <span class="operator">&lt;</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;itemNum!=null and itemNum!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            item.item_num <span class="keyword">like</span> concat(<span class="string">&#x27;%&#x27;</span>, #&#123;itemNum&#125;, <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;itemName!=null and itemName!=&#x27;&#x27;&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> item.item_name <span class="keyword">like</span> concat(<span class="string">&#x27;%&#x27;</span>, #&#123;itemName&#125;, <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">        <span class="operator">&lt;</span>if test<span class="operator">=</span>&quot;statue!=null&quot;<span class="operator">&gt;</span></span><br><span class="line">            <span class="keyword">and</span> item.statue<span class="operator">=</span>#&#123;statue&#125;</span><br><span class="line">        <span class="operator">&lt;</span><span class="operator">/</span>if<span class="operator">&gt;</span></span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">where</span><span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加 service 接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*商品分页查询*/</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">queryItemListService</span><span class="params">(ItemCond itemCond)</span>;</span><br></pre></td></tr></table></figure><p><strong>添加对应实现</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="comment">/* public Map&lt;String, Object&gt; queryItemListService(Integer pageNum, Integer pageSize) &#123;*/</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryItemListService</span><span class="params">(ItemCond itemCond)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);*/</span></span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(itemCond.getPageNum(), itemCond.getPageSize());</span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    <span class="comment">/*List&lt;Item&gt; items = itemMapper.queryItemListMapper();*/</span></span><br><span class="line">    List&lt;Item&gt; items = itemMapper.queryItemListMapper(itemCond);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;items&quot;</span>,items);</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 CodeUtils，方便给前端生成产品编码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CodeUtils</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*产生商品的编码*/</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> String <span class="title function_">toItemCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="type">SimpleDateFormat</span> <span class="variable">simpleDateFormat</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">SimpleDateFormat</span>(<span class="string">&quot;yyyyMMddHHmmssSSS&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> simpleDateFormat.format(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">main</span><span class="params">(String[] args)</span> &#123;</span><br><span class="line">        <span class="type">String</span> <span class="variable">code</span> <span class="operator">=</span> toItemCode();</span><br><span class="line">        System.out.println(code);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>创建 ItemController</strong>，实现增删改查接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">itemController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemService itemService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理产生商品编码的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/getCode&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">toItemCode</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> CodeUtils.toItemCode();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*添加商品信息*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveItem&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveItem</span><span class="params">(<span class="meta">@RequestBody</span> Item item)</span> &#123;</span><br><span class="line">        itemService.save(item);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;添加商品成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理商品信息分页查询请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/itemList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">itemList</span><span class="params">(<span class="meta">@RequestBody</span> ItemCond itemCond)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> itemService.queryItemListService(itemCond);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*删除商品信息*/</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/deleteItem/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteItem</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">removed</span> <span class="operator">=</span> itemService.removeById(id);</span><br><span class="line">        <span class="keyword">if</span> (removed) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*修改商品信息*/</span></span><br><span class="line">    <span class="meta">@PutMapping(&quot;/updateItem&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateItem</span><span class="params">(<span class="meta">@RequestBody</span> Item item)</span> &#123;</span><br><span class="line">        <span class="type">boolean</span> <span class="variable">updated</span> <span class="operator">=</span> itemService.updateById(item);</span><br><span class="line">        <span class="keyword">if</span> (updated) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理商量的下架请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/downItem/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">downItem</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Item</span>();</span><br><span class="line">        item.setId(id);</span><br><span class="line">        item.setStatue(<span class="number">1</span>); <span class="comment">// 1表示已下架状态</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">updated</span> <span class="operator">=</span> itemService.updateById(item);</span><br><span class="line">        <span class="keyword">if</span> (updated) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;商品下架成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;操作失败，请重试&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理商品上架请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/upItem/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">upItem</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">        <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">Item</span>();</span><br><span class="line">        item.setId(id);</span><br><span class="line">        item.setStatue(<span class="number">0</span>); <span class="comment">// 0表示已上架状态</span></span><br><span class="line">        <span class="type">boolean</span> <span class="variable">updated</span> <span class="operator">=</span> itemService.updateById(item);</span><br><span class="line">        <span class="keyword">if</span> (updated) &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;商品上架成功&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;操作失败，请重试&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="实现采购功能"><a class="markdownIt-Anchor" href="#实现采购功能"></a> 实现采购功能</h4><p><strong>创建采购表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_buy_list` (</span><br><span class="line">  `buy_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;采购单ID&#x27;</span>,</span><br><span class="line">  `product_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产品ID，关联产品表&#x27;</span>,</span><br><span class="line">  `store_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库ID，关联仓库表&#x27;</span>,</span><br><span class="line">  `buy_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;计划采购数量&#x27;</span>,</span><br><span class="line">  `fact_buy_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;实际采购数量&#x27;</span>,</span><br><span class="line">  `buy_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购时间&#x27;</span>,</span><br><span class="line">  `supply_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商ID，关联供应商表&#x27;</span>,</span><br><span class="line">  `place_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购地点ID，关联地点表&#x27;</span>,</span><br><span class="line">  `buy_user` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购人姓名&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购人联系电话&#x27;</span>,</span><br><span class="line">  `is_in` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;是否入库：0-否，1-是&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`buy_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">49</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 COMMENT<span class="operator">=</span><span class="string">&#x27;采购单表，记录商品采购信息&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>用 mybatiesx 生成对应层级代码</strong></p><p><strong>BuyListService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理采购单需要自动带入的数据*/</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryAutoDataBuyService</span><span class="params">(Integer id)</span>;</span><br></pre></td></tr></table></figure><p><strong>在 impl 里实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuyListServiceImpl</span> <span class="keyword">extends</span> <span class="title class_">ServiceImpl</span>&lt;BuyListMapper, BuyList&gt;</span><br><span class="line">    <span class="keyword">implements</span> <span class="title class_">BuyListService</span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ItemMapper itemMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StoreMapper storeMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SupplyMapper supplyMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PlaceMapper placeMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryAutoDataBuyService</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//查询商品信息</span></span><br><span class="line">        <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> itemMapper.selectById(id);</span><br><span class="line">        result.put(<span class="string">&quot;id&quot;</span>,item.getId());</span><br><span class="line">        result.put(<span class="string">&quot;itemName&quot;</span>,item.getItemName());</span><br><span class="line">        <span class="comment">//查询仓库信息</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">storeId</span> <span class="operator">=</span> item.getStoreId();</span><br><span class="line">        <span class="type">Store</span> <span class="variable">store</span> <span class="operator">=</span> storeMapper.selectById(storeId);</span><br><span class="line">        result.put(<span class="string">&quot;storeId&quot;</span>,store.getStoreId());</span><br><span class="line">        result.put(<span class="string">&quot;storeName&quot;</span>,store.getStoreName());</span><br><span class="line">        <span class="comment">//查询供应商信息</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">supplyId</span> <span class="operator">=</span> item.getSupplyId();</span><br><span class="line">        <span class="type">Supply</span> <span class="variable">supply</span> <span class="operator">=</span> supplyMapper.selectById(supplyId);</span><br><span class="line">        result.put(<span class="string">&quot;supplyId&quot;</span>,supply.getSupplyId());</span><br><span class="line">        result.put(<span class="string">&quot;supplyName&quot;</span>,supply.getSupplyName());</span><br><span class="line">        <span class="comment">//查询产地信息</span></span><br><span class="line">        <span class="type">Integer</span> <span class="variable">placeId</span> <span class="operator">=</span> item.getPlaceId();</span><br><span class="line">        <span class="type">Place</span> <span class="variable">place</span> <span class="operator">=</span> placeMapper.selectById(placeId);</span><br><span class="line">        result.put(<span class="string">&quot;placeId&quot;</span>,place.getPlaceId());</span><br><span class="line">        result.put(<span class="string">&quot;placeName&quot;</span>,place.getPlaceName());</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 BuyListController 控制层代码</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuyListController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> BuyListService buyListService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理采购信息需要自动带入数据的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/buyAutoInfo/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">buyAutoInfo</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> buyListService.queryAutoDataBuyService(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*保存采购信息*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveBuy&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveBuy</span><span class="params">(<span class="meta">@RequestBody</span> BuyList buyList)</span>&#123;</span><br><span class="line">        buyList.setBuyTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        buyList.setIsIn(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        buyList.setFactBuyNum(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> buyListService.save(buyList)? ResponseUtil.success(<span class="string">&quot;保存成功&quot;</span>):ResponseUtil.error(<span class="string">&quot;保存失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="前端实现-19"><a class="markdownIt-Anchor" href="#前端实现-19"></a> 前端实现</h3><p><strong>实现商品信息页面</strong></p><ul><li><p>ItemManager.vue 中的添加/修改商品表单包含了大量的输入项，包括多个下拉选择框（品牌、门店、供应商、产地、单位等），这些下拉框的数据都是通过调用后端提供的字典接口动态加载的 (loadAllData 使用 Promise.all 并行加载)。</p></li><li><p>使用 Element Plus 的 el-upload 组件实现图片上传界面 (list-type=“picture-card”)。</p></li><li><p>配置了 action (后端上传接口 URL)、:on-success (上传成功回调，将返回的图片 URL 保存到表单数据中)、:on-remove (移除图片回调)、:on-preview (图片预览)。</p></li></ul><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>商品信息<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">    <span class="attr">style</span>=<span class="string">&quot;display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openItemDialog&quot;</span>&gt;</span>添加商品<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:inline</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">&quot;searchForm&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">class</span>=<span class="string">&quot;search-form&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;searchFormRef&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品编号&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemNum&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;searchForm.itemNum&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请输入商品编号&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">clearable</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;searchForm.itemName&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请输入商品名称&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">clearable</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;statue&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;searchForm.statue&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">placeholder</span>=<span class="string">&quot;请选择&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">clearable</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 100px;&quot;</span></span></span><br><span class="line"><span class="tag">        &gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;上架&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;下架&quot;</span> <span class="attr">:value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleSearch&quot;</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;resetSearchForm&quot;</span>&gt;</span>重置<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 商品列表表格 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;itemList&quot;</span> <span class="attr">row-key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">stripe</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;expand&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-descriptions</span> <span class="attr">:column</span>=<span class="string">&quot;2&quot;</span> <span class="attr">border</span> <span class="attr">style</span>=<span class="string">&quot;margin: 10px 20px;&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;商品图片&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">template</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-if</span>=<span class="string">&quot;row.imgs &amp;&amp; Array.isArray(row.imgs) &amp;&amp; row.imgs.length &gt; 0&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;image-preview&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-image</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">v-for</span>=<span class="string">&quot;(img, index) in row.imgs&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:key</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:src</span>=<span class="string">&quot;img&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:preview-src-list</span>=<span class="string">&quot;row.imgs&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:initial-index</span>=<span class="string">&quot;index&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:preview-teleported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">:z-index</span>=<span class="string">&quot;3000&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">class</span>=<span class="string">&quot;table-image&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">fit</span>=<span class="string">&quot;cover&quot;</span></span></span><br><span class="line"><span class="tag">                  <span class="attr">style</span>=<span class="string">&quot;width: 60px; height: 60px; margin-right: 5px; border-radius: 4px;&quot;</span></span></span><br><span class="line"><span class="tag">                  @<span class="attr">error</span>=<span class="string">&quot;() =&gt; handleImageError(index)&quot;</span></span></span><br><span class="line"><span class="tag">                &gt;</span></span><br><span class="line">                  <span class="tag">&lt;<span class="name">template</span> #<span class="attr">error</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">div</span></span></span><br><span class="line"><span class="tag">                      <span class="attr">style</span>=<span class="string">&quot;width: 60px; height: 60px; display: flex; align-items: center; justify-content: center; background: #f5f7fa; color: #909399; font-size: 12px;&quot;</span></span></span><br><span class="line"><span class="tag">                    &gt;</span></span><br><span class="line">                      加载失败<span class="tag">&lt;<span class="name">br</span> /&gt;</span>或无图片</span><br><span class="line">                    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">                  <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-image</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span>&gt;</span>无图片<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-descriptions-item</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;商品描述&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.itemDesc &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;进货价格&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.price &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;会员价格&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.vipPrice &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;供应商&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.supplyName &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;产地&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.placeName &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;单位&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.unitName &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;所属仓库&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.storeName &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;生产日期&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.itemDate &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;到期日期&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.endDate &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;促销标题&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.hotTitle &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;制造商&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.facturer &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">          <span class="tag">&lt;<span class="name">el-descriptions-item</span> <span class="attr">label</span>=<span class="string">&quot;创建者&quot;</span></span></span><br><span class="line"><span class="tag">            &gt;</span>&#123;&#123; row.createBy &#125;&#125;&lt;/el-descriptions-item</span><br><span class="line">          &gt;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-descriptions</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;商品编号&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemNum&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;商品类型&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;cateName&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;品牌&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;brandName&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;库存&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;store&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;销售价格&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;sellPrice&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;statue&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-tag</span> <span class="attr">:type</span>=<span class="string">&quot;row.statue === 0 ? &#x27;success&#x27; : &#x27;danger&#x27;&quot;</span>&gt;</span></span><br><span class="line">          &#123;&#123; row.statue === 0 ? &#x27;上架&#x27; : &#x27;下架&#x27; &#125;&#125;</span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-tag</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; row &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;handleDeleteItem(row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;openUpdateDialog(row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;openPurchaseDialog(row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>采购&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;row.statue === 1&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;success&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;handleUpItem(row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>上架&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;row.statue === 0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;warning&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;handleDownItem(row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>下架&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 分页器 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlePageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 添加商品对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogItemVisible&quot;</span> <span class="attr">:width</span>=<span class="string">&quot;dialogWidth&quot;</span> <span class="attr">title</span>=<span class="string">&quot;添加商品&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;margin-bottom: 20px;&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">span</span>&gt;</span>商品图片:<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-upload</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:action</span>=<span class="string">&quot;uploadImageUrl&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:auto-upload</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:file-list</span>=<span class="string">&quot;fileList&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:on-preview</span>=<span class="string">&quot;handlePictureCardPreview&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:on-remove</span>=<span class="string">&quot;handleRemove&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">:on-success</span>=<span class="string">&quot;handleAvatarSuccess&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">list-type</span>=<span class="string">&quot;picture-card&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">method</span>=<span class="string">&quot;post&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">preview-teleported</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-icon</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">Plus</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-icon</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-upload</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;itemFormRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:model</span>=<span class="string">&quot;itemForm&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:rules</span>=<span class="string">&quot;itemRules&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-row</span> <span class="attr">:gutter</span>=<span class="string">&quot;20&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品编号&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemNum&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.itemNum&quot;</span> <span class="attr">readonly</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.itemName&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品类型&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;typeId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;selectedTypeName&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">disabled</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placeholder</span>=<span class="string">&quot;点击选择商品类型&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">              <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">style</span>=<span class="string">&quot;margin-left: 10px;&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">              @<span class="attr">click</span>=<span class="string">&quot;openTypeDialog&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span>选择&lt;/el-button</span><br><span class="line">            &gt;</span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;库存数量&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;store&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;itemForm.store&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;品牌&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;brandId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.brandId&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择品牌&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;item in brandList&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;item.brandId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:label</span>=<span class="string">&quot;item.brandName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:value</span>=<span class="string">&quot;item.brandId&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;门店&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;storeId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.storeId&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择门店&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;item in storeList&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;item.storeId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:label</span>=<span class="string">&quot;item.storeName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:value</span>=<span class="string">&quot;item.storeId&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;供应商&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;supplyId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.supplyId&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择供应商&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;item in supplyList&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;item.supplyId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:label</span>=<span class="string">&quot;item.supplyName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:value</span>=<span class="string">&quot;item.supplyId&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;产地&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;placeId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.placeId&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择产地&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;item in placeList&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;item.placeId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:label</span>=<span class="string">&quot;item.placeName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:value</span>=<span class="string">&quot;item.placeId&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;单位&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;unitId&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.unitId&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择单位&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;item in unitList&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:key</span>=<span class="string">&quot;item.unitId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:label</span>=<span class="string">&quot;item.unitName&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:value</span>=<span class="string">&quot;item.unitId&quot;</span></span></span><br><span class="line"><span class="tag">              /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;进货价格&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;price&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;itemForm.price&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;销售价格&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;sellPrice&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;itemForm.sellPrice&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;会员价格&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;vipPrice&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model.number</span>=<span class="string">&quot;itemForm.vipPrice&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;24&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;24&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品描述&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemDesc&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.itemDesc&quot;</span> <span class="attr">:rows</span>=<span class="string">&quot;3&quot;</span> <span class="attr">type</span>=<span class="string">&quot;textarea&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;生产日期&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;itemDate&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-date-picker</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;itemForm.itemDate&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placeholder</span>=<span class="string">&quot;选择生产日期&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;date&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;到期日期&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;endDate&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-date-picker</span></span></span><br><span class="line"><span class="tag">              <span class="attr">v-model</span>=<span class="string">&quot;itemForm.endDate&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">placeholder</span>=<span class="string">&quot;选择到期日期&quot;</span></span></span><br><span class="line"><span class="tag">              <span class="attr">type</span>=<span class="string">&quot;date&quot;</span></span></span><br><span class="line"><span class="tag">            /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;促销标题&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;hotTitle&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.hotTitle&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;制造商&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;facturer&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.facturer&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品状态&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;statue&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.statue&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择状态&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">:value</span>=<span class="string">&quot;0&quot;</span> <span class="attr">label</span>=<span class="string">&quot;上架&quot;</span> /&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">:value</span>=<span class="string">&quot;1&quot;</span> <span class="attr">label</span>=<span class="string">&quot;下架&quot;</span> /&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:md</span>=<span class="string">&quot;8&quot;</span> <span class="attr">:sm</span>=<span class="string">&quot;12&quot;</span> <span class="attr">:xs</span>=<span class="string">&quot;24&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;创建者&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;createBy&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;itemForm.createBy&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-row</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogItemVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitItem&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 商品类型选择对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-model</span>=<span class="string">&quot;dialogTypeVisible&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:width</span>=<span class="string">&quot;dialogWidth&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">title</span>=<span class="string">&quot;选择商品类型&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-tree</span></span></span><br><span class="line"><span class="tag">      <span class="attr">ref</span>=<span class="string">&quot;typeTreeRef&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:data</span>=<span class="string">&quot;typeList&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:expand-on-click-node</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:highlight-current</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">:props</span>=<span class="string">&quot;typeTreeConfig&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">default-expand-all</span></span></span><br><span class="line"><span class="tag">      <span class="attr">node-key</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">      @<span class="attr">node-click</span>=<span class="string">&quot;handleTypeNodeClick&quot;</span></span></span><br><span class="line"><span class="tag">    &gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;&#123; node &#125;&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; node.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-tree</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;dialogTypeVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;confirmTypeSelection&quot;</span>&gt;</span>确认<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 采购对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;buyDialog&quot;</span> <span class="attr">title</span>=<span class="string">&quot;商品采购&quot;</span> <span class="attr">:width</span>=<span class="string">&quot;dialogWidth&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;buyForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;buyFormRef&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.itemName&quot;</span> <span class="attr">disabled</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;门店&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.storeName&quot;</span> <span class="attr">disabled</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;供应商&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.supplyName&quot;</span> <span class="attr">disabled</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;产地&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.placeName&quot;</span> <span class="attr">disabled</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;采购数量&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;buyNum&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.buyNum&quot;</span> <span class="attr">type</span>=<span class="string">&quot;number&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;采购人&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;buyUser&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.buyUser&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系电话&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.phone&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> #<span class="attr">footer</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;buyDialog = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;submitPurchase&quot;</span>&gt;</span>确认采购<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 图片预览组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-image-viewer</span></span></span><br><span class="line"><span class="tag">    <span class="attr">v-if</span>=<span class="string">&quot;dialogVisible&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:hide-on-click-modal</span>=<span class="string">&quot;false&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:initial-index</span>=<span class="string">&quot;0&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:teleported</span>=<span class="string">&quot;true&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:url-list</span>=<span class="string">&quot;[dialogImageUrl]&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:z-index</span>=<span class="string">&quot;3000&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:zoom-rate</span>=<span class="string">&quot;1.2&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">close</span>=<span class="string">&quot;dialogVisible = false&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; computed, nextTick, onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">Plus</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@element-plus/icons-vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span>, <span class="title class_">ElMessageBox</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; categoryApi &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/category&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; itemApi, uploadImageUrl &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/item&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理图片加载错误</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleImageError</span>(<span class="params">index</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">`图片加载失败: <span class="subst">$&#123;index&#125;</span>`</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 对话框状态和图片上传相关</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogItemVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogTypeVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogImageUrl = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> typeTreeRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> searchFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> fileList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 采购表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">productId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">buyNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">buyUser</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 采购对话框状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyDialog = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyFormRef = <span class="title function_">ref</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 列表数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 响应式对话框宽度</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogWidth = <span class="title function_">computed</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">return</span> <span class="variable language_">window</span>.<span class="property">innerWidth</span> &lt; <span class="number">768</span></span></span><br><span class="line"><span class="language-javascript">      ? <span class="string">&quot;90%&quot;</span></span></span><br><span class="line"><span class="language-javascript">      : <span class="variable language_">window</span>.<span class="property">innerWidth</span> &lt; <span class="number">1024</span></span></span><br><span class="line"><span class="language-javascript">      ? <span class="string">&quot;70%&quot;</span></span></span><br><span class="line"><span class="language-javascript">      : <span class="string">&quot;60%&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 树形结构配置</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> typeTreeConfig = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="string">&quot;id&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">label</span>: <span class="string">&quot;label&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">children</span>: <span class="string">&quot;children&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 查询表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> searchForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">statue</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 商品表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> initialItemFormState = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">typeId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">store</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">brandId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">unitId</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">price</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">sellPrice</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">vipPrice</span>: <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemDesc</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemDate</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">endDate</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">hotTitle</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">facturer</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">statue</span>: <span class="number">1</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">imgs</span>: [],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">createBy</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">id</span>: <span class="literal">null</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemForm = <span class="title function_">reactive</span>(&#123; ...initialItemFormState &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 显示选中的类型名称</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> selectedTypeName = <span class="title function_">ref</span>(<span class="string">&quot;&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 表单验证规则</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> itemRules = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemNum</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入商品编号&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入商品名称&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">typeId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择商品类型&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">store</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入库存数量&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">brandId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择品牌&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择门店&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择供应商&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择产地&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">unitId</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择单位&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">price</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入进货价格&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">sellPrice</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入销售价格&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">vipPrice</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请输入会员价格&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;blur&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemDate</span>: [</span></span><br><span class="line"><span class="language-javascript">      &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择生产日期&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;,</span></span><br><span class="line"><span class="language-javascript">    ],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">endDate</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择到期日期&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">statue</span>: [&#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&quot;请选择商品状态&quot;</span>, <span class="attr">trigger</span>: <span class="string">&quot;change&quot;</span> &#125;],</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 列表数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> typeList = <span class="title function_">ref</span>([]),</span></span><br><span class="line"><span class="language-javascript">    supplyList = <span class="title function_">ref</span>([]),</span></span><br><span class="line"><span class="language-javascript">    placeList = <span class="title function_">ref</span>([]),</span></span><br><span class="line"><span class="language-javascript">    unitList = <span class="title function_">ref</span>([]),</span></span><br><span class="line"><span class="language-javascript">    brandList = <span class="title function_">ref</span>([]),</span></span><br><span class="line"><span class="language-javascript">    storeList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 重置与商品表单相关的状态（如选中的类型名称和文件列表）</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetItemRelatedState</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    selectedTypeName.<span class="property">value</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    fileList.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开商品信息对话框并加载所有数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openItemDialog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 重置表单和相关状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(itemForm, &#123; ...initialItemFormState &#125;);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetItemRelatedState</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//确保DOM更新完毕后再调用resetFields，以保证itemFormRef可用</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">nextTick</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (itemFormRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        itemFormRef.<span class="property">value</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 获取商品编号</span></span></span><br><span class="line"><span class="language-javascript">    itemApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getItemCode</span>()</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        itemForm.<span class="property">itemNum</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;获取商品编号失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    dialogItemVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开商品类型选择对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openTypeDialog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogTypeVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理类型树节点点击</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleTypeNodeClick</span>(<span class="params">data</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (data.<span class="property">children</span> &amp;&amp; data.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;只能选择叶子节点&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      typeTreeRef.<span class="property">value</span>.<span class="title function_">setCurrentKey</span>(<span class="literal">null</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      typeTreeRef.<span class="property">value</span>.<span class="title function_">setCurrentKey</span>(data.<span class="property">id</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 确认类型选择</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">confirmTypeSelection</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> selectedNode = typeTreeRef.<span class="property">value</span>.<span class="title function_">getCurrentNode</span>();</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (!selectedNode) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;请选择一个商品类型&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (selectedNode.<span class="property">children</span> &amp;&amp; selectedNode.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;只能选择叶子节点&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    itemForm.<span class="property">typeId</span> = selectedNode.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">    selectedTypeName.<span class="property">value</span> = selectedNode.<span class="property">label</span>;</span></span><br><span class="line"><span class="language-javascript">    dialogTypeVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 图片上传成功回调</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleAvatarSuccess</span>(<span class="params">response</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> imageUrl =</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">typeof</span> response === <span class="string">&quot;string&quot;</span> ? response : response.<span class="property">url</span> || <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (imageUrl) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (!<span class="title class_">Array</span>.<span class="title function_">isArray</span>(itemForm.<span class="property">imgs</span>)) itemForm.<span class="property">imgs</span> = [];</span></span><br><span class="line"><span class="language-javascript">      itemForm.<span class="property">imgs</span>.<span class="title function_">push</span>(imageUrl);</span></span><br><span class="line"><span class="language-javascript">      fileList.<span class="property">value</span>.<span class="title function_">push</span>(&#123; <span class="attr">url</span>: imageUrl, <span class="attr">status</span>: <span class="string">&quot;success&quot;</span> &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 移除图片</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleRemove</span>(<span class="params">file</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> index = fileList.<span class="property">value</span>.<span class="title function_">indexOf</span>(file);</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (index !== -<span class="number">1</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      fileList.<span class="property">value</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">      itemForm.<span class="property">imgs</span>.<span class="title function_">splice</span>(index, <span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 图片预览</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlePictureCardPreview</span>(<span class="params">uploadFile</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogImageUrl.<span class="property">value</span> = uploadFile.<span class="property">url</span>;</span></span><br><span class="line"><span class="language-javascript">    dialogVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 提交表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">submitItem</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    itemFormRef.<span class="property">value</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> apiCall = itemForm.<span class="property">id</span></span></span><br><span class="line"><span class="language-javascript">          ? itemApi.<span class="title function_">updateItem</span>(itemForm)</span></span><br><span class="line"><span class="language-javascript">          : itemApi.<span class="title function_">saveItem</span>(itemForm);</span></span><br><span class="line"><span class="language-javascript">        apiCall</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span> &amp;&amp; response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">500</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;操作失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">              <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(itemForm.<span class="property">id</span> ? <span class="string">&quot;修改成功&quot;</span> : <span class="string">&quot;添加成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            dialogItemVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">Object</span>.<span class="title function_">assign</span>(itemForm, &#123; ...initialItemFormState &#125;);</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resetItemRelatedState</span>();</span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">loadItemList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">const</span> errorMsg =</span></span><br><span class="line"><span class="language-javascript">              error.<span class="property">response</span>?.<span class="property">data</span>?.<span class="property">message</span> || <span class="string">&quot;保存失败，请稍后重试&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(errorMsg);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 提交采购表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">submitPurchase</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    buyFormRef.<span class="property">value</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">if</span> (valid) &#123;</span></span><br><span class="line"><span class="language-javascript">        itemApi</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">saveBuy</span>(buyForm)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;采购成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">              buyDialog.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">loadItemList</span>(<span class="number">1</span>); <span class="comment">// 刷新商品列表</span></span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">Object</span>.<span class="title function_">assign</span>(buyForm, &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">productId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">storeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">supplyId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">placeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">supplyName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">placeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">buyNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">buyUser</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;采购失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;采购失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;采购失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;请填写完整的采购信息&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 加载所有数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadAllData</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Promise</span>.<span class="title function_">all</span>([</span></span><br><span class="line"><span class="language-javascript">      categoryApi.<span class="title function_">getCategoryTree</span>(),</span></span><br><span class="line"><span class="language-javascript">      itemApi.<span class="title function_">getSupplyList</span>(),</span></span><br><span class="line"><span class="language-javascript">      itemApi.<span class="title function_">getPlaceList</span>(),</span></span><br><span class="line"><span class="language-javascript">      itemApi.<span class="title function_">getUnitList</span>(),</span></span><br><span class="line"><span class="language-javascript">      itemApi.<span class="title function_">getBrandList</span>(),</span></span><br><span class="line"><span class="language-javascript">      itemApi.<span class="title function_">getStoreList</span>(),</span></span><br><span class="line"><span class="language-javascript">    ])</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">[typeRes, supplyRes, placeRes, unitRes, brandRes, storeRes]</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        typeList.<span class="property">value</span> = typeRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        supplyList.<span class="property">value</span> = supplyRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        placeList.<span class="property">value</span> = placeRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        unitList.<span class="property">value</span> = unitRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        brandList.<span class="property">value</span> = brandRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        storeList.<span class="property">value</span> = storeRes.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;加载数据失败，请稍后重试&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 加载商品列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadItemList</span>(<span class="params">pageNum = <span class="number">1</span>, pageSize = <span class="number">10</span></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> params = &#123;</span></span><br><span class="line"><span class="language-javascript">      pageNum,</span></span><br><span class="line"><span class="language-javascript">      pageSize,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemNum</span>: searchForm.<span class="property">itemNum</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemName</span>: searchForm.<span class="property">itemName</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">statue</span>: searchForm.<span class="property">statue</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;;</span></span><br><span class="line"><span class="language-javascript">    itemApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getItemList</span>(params)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 确保从后端正确解析数据</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span> &amp;&amp; response.<span class="property">data</span>.<span class="property">items</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          itemList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">items</span>;</span></span><br><span class="line"><span class="language-javascript">          total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">// 处理可能的空数据或错误格式</span></span></span><br><span class="line"><span class="language-javascript">          itemList.<span class="property">value</span> = [];</span></span><br><span class="line"><span class="language-javascript">          total.<span class="property">value</span> = <span class="number">0</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;商品数据格式不正确或为空&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;加载商品列表失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理查询</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleSearch</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadItemList</span>(<span class="number">1</span>); <span class="comment">// 查询时总是从第一页开始</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 重置查询表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetSearchForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (searchFormRef.<span class="property">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      searchFormRef.<span class="property">value</span>.<span class="title function_">resetFields</span>();</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 手动清空searchForm reactive对象的值，因为resetFields可能不会完全清空</span></span></span><br><span class="line"><span class="language-javascript">    searchForm.<span class="property">itemNum</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    searchForm.<span class="property">itemName</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    searchForm.<span class="property">statue</span> = <span class="literal">null</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadItemList</span>(<span class="number">1</span>); <span class="comment">// 重置后重新加载数据</span></span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 删除商品</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleDeleteItem</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ElMessageBox</span>.<span class="title function_">confirm</span>(<span class="string">&quot;确定要删除这个商品吗？&quot;</span>, <span class="string">&quot;提示&quot;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">confirmButtonText</span>: <span class="string">&quot;确定&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">cancelButtonText</span>: <span class="string">&quot;取消&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">type</span>: <span class="string">&quot;warning&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        itemApi</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">deleteItem</span>(id)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;删除成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">              <span class="title function_">loadItemList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;删除失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            &#125;</span></span><br><span class="line"><span class="language-javascript">          &#125;)</span></span><br><span class="line"><span class="language-javascript">          .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          &#125;);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">info</span>(<span class="string">&quot;已取消删除&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理商品下架</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleDownItem</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    itemApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">downItem</span>(id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;下架成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadItemList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;下架失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;下架失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理商品上架</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleUpItem</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    itemApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">upItem</span>(id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> === <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">success</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;上架成功&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">loadItemList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(response.<span class="property">data</span>.<span class="property">message</span> || <span class="string">&quot;上架失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;上架失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开修改对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openUpdateDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogItemVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(itemForm, &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">id</span>: row.<span class="property">id</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemNum</span>: row.<span class="property">itemNum</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemName</span>: row.<span class="property">itemName</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">typeId</span>: row.<span class="property">typeId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">store</span>: row.<span class="property">store</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">brandId</span>: row.<span class="property">brandId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">storeId</span>: row.<span class="property">storeId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">supplyId</span>: row.<span class="property">supplyId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">placeId</span>: row.<span class="property">placeId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">unitId</span>: row.<span class="property">unitId</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">price</span>: row.<span class="property">price</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">sellPrice</span>: row.<span class="property">sellPrice</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">vipPrice</span>: row.<span class="property">vipPrice</span> || <span class="number">0</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemDesc</span>: row.<span class="property">itemDesc</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">itemDate</span>: row.<span class="property">itemDate</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">endDate</span>: row.<span class="property">endDate</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">hotTitle</span>: row.<span class="property">hotTitle</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">facturer</span>: row.<span class="property">facturer</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">statue</span>: row.<span class="property">statue</span>,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">imgs</span>: row.<span class="property">imgs</span> || [],</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">createBy</span>: row.<span class="property">createBy</span> || <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;);</span></span><br><span class="line"><span class="language-javascript">    fileList.<span class="property">value</span> = (row.<span class="property">imgs</span> || []).<span class="title function_">map</span>(<span class="function">(<span class="params">url</span>) =&gt;</span> (&#123;</span></span><br><span class="line"><span class="language-javascript">      url,</span></span><br><span class="line"><span class="language-javascript">      <span class="attr">status</span>: <span class="string">&quot;success&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    &#125;));</span></span><br><span class="line"><span class="language-javascript">    selectedTypeName.<span class="property">value</span> = row.<span class="property">cateName</span> || <span class="string">&quot;&quot;</span>; <span class="comment">// 使用 cateName 对应后端的商品类型名称</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadAllData</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 生命周期钩子</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="function">() =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadItemList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadAllData</span>(); <span class="comment">// 组件挂载时加载所有下拉列表数据</span></span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 处理分页</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlePageChange</span>(<span class="params">value</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadItemList</span>(value);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开采购对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openPurchaseDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    buyDialog.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 发送ajax请求，获取需要带入的数据</span></span></span><br><span class="line"><span class="language-javascript">    itemApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">getBuyAutoInfo</span>(row.<span class="property">id</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 获取响应数据对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> item = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 将响应数据赋值给buyForm表单</span></span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">productId</span> = item.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">itemName</span> = item.<span class="property">itemName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">storeId</span> = item.<span class="property">storeId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">storeName</span> = item.<span class="property">storeName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">supplyId</span> = item.<span class="property">supplyId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">supplyName</span> = item.<span class="property">supplyName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">placeId</span> = item.<span class="property">placeId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">placeName</span> = item.<span class="property">placeName</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;获取采购信息失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;获取采购信息失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>注册页面方法之前讲过，这里不重复</strong></p><h2 id="day15"><a class="markdownIt-Anchor" href="#day15"></a> Day15</h2><h3 id="1实现采购管理"><a class="markdownIt-Anchor" href="#1实现采购管理"></a> 1.实现采购管理</h3><ul><li><strong>采购单管理 (t_buy_list)：</strong><ul><li>实现了采购单的后端增删改查和前端列表展示、修改对话框等。</li><li><strong>自动带入数据：</strong> 在商品列表页面点击“采购”按钮时，会弹出一个采购对话框，并通过调用后端接口 (/buyAutoInfo/{id}) 自动带入与该商品相关的默认信息（如商品名称、仓库、供应商、产地）。</li></ul></li></ul><h4 id="后端实现-20"><a class="markdownIt-Anchor" href="#后端实现-20"></a> 后端实现</h4><p><strong>添加数据库表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_buy_list` (</span><br><span class="line">  `buy_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;采购单ID&#x27;</span>,</span><br><span class="line">  `product_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产品ID，关联产品表&#x27;</span>,</span><br><span class="line">  `store_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库ID，关联仓库表&#x27;</span>,</span><br><span class="line">  `buy_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;计划采购数量&#x27;</span>,</span><br><span class="line">  `fact_buy_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;实际采购数量&#x27;</span>,</span><br><span class="line">  `buy_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购时间&#x27;</span>,</span><br><span class="line">  `supply_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;供应商ID，关联供应商表&#x27;</span>,</span><br><span class="line">  `place_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购地点ID，关联地点表&#x27;</span>,</span><br><span class="line">  `buy_user` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购人姓名&#x27;</span>,</span><br><span class="line">  `phone` <span class="type">varchar</span>(<span class="number">20</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;采购人联系电话&#x27;</span>,</span><br><span class="line">  `is_in` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;是否入库：0-否，1-是&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`buy_id`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">49</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 COMMENT<span class="operator">=</span><span class="string">&#x27;采购单表，记录商品采购信息&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>用 mybatiesx 插件生成代码</strong></p><p><strong>生成的 Buylistpojo 添加属性</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * 采购时间</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@JsonFormat(pattern = &quot;yyyy-MM-dd HH:mm:ss&quot;)</span><span class="comment">//添加注释使前端能正常解析</span></span><br><span class="line"><span class="keyword">private</span> Date buyTime;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String itemName;</span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String storeName;</span><br></pre></td></tr></table></figure><p><strong>对应 mapper 添加接口方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现采购单列表分页查询*/</span></span><br><span class="line">List&lt;BuyList&gt; <span class="title function_">queryBuyListMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>实现对应 sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--实现采购单列表分页查询--&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryBuyListMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.BuyList&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> buy.<span class="operator">*</span>, store.store_name, item.item_name</span><br><span class="line">    <span class="keyword">from</span> t_buy_list buy</span><br><span class="line">             <span class="keyword">inner</span> <span class="keyword">join</span> t_store store <span class="keyword">on</span> buy.store_id <span class="operator">=</span> store.store_id</span><br><span class="line">             <span class="keyword">inner</span> <span class="keyword">join</span> t_item item <span class="keyword">on</span> buy.product_id <span class="operator">=</span> item.id</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加 service 方法接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理采购单需要自动带入的数据*/</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">queryAutoDataBuyService</span><span class="params">(Integer id)</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*实现采购单分页查询*/</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">queryBuyListService</span><span class="params">(Integer pageNum,Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现接口方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ItemMapper itemMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> StoreMapper storeMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> SupplyMapper supplyMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> PlaceMapper placeMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">BuyListServiceImpl</span><span class="params">(ItemMapper itemMapper, StoreMapper storeMapper, SupplyMapper supplyMapper, PlaceMapper placeMapper, BuyListMapper buyListMapper)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.itemMapper = itemMapper;</span><br><span class="line">    <span class="built_in">this</span>.storeMapper = storeMapper;</span><br><span class="line">    <span class="built_in">this</span>.supplyMapper = supplyMapper;</span><br><span class="line">    <span class="built_in">this</span>.placeMapper = placeMapper;</span><br><span class="line">    <span class="built_in">this</span>.buyListMapper = buyListMapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryAutoDataBuyService</span><span class="params">(Integer id)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">//查询商品信息</span></span><br><span class="line">    <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span> itemMapper.selectById(id);</span><br><span class="line">    result.put(<span class="string">&quot;id&quot;</span>,item.getId());</span><br><span class="line">    result.put(<span class="string">&quot;itemName&quot;</span>,item.getItemName());</span><br><span class="line">    <span class="comment">//查询仓库信息</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">storeId</span> <span class="operator">=</span> item.getStoreId();</span><br><span class="line">    <span class="type">Store</span> <span class="variable">store</span> <span class="operator">=</span> storeMapper.selectById(storeId);</span><br><span class="line">    result.put(<span class="string">&quot;storeId&quot;</span>,store.getStoreId());</span><br><span class="line">    result.put(<span class="string">&quot;storeName&quot;</span>,store.getStoreName());</span><br><span class="line">    <span class="comment">//查询供应商信息</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">supplyId</span> <span class="operator">=</span> item.getSupplyId();</span><br><span class="line">    <span class="type">Supply</span> <span class="variable">supply</span> <span class="operator">=</span> supplyMapper.selectById(supplyId);</span><br><span class="line">    result.put(<span class="string">&quot;supplyId&quot;</span>,supply.getSupplyId());</span><br><span class="line">    result.put(<span class="string">&quot;supplyName&quot;</span>,supply.getSupplyName());</span><br><span class="line">    <span class="comment">//查询产地信息</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">placeId</span> <span class="operator">=</span> item.getPlaceId();</span><br><span class="line">    <span class="type">Place</span> <span class="variable">place</span> <span class="operator">=</span> placeMapper.selectById(placeId);</span><br><span class="line">    result.put(<span class="string">&quot;placeId&quot;</span>,place.getPlaceId());</span><br><span class="line">    result.put(<span class="string">&quot;placeName&quot;</span>,place.getPlaceName());</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> BuyListMapper buyListMapper;</span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryBuyListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line">    <span class="comment">//指定分页查询参数</span></span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    List&lt;BuyList&gt; buyLists = buyListMapper.queryBuyListMapper();</span><br><span class="line">    Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;buyLists&quot;</span>,buyLists);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>实现增删改查接口</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BuyListController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> BuyListService buyListService;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">BuyListController</span><span class="params">(BuyListService buyListService)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.buyListService = buyListService;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理采购信息需要自动带入数据的请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/buyAutoInfo/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">buyAutoInfo</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> buyListService.queryAutoDataBuyService(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*保存采购信息*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/saveBuy&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">saveBuy</span><span class="params">(<span class="meta">@RequestBody</span> BuyList buyList)</span>&#123;</span><br><span class="line">        buyList.setBuyTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">        buyList.setIsIn(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        buyList.setFactBuyNum(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> buyListService.save(buyList)? ResponseUtil.success(<span class="string">&quot;保存成功&quot;</span>):ResponseUtil.error(<span class="string">&quot;保存失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理采购单分页查询请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/queryBuyList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryBuyList</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">            ,<span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> buyListService.queryBuyListService(pageNum,pageSize);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理采购单修改请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/updateBuyList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateBuyList</span><span class="params">(<span class="meta">@RequestBody</span> BuyList buyList)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> buyListService.updateById(buyList)? ResponseUtil.success(<span class="string">&quot;修改成功&quot;</span>):ResponseUtil.error(<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/*处理采购单删除请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/deleteBuy/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">deleteBuy</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> buyListService.removeById(id)? ResponseUtil.success(<span class="string">&quot;删除成功&quot;</span>):ResponseUtil.error(<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-20"><a class="markdownIt-Anchor" href="#前端实现-20"></a> 前端实现</h4><p>修改昨天的商品信息页，添加采购功能，相关内容已经在之前的代码里实现了</p><p>添加 BuyListManager.vue</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>采购单列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 采购单列表table --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;buyList&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;buyNum&quot;</span> <span class="attr">label</span>=<span class="string">&quot;预计采购数量&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;factBuyNum&quot;</span> <span class="attr">label</span>=<span class="string">&quot;实际采购数量&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;buyUser&quot;</span> <span class="attr">label</span>=<span class="string">&quot;采购人&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;buyTime&quot;</span> <span class="attr">label</span>=<span class="string">&quot;采购时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200px&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">label</span>=<span class="string">&quot;采购人电话&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;isIn&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isIn == 0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:green&quot;</span>&gt;</span>未入库<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>已入库<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;240&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;scope.row.factBuyNum == 0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;showBuyListDialog(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;scope.row.factBuyNum == 0&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;delBuyList(scope.row.id)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isIn == 0&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>生成入库单&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 采购信息回显对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;buyListDialog&quot;</span> <span class="attr">width</span>=<span class="string">&quot;60%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>商品采购<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;buyForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span> &#123;&#123; buyForm.itemName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库&quot;</span>&gt;</span> &#123;&#123; buyForm.storeName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;供应商&quot;</span>&gt;</span> &#123;&#123; buyForm.supplyName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;产地&quot;</span>&gt;</span> &#123;&#123; buyForm.placeName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;预计采购量&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.buyNum&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;采购人&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.buyUser&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;采购人电话&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.phone&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;实际采购数&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;buyForm.factBuyNum&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateBuyOrder&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明列表集合数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明total</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发送请求，加载采购单列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryBuyList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/queryBuyList?pageNum=&quot;</span> + pageNum)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        buyList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">buyLists</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//加载页面调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryBuyList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//分页按钮的回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryBuyList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//////////////////////////////采购单信息回显///////////////////////////////</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义采购单form表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明商品采购表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">productId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">supplyName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">placeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">buyNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">buyUser</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">factBuyNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明变量表示采购单回显对话框状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> buyListDialog = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明函数打开采购数据回显对话框,row参数表示采购单对象。</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">showBuyListDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">var</span> productId = row.<span class="property">productId</span>;</span></span><br><span class="line"><span class="language-javascript">    buyListDialog.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/buyAutoInfo/&quot;</span> + productId)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得响应数据对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> item = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//将响应数据赋值给buyForm表单</span></span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">productId</span> = item.<span class="property">id</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">itemName</span> = item.<span class="property">itemName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">storeId</span> = item.<span class="property">storeId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">storeName</span> = item.<span class="property">storeName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">supplyId</span> = item.<span class="property">supplyId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">supplyName</span> = item.<span class="property">supplyName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">placeId</span> = item.<span class="property">placeId</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">placeName</span> = item.<span class="property">placeName</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">buyUser</span> = row.<span class="property">buyUser</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">buyNum</span> = row.<span class="property">buyNum</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">factBuyNum</span> = row.<span class="property">factBuyNum</span>;</span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">phone</span> = row.<span class="property">phone</span>;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//表单中封装采购单id</span></span></span><br><span class="line"><span class="language-javascript">        buyForm.<span class="property">buyId</span> = row.<span class="property">buyId</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/*发送采购单更新的ajax请求*/</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">updateBuyOrder</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/updateBuyList&quot;</span>, buyForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          buyListDialog.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryBuyList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生采购单删除的请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">delBuyList</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/deleteBuyList/&quot;</span> + id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryBuyList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">ex</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(ex);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2实现商品入库管理"><a class="markdownIt-Anchor" href="#2实现商品入库管理"></a> 2.实现商品入库管理</h3><ul><li>创建了入库表和相应的后端代码。</li><li>在采购单列表页面添加了“生成入库单”按钮。点击后，调用后端 /buyInStore 接口。</li><li><strong>后端入库逻辑 (saveBuyOrderInStoreService)：</strong><ul><li><strong>更新商品库存：</strong> 根据采购单的实际采购数量，增加对应商品的库存 (这里代码是 goods.getStore()-buyList.getFactBuyNum() 应该是 +，表示入库增加库存，或者需要根据实际业务是“减少未入库库存”等具体逻辑调整)。</li><li><strong>更新采购单状态：</strong> 将采购单的 is_in 状态标记为“已入库”。</li><li><strong>生成入库记录：</strong> 在 t_in_store 表中插入一条新的入库记录。</li></ul></li></ul><h4 id="后端实现-21"><a class="markdownIt-Anchor" href="#后端实现-21"></a> 后端实现</h4><p>添加入库表</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE TABLE</span> `t_in_store`  (</span><br><span class="line">  `ins_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;入库单ID&#x27;</span>,</span><br><span class="line">  `store_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库ID(关联仓库表)&#x27;</span>,</span><br><span class="line">  `product_id` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;商品ID(关联商品表)&#x27;</span>,</span><br><span class="line">  `in_num` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;入库数量&#x27;</span>,</span><br><span class="line">  `create_by` <span class="type">int</span> <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建人ID(关联用户表)&#x27;</span>,</span><br><span class="line">  `create_time` datetime <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>,</span><br><span class="line">  `is_in` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">CHARACTER SET</span> utf8 <span class="keyword">COLLATE</span> utf8_general_ci <span class="keyword">NULL</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;入库状态(0-未入库，1-已入库)&#x27;</span>,</span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`ins_id`) <span class="keyword">USING</span> BTREE</span><br><span class="line">) ENGINE <span class="operator">=</span> InnoDB AUTO_INCREMENT <span class="operator">=</span> <span class="number">50</span> <span class="keyword">CHARACTER SET</span> <span class="operator">=</span> utf8 <span class="keyword">COLLATE</span> <span class="operator">=</span> utf8_general_ci COMMENT <span class="operator">=</span> <span class="string">&#x27;入库单表(记录商品入库信息)&#x27;</span> ROW_FORMAT <span class="operator">=</span> <span class="keyword">Dynamic</span>;</span><br></pre></td></tr></table></figure><p><strong>用插件生成基础代码</strong></p><p><strong>添加 service 接口方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现采购采购信息入库*/</span></span><br><span class="line"><span class="keyword">void</span> <span class="title function_">saveBuyOrderInStoreService</span><span class="params">(BuyList buyList)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> BuyListMapper buyListMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ItemMapper itemMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> InStoreMapper inStoreMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">InStoreServiceImpl</span><span class="params">(BuyListMapper buyListMapper, ItemMapper itemMapper, InStoreMapper inStoreMapper)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.buyListMapper = buyListMapper;</span><br><span class="line">    <span class="built_in">this</span>.itemMapper = itemMapper;</span><br><span class="line">    <span class="built_in">this</span>.inStoreMapper = inStoreMapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveBuyOrderInStoreService</span><span class="params">(BuyList buyList)</span> &#123;</span><br><span class="line">    <span class="comment">//获得商品id</span></span><br><span class="line">    <span class="type">Integer</span> <span class="variable">productId</span> <span class="operator">=</span> buyList.getProductId();</span><br><span class="line">    <span class="comment">//通过商品id获得商品的库存</span></span><br><span class="line">    <span class="type">Item</span> <span class="variable">goods</span> <span class="operator">=</span> itemMapper.selectById(productId);</span><br><span class="line"></span><br><span class="line">    <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Item</span>();</span><br><span class="line">    item.setId(productId);</span><br><span class="line">    item.setStore(goods.getStore()-buyList.getFactBuyNum());</span><br><span class="line">    <span class="comment">//跟新商品库存</span></span><br><span class="line">    itemMapper.updateById(item);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//获得采购单id</span></span><br><span class="line">    Integer buyId=buyList.getBuyId();</span><br><span class="line">    <span class="comment">//更新采购单状态</span></span><br><span class="line">    BuyList bl=<span class="keyword">new</span> <span class="title class_">BuyList</span>();</span><br><span class="line">    bl.setBuyId(buyId);</span><br><span class="line">    bl.setIsIn(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    buyListMapper.updateById(bl);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询记录形成入库单</span></span><br><span class="line">    InStore inStore=<span class="keyword">new</span> <span class="title class_">InStore</span>();</span><br><span class="line">    inStore.setStoreId(buyList.getStoreId());</span><br><span class="line">    inStore.setProductId(buyList.getProductId());</span><br><span class="line">    inStore.setInNum(buyList.getFactBuyNum());</span><br><span class="line">    inStore.setCreateBy(<span class="number">1009</span>);</span><br><span class="line">    inStore.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    inStore.setIsIn(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">    inStoreMapper.insert(inStore);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>添加 Controller</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">InStoreController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> InStoreService inStoreService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理采购单入库请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/buyInStore&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">buyInStore</span><span class="params">(<span class="meta">@RequestBody</span> BuyList buyList)</span>&#123;</span><br><span class="line">        inStoreService.saveBuyOrderInStoreService(buyList);</span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;入库成功&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-21"><a class="markdownIt-Anchor" href="#前端实现-21"></a> 前端实现</h4><p>采购管理页添加入库方法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//定义入库按钮函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">doInStore</span>(<span class="params">row</span>) &#123;</span><br><span class="line">  axios</span><br><span class="line">    .<span class="title function_">post</span>(<span class="string">&quot;http://localhost:8080/buyInStore&quot;</span>, row)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        <span class="comment">//刷新列表</span></span><br><span class="line">        <span class="title function_">queryBuyList</span>(<span class="number">1</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">ex</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(ex);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改按钮，绑定事件方法</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">  <span class="attr">link</span></span></span><br><span class="line"><span class="tag">  <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isIn == 0&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">click</span>=<span class="string">&quot;doInStore(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>生成入库单&lt;/el-button</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><h3 id="3实现表的导入导出"><a class="markdownIt-Anchor" href="#3实现表的导入导出"></a> 3.实现表的导入导出</h3><p>外部教程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/wyj-java/p/16747200.html">java 导出 excel(一)：单 sheet</a></p><h4 id="后端实现-22"><a class="markdownIt-Anchor" href="#后端实现-22"></a> 后端实现</h4><ul><li>添加了 Apache POI 依赖 (poi-ooxml)。</li><li>在 BuyListServiceImpl 中实现了 exportExcelService 方法：<ul><li>创建 XSSFWorkbook (Excel 文件对象) 和 XSSFSheet (工作表)。</li><li>创建表头行并设置样式 (合并单元格、字体、对齐方式等)。</li><li>查询数据库获取采购单列表数据。</li><li>遍历数据，为每条记录创建数据行，并将数据填充到单元格中。特别注意了日期格式的处理。</li></ul></li><li>在 BuyListController 中创建了 /exportExcel 接口：<ul><li>调用 Service 获取 XSSFWorkbook 对象。</li><li>将 workbook 写入 ByteArrayOutputStream。</li><li>设置 HTTP 响应头 (HttpHeaders)，包括 Content-Type (application/octet-stream 表示二进制流) 和 Content-Disposition (attachment;filename=… 指定下载文件名，并进行了 URL 编码处理中文名)。</li><li>返回 ResponseEntity&lt;byte[]&gt;，将 Excel 文件内容作为字节流响应给客户端。</li></ul></li></ul><p><strong>Maven 添加依赖</strong></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--导出excle poi依赖--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.poi<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>poi-ooxml<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>application.properties 添加 pagehelper 配置</strong></p><p>这个配置防止 pageSizeZero 不可以为零导致返回出错的情况</p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 PageHelper 的配置 (如果需要，特别是 pageSizeZero)</span></span><br><span class="line"><span class="attr">pagehelper.helper-dialect</span>=<span class="string">mysql</span></span><br><span class="line"><span class="attr">pagehelper.reasonable</span>=<span class="string">false</span></span><br><span class="line"><span class="attr">pagehelper.support-methods-arguments</span>=<span class="string">true</span></span><br><span class="line"><span class="attr">pagehelper.params</span>=<span class="string">count=countSql</span></span><br><span class="line"><span class="attr">pagehelper.page-size-zero</span>=<span class="string">true</span></span><br></pre></td></tr></table></figure><p><strong>BuyListService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现采购单数据导出到excel*/</span></span><br><span class="line">XSSFWorkbook <span class="title function_">exportExcelService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>实现接口方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//XSSFWorkbook 返回的是一个XSSFWorkbook对象，表示一个excel文件</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> XSSFWorkbook <span class="title function_">exportExcelService</span><span class="params">()</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建XSSFWorkbook对象，形成一个excel文件</span></span><br><span class="line">    <span class="type">XSSFWorkbook</span> <span class="variable">xwb</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFWorkbook</span>();</span><br><span class="line">    <span class="comment">//在excel文件中添加sheet表</span></span><br><span class="line">    <span class="type">XSSFSheet</span> <span class="variable">sheet</span> <span class="operator">=</span> xwb.createSheet(<span class="string">&quot;采购单信息&quot;</span>);</span><br><span class="line">    <span class="comment">//sheet添加行,当一行</span></span><br><span class="line">    <span class="type">XSSFRow</span> <span class="variable">row0</span> <span class="operator">=</span> sheet.createRow(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//给第一行添加列</span></span><br><span class="line">    <span class="type">XSSFCell</span> <span class="variable">row0cell0</span> <span class="operator">=</span> row0.createCell(<span class="number">0</span>);</span><br><span class="line">    row0cell0.setCellValue(<span class="string">&quot;采购单列表&quot;</span>);</span><br><span class="line">    <span class="comment">//设置单元格内容居中</span></span><br><span class="line">    <span class="type">XSSFCellStyle</span> <span class="variable">style</span> <span class="operator">=</span> xwb.createCellStyle();</span><br><span class="line">    style.setAlignment(HorizontalAlignment.CENTER);</span><br><span class="line">    style.setFillBackgroundColor(<span class="keyword">new</span> <span class="title class_">XSSFColor</span>(</span><br><span class="line">            <span class="keyword">new</span> <span class="title class_">java</span>.awt.Color(<span class="number">255</span>, <span class="number">0</span>, <span class="number">0</span>), <span class="literal">null</span>));</span><br><span class="line">    <span class="type">XSSFFont</span> <span class="variable">font</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">XSSFFont</span>();</span><br><span class="line">    font.setFontHeight(<span class="number">30</span>);</span><br><span class="line">    style.setFont(font);</span><br><span class="line">    row0cell0.setCellStyle(style);</span><br><span class="line">    <span class="comment">//合并第一行，扩列合并列,从第一行合并8列</span></span><br><span class="line">    sheet.addMergedRegion(<span class="keyword">new</span> <span class="title class_">CellRangeAddress</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">8</span>));</span><br><span class="line">    <span class="comment">////////////////////////////////设置表头///////////////////////////////</span></span><br><span class="line">    <span class="comment">//创建第二行表头</span></span><br><span class="line">    <span class="type">XSSFRow</span> <span class="variable">row1</span> <span class="operator">=</span> sheet.createRow(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//创建第一行，8个列，并填充数据</span></span><br><span class="line">    row1.createCell(<span class="number">0</span>).setCellValue(<span class="string">&quot;仓库名称&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">1</span>).setCellValue(<span class="string">&quot;商品名称&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">2</span>).setCellValue(<span class="string">&quot;预计采购数量&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">3</span>).setCellValue(<span class="string">&quot;实际采购数量&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">4</span>).setCellValue(<span class="string">&quot;采购人&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">5</span>).setCellValue(<span class="string">&quot;采购时间&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">6</span>).setCellValue(<span class="string">&quot;采购人电话&quot;</span>);</span><br><span class="line">    row1.createCell(<span class="number">7</span>).setCellValue(<span class="string">&quot;状态&quot;</span>);</span><br><span class="line">    <span class="comment">//查询数据库，获得需要填充的数据</span></span><br><span class="line">    <span class="comment">//指定分页查询参数</span></span><br><span class="line">    PageHelper.startPage(<span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    List&lt;BuyList&gt; buyLists = buyListMapper.queryBuyListMapper();</span><br><span class="line">    <span class="comment">//debug看数据</span></span><br><span class="line">    System.out.println(buyLists);</span><br><span class="line">    <span class="type">int</span> <span class="variable">index</span> <span class="operator">=</span> <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">for</span> (BuyList buy : buyLists) &#123;</span><br><span class="line">        <span class="comment">//每循环遍历一次，创建一行</span></span><br><span class="line">        <span class="type">XSSFRow</span> <span class="variable">rown</span> <span class="operator">=</span> sheet.createRow(index);</span><br><span class="line">        rown.createCell(<span class="number">0</span>).setCellValue(buy.getStoreName());</span><br><span class="line">        rown.createCell(<span class="number">1</span>).setCellValue(buy.getItemName());</span><br><span class="line">        rown.createCell(<span class="number">2</span>).setCellValue(buy.getBuyNum());</span><br><span class="line">        rown.createCell(<span class="number">3</span>).setCellValue(buy.getFactBuyNum());</span><br><span class="line">        rown.createCell(<span class="number">4</span>).setCellValue(buy.getBuyUser());</span><br><span class="line">        <span class="type">XSSFCell</span> <span class="variable">cell</span> <span class="operator">=</span> rown.createCell(<span class="number">5</span>);</span><br><span class="line">        <span class="comment">// 创建一个日期样式</span></span><br><span class="line">        <span class="type">CellStyle</span> <span class="variable">dateStyle</span> <span class="operator">=</span> xwb.createCellStyle();</span><br><span class="line">        <span class="type">short</span> <span class="variable">dateFormat</span> <span class="operator">=</span> xwb.getCreationHelper().createDataFormat()</span><br><span class="line">                .getFormat(<span class="string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span>); <span class="comment">// 设置日期格式</span></span><br><span class="line">        dateStyle.setDataFormat(dateFormat);</span><br><span class="line">        cell.setCellStyle(dateStyle);</span><br><span class="line">        cell.setCellValue(buy.getBuyTime());</span><br><span class="line">        rown.createCell(<span class="number">6</span>).setCellValue(buy.getPhone());</span><br><span class="line">        <span class="comment">//判断采购单准提</span></span><br><span class="line">        <span class="comment">// 判断采购单准提状态（安全处理 null）</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">isIn</span> <span class="operator">=</span> buy.getIsIn();</span><br><span class="line">        <span class="type">String</span> <span class="variable">result</span> <span class="operator">=</span> <span class="string">&quot;0&quot;</span>.equals(isIn) ? <span class="string">&quot;未入库&quot;</span> : <span class="string">&quot;已入库&quot;</span>; <span class="comment">// 或使用显式判空</span></span><br><span class="line">        rown.createCell(<span class="number">7</span>).setCellValue(result);</span><br><span class="line">        index++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> xwb;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>添加对于 controller 接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理数据导出excel请求，下载excel文件*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/exportExcel&quot;)</span></span><br><span class="line"><span class="keyword">public</span> ResponseEntity <span class="title function_">exportExcel</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">XSSFWorkbook</span> <span class="variable">workbook</span> <span class="operator">=</span> buyListService.exportExcelService();</span><br><span class="line">    <span class="comment">//将workbook，excel文件对象，封装到字节数组</span></span><br><span class="line">    <span class="type">ByteArrayOutputStream</span> <span class="variable">baos</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ByteArrayOutputStream</span>();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        workbook.write(baos);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//获得字节数组中封装的文件,响应体</span></span><br><span class="line">    <span class="type">byte</span>[] bytes = baos.toByteArray();</span><br><span class="line">    <span class="comment">//创建HttpHeaders对象封装响应头</span></span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    headers.setContentType(MediaType.APPLICATION_OCTET_STREAM); <span class="comment">//响应体的类型</span></span><br><span class="line">    <span class="comment">//设置下载的文件的名字</span></span><br><span class="line">    <span class="comment">//headers.setContentDisposition(&quot;attachment;filename=采购单列表&quot;);</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">name</span> <span class="operator">=</span> <span class="string">&quot;采购单列表.xlsx&quot;</span>;</span><br><span class="line">    name = URLEncoder.encode(name, StandardCharsets.UTF_8);</span><br><span class="line">    System.out.println(<span class="string">&quot;name=&quot;</span> + name);</span><br><span class="line">    headers.add(HttpHeaders.CONTENT_DISPOSITION, <span class="string">&quot;attachment;filename=&quot;</span> + name);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//创建对象，封装响应体，响应头，状态吗</span></span><br><span class="line">    <span class="keyword">return</span> (ResponseEntity&lt;<span class="type">byte</span>[]&gt;) <span class="keyword">new</span> <span class="title class_">ResponseEntity</span>(bytes, headers, HttpStatus.CREATED);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-22"><a class="markdownIt-Anchor" href="#前端实现-22"></a> 前端实现</h4><ul><li>添加一个“导出数据”按钮。</li><li>点击按钮时，通过 location.href=“<a target="_blank" rel="noopener" href="http://localhost:8081/exportExcel">http://localhost:8081/exportExcel</a>” 直接请求后端导出接口，浏览器会自动触发表单下载。</li></ul><p><strong>添加导出按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;exportData&quot;</span>&gt;</span>导出数据<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>实现绑定的事件</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//发送请求进行数据导出</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">exportData</span>(<span class="params"></span>) &#123;</span><br><span class="line">  location.<span class="property">href</span> = <span class="string">&quot;http://localhost:8081/exportExcel&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="day16"><a class="markdownIt-Anchor" href="#day16"></a> Day16</h2><h3 id="1实现入库单列表增删改查"><a class="markdownIt-Anchor" href="#1实现入库单列表增删改查"></a> 1.实现入库单列表增删改查</h3><h4 id="后端实现-23"><a class="markdownIt-Anchor" href="#后端实现-23"></a> 后端实现</h4><p><strong>InStore 实体类添加属性</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Serial</span></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">long</span> <span class="variable">serialVersionUID</span> <span class="operator">=</span> <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String storeName;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String itemName;</span><br></pre></td></tr></table></figure><p><strong>InStoreMapper 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*完成入库单列表分页查询*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;InStore&gt; <span class="title function_">queryInStoreListMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>实现 mapper 接口</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  <span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--实现入库单列表查询--&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryInStoreListMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.InStore&quot;<span class="operator">&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">select</span> inst.<span class="operator">*</span>,store.store_name,item.item_name</span><br><span class="line">    <span class="keyword">from</span> t_in_store inst</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_item item  <span class="keyword">on</span> item.id<span class="operator">=</span>inst.product_id</span><br><span class="line">    <span class="keyword">inner</span> <span class="keyword">join</span> t_store store <span class="keyword">on</span> store.store_id<span class="operator">=</span>inst.store_id</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>对应 service 添加方法接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现入库单列表分页查询*/</span></span><br><span class="line">   <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryInStoreListService</span><span class="params">(Integer pageNum, Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p>实现接口</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  <span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryInStoreListService</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//指定分页查询参数</span></span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line">    List&lt;InStore&gt; inStores = inStoreMapper.queryInStoreListMapper();</span><br><span class="line">    Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;inStores&quot;</span>,inStores);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>InStoreController 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"> <span class="comment">/*处理入库单列表分页查询请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/queryInList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryInStoreList</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">        ,<span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> inStoreService.queryInStoreListService(pageNum,pageSize);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*处理入库单删除请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/deleteInList/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteInList</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> inStoreService.removeById(id) ? R.success(<span class="string">&quot;删除成功&quot;</span>) : R.error(<span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">/*处理入库单修改请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/updateInList&quot;)</span></span><br><span class="line"> <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateInList</span><span class="params">(<span class="meta">@RequestBody</span> InStore inStore)</span> &#123;</span><br><span class="line">     <span class="keyword">return</span> inStoreService.updateById(inStore) ? R.success(<span class="string">&quot;修改成功&quot;</span>) : R.error(<span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"> <span class="comment">/*处理入库单确认请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/updateInStore/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateInStore</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span>&#123;</span><br><span class="line">    InStore inStore=<span class="keyword">new</span> <span class="title class_">InStore</span>();</span><br><span class="line">        inStore.setInsId(id);</span><br><span class="line">        inStore.setIsIn(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> inStoreService.updateById(inStore)? R.success(<span class="string">&quot;确认成功&quot;</span>): R.error(<span class="string">&quot;确认失败&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-23"><a class="markdownIt-Anchor" href="#前端实现-23"></a> 前端实现</h4><p>创建 InStoreList.vue 组件</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>入库单列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 入库单列表table --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;inStoreList&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;inNum&quot;</span> <span class="attr">label</span>=<span class="string">&quot;入库数量&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;createBy&quot;</span> <span class="attr">label</span>=<span class="string">&quot;创建人ID&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;createTime&quot;</span> <span class="attr">label</span>=<span class="string">&quot;创建时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200px&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;isIn&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isIn == 0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:green&quot;</span>&gt;</span>未入库<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>已入库<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;showInStoreDialog(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;delInStore(scope.row.insId)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isIn == 1&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;confirmIsIn(scope.row.insId)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>确认入库&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;pageSize&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 入库信息回显对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;inStoreDialog&quot;</span> <span class="attr">width</span>=<span class="string">&quot;60%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>入库单信息<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;inStoreForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span> &#123;&#123; inStoreForm.itemName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库&quot;</span>&gt;</span> &#123;&#123; inStoreForm.storeName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;入库数量&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;inStoreForm.inNum&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;创建人ID&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;inStoreForm.createBy&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;创建时间&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-model</span>=<span class="string">&quot;inStoreForm.createTime&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">disabled</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;inStoreForm.isIn&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;未入库&quot;</span> <span class="attr">value</span>=<span class="string">&quot;0&quot;</span> /&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-option</span> <span class="attr">label</span>=<span class="string">&quot;已入库&quot;</span> <span class="attr">value</span>=<span class="string">&quot;1&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;updateInStore&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click</span>=<span class="string">&quot;inStoreDialog = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">InStoreApi</span> &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/InStore&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 入库单列表数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> inStoreList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> pageSize = <span class="number">10</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 查询入库单列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryInStoreList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">InStoreApi</span>.<span class="title function_">queryInList</span>(pageNum, pageSize)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 正确映射后端 inStores 字段</span></span></span><br><span class="line"><span class="language-javascript">        inStoreList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">inStores</span> || [];</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;获取入库单列表失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;获取入库单列表失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryInStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerPageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryInStoreList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 入库单表单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> inStoreForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">insId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">productId</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">inNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">createBy</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">createTime</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">isIn</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> inStoreDialog = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 打开入库单编辑对话框</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">showInStoreDialog</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(inStoreForm, row);</span></span><br><span class="line"><span class="language-javascript">    inStoreDialog.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 更新入库单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">updateInStore</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">InStoreApi</span>.<span class="title function_">updateInList</span>(inStoreForm)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          inStoreDialog.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryInStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;更新入库单失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;更新入库单失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 删除入库单</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">delInStore</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">InStoreApi</span>.<span class="title function_">deleteInList</span>(id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryInStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;删除入库单失败:&quot;</span>, error);</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>.<span class="title function_">error</span>(<span class="string">&quot;删除入库单失败&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生入库单确认请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">confirmIsIn</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">InStoreApi</span>.<span class="title function_">updateInStore</span>(id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryInStoreList</span>(<span class="number">1</span>); <span class="comment">//刷新</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>在菜单表里添加菜单</strong></p><p><strong>在主页代码中注册页面</strong></p><p>之前写过很多次，这里不重复</p><h3 id="2实现商品信息页的出库功能"><a class="markdownIt-Anchor" href="#2实现商品信息页的出库功能"></a> 2.实现商品信息页的出库功能</h3><h4 id="后端实现-24"><a class="markdownIt-Anchor" href="#后端实现-24"></a> 后端实现</h4><p><strong>创建 t_out_store 表</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建出库单表</span></span><br><span class="line"><span class="keyword">CREATE TABLE</span> `t_out_store` (</span><br><span class="line">  `outs_id` <span class="type">int</span> <span class="keyword">NOT NULL</span> AUTO_INCREMENT COMMENT <span class="string">&#x27;出库单ID，主键，自增&#x27;</span>, <span class="comment">-- 出库单唯一标识</span></span><br><span class="line">  `product_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;产品ID&#x27;</span>, <span class="comment">-- 关联的产品ID</span></span><br><span class="line">  `store_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;仓库ID&#x27;</span>, <span class="comment">-- 关联的仓库ID</span></span><br><span class="line">  `tally_id` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;理货ID&#x27;</span>, <span class="comment">-- 关联的理货记录ID</span></span><br><span class="line">  `out_price` <span class="type">decimal</span>(<span class="number">8</span>,<span class="number">2</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;出库单价&#x27;</span>, <span class="comment">-- 出库产品的单价，保留两位小数</span></span><br><span class="line">  `out_num` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;出库数量&#x27;</span>, <span class="comment">-- 出库的产品数量</span></span><br><span class="line">  `create_by` <span class="type">int</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建人ID&#x27;</span>, <span class="comment">-- 创建该出库单的用户ID</span></span><br><span class="line">  `create_time` datetime <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;创建时间&#x27;</span>, <span class="comment">-- 出库单创建时间</span></span><br><span class="line">  `is_out` <span class="type">char</span>(<span class="number">1</span>) <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span> COMMENT <span class="string">&#x27;是否出库：0 否，1 是&#x27;</span>, <span class="comment">-- 出库状态标记</span></span><br><span class="line">  <span class="keyword">PRIMARY KEY</span> (`outs_id`) <span class="comment">-- 设置outs_id为主键</span></span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB AUTO_INCREMENT<span class="operator">=</span><span class="number">15</span> <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb3 COMMENT<span class="operator">=</span><span class="string">&#x27;出库单&#x27;</span>;</span><br></pre></td></tr></table></figure><p><strong>在 idea 用 mybatiesx 生成代码</strong></p><p><strong>OutStoreService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现商品出库*/</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">saveOutStoreService</span><span class="params">(OutStore outStore)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> ItemMapper itemMapper;</span><br><span class="line"><span class="keyword">private</span> <span class="keyword">final</span> OutStoreMapper outStoreMapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="title function_">OutStoreServiceImpl</span><span class="params">(ItemMapper itemMapper, OutStoreMapper outStoreMapper)</span> &#123;</span><br><span class="line">    <span class="built_in">this</span>.itemMapper = itemMapper;</span><br><span class="line">    <span class="built_in">this</span>.outStoreMapper = outStoreMapper;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">saveOutStoreService</span><span class="params">(OutStore outStore)</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据商品查询对应商品的库存</span></span><br><span class="line">    <span class="type">Item</span> <span class="variable">product</span> <span class="operator">=</span> itemMapper.selectById(outStore.getProductId());</span><br><span class="line"></span><br><span class="line">    <span class="type">Item</span> <span class="variable">item</span> <span class="operator">=</span><span class="keyword">new</span> <span class="title class_">Item</span>();</span><br><span class="line">    item.setId(outStore.getProductId());</span><br><span class="line">    item.setStore(product.getStore()-outStore.getOutNum());</span><br><span class="line">    <span class="comment">//实现商品信息的更新</span></span><br><span class="line">    itemMapper.updateById(item);</span><br><span class="line"></span><br><span class="line">    outStore.setIsOut(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">    outStore.setCreateTime(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    outStore.setCreateBy(<span class="number">101010</span>);</span><br><span class="line">    outStore.setOutPrice(BigDecimal.valueOf(product.getSellPrice()));</span><br><span class="line">    outStore.setStoreId(product.getStoreId());</span><br><span class="line">    outStore.setProductId(product.getId());</span><br><span class="line"></span><br><span class="line">    <span class="comment">//实现出库单信息的保存</span></span><br><span class="line">    outStoreMapper.insert(outStore);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>创建 OutStoreController</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OutStoreController</span> &#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OutStoreService outStoreService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/*处理商品信息出库请求*/</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;/doItemOutStore&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">doItemOutStore</span><span class="params">(<span class="meta">@RequestBody</span> OutStore outStore)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (outStoreService.saveOutStoreService(outStore))&#123;</span><br><span class="line">            <span class="keyword">return</span> R.success(<span class="string">&quot;商品出库成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;商品出库失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     <span class="comment">/*处理出库单分页查询请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/outStoreList&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">outStoreList</span><span class="params">(</span></span><br><span class="line"><span class="params">            <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">            ,<span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> outStoreService.queryOutStoreListMapper(pageNum,pageSize);</span><br><span class="line">    &#125;</span><br><span class="line">        <span class="comment">/*处理出库单确认请求*/</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/updateOutStore&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateOutStore</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">        OutStore os=<span class="keyword">new</span> <span class="title class_">OutStore</span>();</span><br><span class="line">        os.setOutsId(id);</span><br><span class="line">        os.setIsOut(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(outStoreService.updateById(os))&#123;</span><br><span class="line">            <span class="keyword">return</span> R.success(<span class="string">&quot;确认成功&quot;</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> R.error(<span class="string">&quot;确认失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-24"><a class="markdownIt-Anchor" href="#前端实现-24"></a> 前端实现</h4><p>在商品信息页添加按钮和对应事件</p><p><strong>添加出库按钮</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-button</span> <span class="attr">link</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openOutDialog(row)&quot;</span></span></span><br><span class="line"><span class="tag">  &gt;</span>出库&lt;/el-button</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure><p><strong>添加出库对话框</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 出库对话框组件 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;itemOutDialog&quot;</span> <span class="attr">width</span>=<span class="string">&quot;60%&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>商品采购<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;outForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span>&gt;</span> &#123;&#123; outForm.itemName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库&quot;</span>&gt;</span> &#123;&#123; outForm.storeName &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;商品库存&quot;</span>&gt;</span> &#123;&#123; outForm.store &#125;&#125; <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;出库数量&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;outForm.outNum&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;saveOutOrder&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>添加相关变量和函数实现</strong></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//声明出库对话框状态</span></span><br><span class="line"><span class="keyword">const</span> itemOutDialog = <span class="title function_">ref</span>(<span class="literal">false</span>);</span><br><span class="line"><span class="comment">//声明商品出库form表单</span></span><br><span class="line"><span class="keyword">const</span> outForm = <span class="title function_">reactive</span>(&#123;</span><br><span class="line">  <span class="attr">itemName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span><br><span class="line">  <span class="attr">store</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">outNum</span>: <span class="number">0</span>,</span><br><span class="line">  <span class="attr">productId</span>: <span class="literal">undefined</span>,</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">//定义函数打开商品出库对话框</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">openOutDialog</span>(<span class="params">row</span>) &#123;</span><br><span class="line">  itemOutDialog.<span class="property">value</span> = <span class="literal">true</span>;</span><br><span class="line">  outForm.<span class="property">itemName</span> = row.<span class="property">itemName</span>;</span><br><span class="line">  outForm.<span class="property">store</span> = row.<span class="property">store</span>;</span><br><span class="line">  outForm.<span class="property">storeName</span> = row.<span class="property">storeName</span>;</span><br><span class="line">  outForm.<span class="property">productId</span> = row.<span class="property">id</span>;</span><br><span class="line">  outForm.<span class="property">outNum</span> = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//定义函数发生商品出库请求</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">saveOutOrder</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!outForm.<span class="property">outNum</span> || outForm.<span class="property">outNum</span> &lt;= <span class="number">0</span>) &#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;请输入正确的出库数量&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (outForm.<span class="property">outNum</span> &gt; outForm.<span class="property">store</span>) &#123;</span><br><span class="line">    <span class="title class_">ElMessage</span>.<span class="title function_">warning</span>(<span class="string">&quot;出库数量不能大于库存&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  itemApi</span><br><span class="line">    .<span class="title function_">doItemOutStore</span>(outForm)</span><br><span class="line">    .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span><br><span class="line">        itemOutDialog.<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">        <span class="title function_">loadItemList</span>(<span class="number">1</span>); <span class="comment">// 出库成功后刷新商品列表</span></span><br><span class="line">      &#125;</span><br><span class="line">      <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">    .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3实现出库单分页查询和出库确认"><a class="markdownIt-Anchor" href="#3实现出库单分页查询和出库确认"></a> 3.实现出库单分页查询和出库确认</h3><h4 id="后端实现-25"><a class="markdownIt-Anchor" href="#后端实现-25"></a> 后端实现</h4><p><strong>OutStore 实体类添加属性</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String itemName;</span><br><span class="line"></span><br><span class="line"><span class="meta">@TableField(exist = false)</span></span><br><span class="line"><span class="keyword">private</span> String storeName;</span><br></pre></td></tr></table></figure><p><strong>OutStoreMapper 接口定义方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现入库单信息分页查询*/</span></span><br><span class="line">List&lt;OutStore&gt; <span class="title function_">queryOutStorListeMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>实现接口方法</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;queryOutStorListeMapper&quot; resultType<span class="operator">=</span>&quot;com.example.demo.pojo.OutStore&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> ose.<span class="operator">*</span>, item.item_name, store.store_name</span><br><span class="line">    <span class="keyword">from</span> t_out_store ose</span><br><span class="line">             <span class="keyword">inner</span> <span class="keyword">join</span> t_item item <span class="keyword">on</span> ose.product_id <span class="operator">=</span> item.id</span><br><span class="line">             <span class="keyword">inner</span> <span class="keyword">join</span> t_store store <span class="keyword">on</span> ose.store_id <span class="operator">=</span> store.store_id</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>OutStoreService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/*实现入库单列表分页查询*/</span></span><br><span class="line">Map&lt;String,Object&gt; <span class="title function_">queryOutStoreListMapper</span><span class="params">(Integer pageNum,Integer pageSize)</span>;</span><br></pre></td></tr></table></figure><p><strong>实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryOutStoreListMapper</span><span class="params">(Integer pageNum, Integer pageSize)</span> &#123;</span><br><span class="line">    <span class="comment">//创建Map</span></span><br><span class="line">    Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    Page&lt;Object&gt; page = PageHelper.startPage(pageNum, pageSize);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//查询数据库</span></span><br><span class="line">    List&lt;OutStore&gt; outStoreList = outStoreMapper.queryOutStorListeMapper();</span><br><span class="line"></span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>,page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;outStoreList&quot;</span>,outStoreList);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>OutStoreController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理出库单分页查询请求*/</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/outStoreList&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">outStoreList</span><span class="params">(</span></span><br><span class="line"><span class="params">           <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">           ,<span class="meta">@RequestParam(defaultValue = &quot;3&quot;)</span> Integer pageSize)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> outStoreService.queryOutStoreListMapper(pageNum,pageSize);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/*处理出库单确认请求*/</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/updateOutStore&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">updateOutStore</span><span class="params">(Integer id)</span>&#123;</span><br><span class="line">       Map&lt;String,Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">       result.put(<span class="string">&quot;code&quot;</span>,<span class="number">400</span>);</span><br><span class="line">       result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;操作失败......&quot;</span>);</span><br><span class="line">       <span class="keyword">try</span>&#123;</span><br><span class="line">           OutStore os=<span class="keyword">new</span> <span class="title class_">OutStore</span>();</span><br><span class="line">           os.setOutsId(id);</span><br><span class="line">           os.setIsOut(<span class="string">&quot;1&quot;</span>);</span><br><span class="line">           outStoreService.updateById(os);</span><br><span class="line">           result.put(<span class="string">&quot;code&quot;</span>,<span class="number">200</span>);</span><br><span class="line">           result.put(<span class="string">&quot;msg&quot;</span>,<span class="string">&quot;出库单确认成功.......&quot;</span>);</span><br><span class="line">       &#125;<span class="keyword">catch</span> (Exception ex)&#123;</span><br><span class="line">           ex.printStackTrace();</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> result;</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="前端实现-25"><a class="markdownIt-Anchor" href="#前端实现-25"></a> 前端实现</h4><p><strong>菜单表添加数据</strong></p><p>实现前端页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>出库单列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- table --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;outStoreList&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;itemName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;商品名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;outNum&quot;</span> <span class="attr">label</span>=<span class="string">&quot;出库数量&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;createBy&quot;</span> <span class="attr">label</span>=<span class="string">&quot;出库人&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;createTime&quot;</span> <span class="attr">label</span>=<span class="string">&quot;采购时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;200px&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;isOut&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isOut == 0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color:green&quot;</span>&gt;</span>未确认<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-else</span> <span class="attr">style</span>=<span class="string">&quot;color:red&quot;</span>&gt;</span>已确认<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;240&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-if</span>=<span class="string">&quot;scope.row.isOut == 0&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;confirmIsOut(scope.row.outsId)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>确认出库&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">small</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerOutStorePageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明出库单集合</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> outStoreList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义汉法发生分页查询的请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryItmOutServiceList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/outStoreList?pageNum=&quot;</span> + pageNum)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        outStoreList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">outStoreList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//加载调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryItmOutServiceList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义分页按钮的回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerOutStorePageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryItmOutServiceList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生入库单确认请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">confirmIsOut</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8080/updateOutStore?id=&quot;</span> + id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryItmOutServiceList</span>(<span class="number">1</span>); <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4实现仓库数据增删改查"><a class="markdownIt-Anchor" href="#4实现仓库数据增删改查"></a> 4.实现仓库数据增删改查</h3><h4 id="后端实现-26"><a class="markdownIt-Anchor" href="#后端实现-26"></a> <strong>后端实现</strong></h4><p><strong>StoreController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理仓库数据分页查询请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/storePageList&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryStoreList</span><span class="params">(</span></span><br><span class="line"><span class="params">        <span class="meta">@RequestParam(defaultValue = &quot;1&quot;)</span> Integer pageNum</span></span><br><span class="line"><span class="params">        , <span class="meta">@RequestParam(defaultValue = &quot;10&quot;)</span> Integer pageSize)</span> &#123;</span><br><span class="line">    Page&lt;Store&gt; page = <span class="keyword">new</span> <span class="title class_">Page</span>&lt;&gt;(pageNum, pageSize);</span><br><span class="line">    List&lt;Store&gt; storeList = storeService.list(page);</span><br><span class="line"></span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;total&quot;</span>, page.getTotal());</span><br><span class="line">    result.put(<span class="string">&quot;storeList&quot;</span>, storeList);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*添加方法处理仓库信息的添加请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/saveStore&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveStore</span><span class="params">(<span class="meta">@RequestBody</span> Store store)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> storeService.save(store) ? R.success(<span class="string">&quot;保存仓库信息成功&quot;</span>) : R.error(<span class="string">&quot;保存仓库信息失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*处理仓库信息的修改请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/updateStore&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateStore</span><span class="params">(<span class="meta">@RequestBody</span> Store store)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> storeService.updateById(store) ? R.success(<span class="string">&quot;修改仓库信息成功&quot;</span>) : R.error(<span class="string">&quot;修改仓库信息失败&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*处理仓库信息的删除请求*/</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/deleteStore&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteStore</span><span class="params">(<span class="meta">@RequestBody</span> Store store)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> storeService.removeById(store) ? R.success(<span class="string">&quot;删除仓库信息成功&quot;</span>) : R.error(<span class="string">&quot;删除仓库信息失败&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-26"><a class="markdownIt-Anchor" href="#前端实现-26"></a> <strong>前端实现</strong></h4><p>创建页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>仓库列表<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">&quot;text-align: left&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;openStoreDialog&quot;</span>&gt;</span>添加仓库<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- table组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;storeList&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeName&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库名称&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeNum&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库编号&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;storeAddress&quot;</span> <span class="attr">label</span>=<span class="string">&quot;仓库地址&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;concat&quot;</span> <span class="attr">label</span>=<span class="string">&quot;联系人&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;phone&quot;</span> <span class="attr">label</span>=<span class="string">&quot;联系电话&quot;</span> /&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">fixed</span>=<span class="string">&quot;right&quot;</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;240&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">template</span> #<span class="attr">default</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;openEditStore(scope.row)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>修改&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span></span></span><br><span class="line"><span class="tag">          <span class="attr">link</span></span></span><br><span class="line"><span class="tag">          <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">          @<span class="attr">click</span>=<span class="string">&quot;deleteStore(scope.row.storeId)&quot;</span></span></span><br><span class="line"><span class="tag">          &gt;</span>删除&lt;/el-button</span><br><span class="line">        &gt;</span><br><span class="line">      <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 分页组件 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">    <span class="attr">background</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:page-size</span>=<span class="string">&quot;3&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">:pager-count</span>=<span class="string">&quot;5&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">    <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">    @<span class="attr">current-change</span>=<span class="string">&quot;handlerStorePageChange&quot;</span></span></span><br><span class="line"><span class="tag">  /&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!--  添加仓库信息对话框 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">v-model</span>=<span class="string">&quot;dialogStoreVisible&quot;</span> <span class="attr">width</span>=<span class="string">&quot;80%&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h2</span>&gt;</span>&#123;&#123; operationType === &#x27;add&#x27; ? &#x27;添加仓库信息&#x27; : &#x27;修改仓库信息&#x27; &#125;&#125;<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 对话框中添加form --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;storeForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库名称&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;storeForm.storeName&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库编号&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;storeForm.storeNum&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;仓库地址&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;storeForm.storeAddress&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系人&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;storeForm.concat&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;联系电话&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;storeForm.phone&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 80%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line"></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;subStoreForm&quot;</span>&gt;</span>保存<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; <span class="title class_">ElMessage</span> &#125; <span class="keyword">from</span> <span class="string">&quot;element-plus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; storeApi &#125; <span class="keyword">from</span> <span class="string">&quot;@/api/store&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明列表集合数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> storeList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明total总记录数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> total = <span class="title function_">ref</span>(<span class="number">0</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生请求，加载列表</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">queryStoreList</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    storeApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">queryStoreList</span>(pageNum)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        storeList.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">storeList</span>;</span></span><br><span class="line"><span class="language-javascript">        total.<span class="property">value</span> = response.<span class="property">data</span>.<span class="property">total</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(err);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//加载调用</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义分页按钮回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handlerStorePageChange</span>(<span class="params">pageNum</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">queryStoreList</span>(pageNum);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/////////////////////////添加仓库信息//////////////////////////////////</span></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明对话框状态</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> dialogStoreVisible = <span class="title function_">ref</span>(<span class="literal">false</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 当前操作类型：add 或 edit</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> operationType = <span class="title function_">ref</span>(<span class="string">&quot;add&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> storeForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeId</span>: <span class="string">&quot;&quot;</span>, <span class="comment">// 添加 storeId 字段</span></span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeName</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeNum</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">storeAddress</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">concat</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">phone</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">// 重置表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">resetForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">storeId</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">storeName</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">storeNum</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">storeAddress</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">concat</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    storeForm.<span class="property">phone</span> = <span class="string">&quot;&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明函数打开添加仓库信息对话</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openStoreDialog</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    dialogStoreVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    operationType.<span class="property">value</span> = <span class="string">&quot;add&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 清空表单</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数提交仓库信息保存的请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">subStoreForm</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> submitData = &#123; ...storeForm &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 添加时删除 storeId</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">if</span> (operationType.<span class="property">value</span> === <span class="string">&quot;add&quot;</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="keyword">delete</span> submitData.<span class="property">storeId</span>;</span></span><br><span class="line"><span class="language-javascript">      storeApi</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">saveStore</span>(submitData)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">queryStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//关闭对话框</span></span></span><br><span class="line"><span class="language-javascript">            dialogStoreVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//清空表单</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">      storeApi</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">updateStore</span>(submitData)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//刷新列表</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">queryStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//关闭对话框</span></span></span><br><span class="line"><span class="language-javascript">            dialogStoreVisible.<span class="property">value</span> = <span class="literal">false</span>;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">//清空表单</span></span></span><br><span class="line"><span class="language-javascript">            <span class="title function_">resetForm</span>();</span></span><br><span class="line"><span class="language-javascript">          &#125;</span></span><br><span class="line"><span class="language-javascript">          <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;)</span></span><br><span class="line"><span class="language-javascript">        .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">        &#125;);</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//实现仓库信息的回显</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">openEditStore</span>(<span class="params">row</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    operationType.<span class="property">value</span> = <span class="string">&quot;edit&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">    dialogStoreVisible.<span class="property">value</span> = <span class="literal">true</span>;</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//将当前行数据赋值给表单进行回显</span></span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">Object</span>.<span class="title function_">assign</span>(storeForm, row);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生删除的ajax请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">deleteStore</span>(<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    storeApi</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">deleteStore</span>(id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (response.<span class="property">data</span>.<span class="property">code</span> == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//刷新</span></span></span><br><span class="line"><span class="language-javascript">          <span class="title function_">queryStoreList</span>(<span class="number">1</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">        <span class="title class_">ElMessage</span>(response.<span class="property">data</span>.<span class="property">message</span>);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="day17"><a class="markdownIt-Anchor" href="#day17"></a> Day17</h2><h3 id="1实现客户地区分布统计"><a class="markdownIt-Anchor" href="#1实现客户地区分布统计"></a> 1.实现客户地区分布统计</h3><h4 id="后端实现-27"><a class="markdownIt-Anchor" href="#后端实现-27"></a> 后端实现</h4><p><strong>创建 CountResult 实体类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.erp.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CountResult</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer value;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>CustomerMapper 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现客户地区分布统计*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countCustomerAreaMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>CustomerMapper.xml 定义 sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--实现客户地区分布统计--&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countCustomerAreaMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.CountResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> address <span class="string">&#x27;name&#x27;</span>,<span class="built_in">count</span>(<span class="number">0</span>) <span class="string">&#x27;value&#x27;</span> <span class="keyword">from</span> t_customer <span class="keyword">group</span> <span class="keyword">by</span> address</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>CustomerService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现客户地区分布统计*/</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countCustService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>CustomerServiceImpl 实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countCustService</span><span class="params">()</span> &#123;</span><br><span class="line">      <span class="keyword">return</span> customerMapper.countCustomerAreaMapper();</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p><strong>CustomerController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理客户地区分布统计请求*/</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countCust&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countCust</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">return</span> customerService.countCustService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-27"><a class="markdownIt-Anchor" href="#前端实现-27"></a> 前端实现</h4><p><strong>新建 CustomerArea.vue 页面</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">&lt;template&gt;</span><br><span class="line">  &lt;!-- div容器用来渲染echarts控件 --&gt;</span><br><span class="line">  &lt;div id=&quot;main&quot; style=&quot;width: 100%;height: 100%&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;/template&gt;</span><br><span class="line"></span><br><span class="line">&lt;script setup&gt;</span><br><span class="line">import * as echarts from &quot;echarts&quot;;</span><br><span class="line">import &#123; onMounted &#125; from &quot;vue&quot;;</span><br><span class="line">import axios from &quot;axios&quot;;</span><br><span class="line"></span><br><span class="line">//定义函数统计客户地区分布</span><br><span class="line">function countCustomerArea() &#123;</span><br><span class="line">  //发送ajax请求，获得统计数据</span><br><span class="line">  axios</span><br><span class="line">    .get(&quot;http://localhost:8081/countCust&quot;)</span><br><span class="line">    .then((response) =&gt; &#123;</span><br><span class="line">      //响应成功渲染图表</span><br><span class="line">      var custDom = document.getElementById(&quot;main&quot;);</span><br><span class="line">      var custChart = echarts.init(custDom);</span><br><span class="line">      var option = &#123;</span><br><span class="line">        title: &#123;</span><br><span class="line">          text: &quot;客户地区分布统计&quot;,</span><br><span class="line">          left: &quot;center&quot;,</span><br><span class="line">        &#125;,</span><br><span class="line">        tooltip: &#123;</span><br><span class="line">          trigger: &quot;item&quot;,</span><br><span class="line">          formatter: &quot;&#123;a&#125; &lt;br/&gt;&#123;b&#125; : &#123;c&#125; (&#123;d&#125;%)&quot;,</span><br><span class="line">        &#125;,</span><br><span class="line">        toolbox: &#123;</span><br><span class="line">          show: true,</span><br><span class="line">          feature: &#123;</span><br><span class="line">            mark: &#123; show: true &#125;,</span><br><span class="line">            dataView: &#123; show: true, readOnly: false &#125;,</span><br><span class="line">            restore: &#123; show: true &#125;,</span><br><span class="line">            saveAsImage: &#123; show: true &#125;,</span><br><span class="line">          &#125;,</span><br><span class="line">        &#125;,</span><br><span class="line">        series: [</span><br><span class="line">          &#123;</span><br><span class="line">            name: &quot;客户分布&quot;,</span><br><span class="line">            type: &quot;pie&quot;,</span><br><span class="line">            radius: [20, 140],</span><br><span class="line">            center: [&quot;50%&quot;, &quot;50%&quot;],</span><br><span class="line">            roseType: &quot;area&quot;,</span><br><span class="line">            itemStyle: &#123;</span><br><span class="line">              borderRadius: 5,</span><br><span class="line">            &#125;,</span><br><span class="line">            data: response.data,</span><br><span class="line">          &#125;,</span><br><span class="line">        ],</span><br><span class="line">      &#125;;</span><br><span class="line"></span><br><span class="line">      option &amp;&amp; custChart.setOption(option);</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch((error) =&gt; &#123;</span><br><span class="line">      console.log(error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">//加载视图调用函数</span><br><span class="line">onMounted(function () &#123;</span><br><span class="line">  countCustomerArea();</span><br><span class="line">&#125;);</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style scoped&gt;&lt;/style&gt;</span><br></pre></td></tr></table></figure><h3 id="2实现年-月销售统计"><a class="markdownIt-Anchor" href="#2实现年-月销售统计"></a> 2.实现年-月销售统计</h3><h4 id="后端实现年统计"><a class="markdownIt-Anchor" href="#后端实现年统计"></a> 后端实现(年统计)</h4><p>OrderMapper 接口定义方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*统计查询销售数据的年份*/</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Integer&gt; <span class="title function_">querySellYearMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>实现接口 sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--定义sql统计年份--&gt;</span></span><br><span class="line">    <span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;querySellYearMapper&quot; resultType<span class="operator">=</span>&quot;java.lang.Integer&quot;<span class="operator">&gt;</span></span><br><span class="line">        <span class="keyword">select</span> <span class="keyword">distinct</span> <span class="keyword">year</span>(order_date) <span class="keyword">from</span> t_order</span><br><span class="line">    <span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>OrderService 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*统计销售数据年份*/</span></span><br><span class="line"><span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">querySellYearService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>OrderServiceImpl 实现方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">querySellYearService</span><span class="params">()</span> &#123;</span><br><span class="line">       List&lt;Integer&gt; integerList = orderMapper.querySellYearMapper();</span><br><span class="line">       List&lt;Map&lt;String, Object&gt;&gt; list=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">       <span class="keyword">for</span>(Integer year:integerList)&#123;</span><br><span class="line">           Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">           result.put(<span class="string">&quot;year&quot;</span>,year);</span><br><span class="line">           result.put(<span class="string">&quot;label&quot;</span>,year+<span class="string">&quot;年&quot;</span>);</span><br><span class="line">           list.add(result);</span><br><span class="line">       &#125;</span><br><span class="line">       <span class="keyword">return</span> list;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><p>OrderController 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*处理加载销售数据年份请求*/</span></span><br><span class="line">   <span class="meta">@GetMapping(&quot;/queryYear&quot;)</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;Map&lt;String, Object&gt;&gt; <span class="title function_">queryYear</span><span class="params">()</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> orderService.querySellYearService();</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h4 id="后端实现月统计"><a class="markdownIt-Anchor" href="#后端实现月统计"></a> 后端实现(月统计)</h4><p>创建 SellResult 实体类</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.erp.dto;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">SellResult</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> Integer mth;</span><br><span class="line">    <span class="keyword">private</span> Double mny;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>OrderMapper 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*统计查询某个年份12个月销售额*/</span></span><br><span class="line">   <span class="keyword">public</span> List&lt;SellResult&gt; <span class="title function_">countSellMonthMapper</span><span class="params">(String year)</span>;</span><br></pre></td></tr></table></figure><p>OrderMapper.xml 定义 sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">--统计某年12个月销售额--&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countSellMonthMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.SellResult&quot;</span><br><span class="line">        parameterType<span class="operator">=</span>&quot;java.lang.String&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">month</span>(order_date) mth ,<span class="built_in">sum</span>(pay_money) mny  <span class="keyword">from</span> t_order</span><br><span class="line">    <span class="keyword">where</span> <span class="keyword">year</span>(order_date) <span class="operator">=</span>#&#123;<span class="keyword">year</span>&#125;</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> mth</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> mth</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>OrderService 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> Map&lt;String,Object&gt; <span class="title function_">queryYearMonthService</span><span class="params">(String  year)</span>;</span><br></pre></td></tr></table></figure><p>OrderServiceImpl 实现方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line">  <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">queryYearMonthService</span><span class="params">(String year)</span> &#123;</span><br><span class="line"></span><br><span class="line">      List&lt;SellResult&gt; sellResults = orderMapper.countSellMonthMapper(year);</span><br><span class="line">      Map&lt;String, Object&gt; result=<span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">      <span class="comment">//创建封装月份数据集合</span></span><br><span class="line">      List&lt;String&gt; mths=<span class="keyword">new</span> <span class="title class_">ArrayList</span>();</span><br><span class="line">      <span class="comment">//封装月份销售额数据集合</span></span><br><span class="line">      List&lt;Double&gt; mnys=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">      <span class="keyword">for</span>(<span class="type">int</span> m=<span class="number">1</span>;m&lt;=<span class="number">12</span>;m++)&#123;</span><br><span class="line">          mths.add(m+<span class="string">&quot;月&quot;</span>);</span><br><span class="line">          mnys.add(<span class="number">0.0</span>);</span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span>(SellResult sr:sellResults)&#123;</span><br><span class="line">          System.out.println(<span class="string">&quot;sr=====&quot;</span>+sr);</span><br><span class="line">         <span class="keyword">if</span>(sr!=<span class="literal">null</span>)&#123;</span><br><span class="line">             System.out.println(sr.getMth()-<span class="number">1</span>+<span class="string">&quot;------&quot;</span>+sr.getMny());</span><br><span class="line">             <span class="type">Integer</span> <span class="variable">mth</span> <span class="operator">=</span> sr.getMth();</span><br><span class="line">             mnys.set(mth-<span class="number">1</span>,sr.getMny()); <span class="comment">//如果某个月份存在数据，覆盖默认值0.0</span></span><br><span class="line">         &#125;</span><br><span class="line"></span><br><span class="line">      &#125;</span><br><span class="line"></span><br><span class="line">      result.put(<span class="string">&quot;xdata&quot;</span>,mths);</span><br><span class="line">      result.put(<span class="string">&quot;ydata&quot;</span>,mnys);</span><br><span class="line"></span><br><span class="line">      <span class="keyword">return</span> result;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>OrderController 添加方法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">/*处理某年12个月销售额的请求*/</span><br><span class="line">@GetMapping(&quot;/countSell&quot;)</span><br><span class="line">public Map&lt;String,Object&gt; countYearSell(String year)&#123;</span><br><span class="line">    return orderService.queryYearMonthService(year);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前段实现"><a class="markdownIt-Anchor" href="#前段实现"></a> 前段实现</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>请选择年份<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;yearForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;120px&quot;</span> <span class="attr">:inline</span>=<span class="string">&quot;true&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;年份&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 34%&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-select</span></span></span><br><span class="line"><span class="tag">        <span class="attr">v-model</span>=<span class="string">&quot;yearForm.year&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">class</span>=<span class="string">&quot;m-2&quot;</span></span></span><br><span class="line"><span class="tag">        <span class="attr">placeholder</span>=<span class="string">&quot;请选择年份&quot;</span></span></span><br><span class="line"><span class="tag">        @<span class="attr">change</span>=<span class="string">&quot;handleYearMthSell&quot;</span></span></span><br><span class="line"><span class="tag">      &gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">          <span class="attr">v-for</span>=<span class="string">&quot;item in yearList&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:key</span>=<span class="string">&quot;item.year&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:label</span>=<span class="string">&quot;item.label&quot;</span></span></span><br><span class="line"><span class="tag">          <span class="attr">:value</span>=<span class="string">&quot;item.year&quot;</span></span></span><br><span class="line"><span class="tag">        /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;sellCharts&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%; height: 100%&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, reactive, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明表单数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> yearForm = <span class="title function_">reactive</span>(&#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">year</span>: <span class="string">&quot;&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明选项集合</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> yearList = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义发送请求，加载年份数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">loadYear</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/queryYear&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        yearList.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//页面加载调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">loadYear</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//下拉列表框选择内容发生变化的回调函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">handleYearMthSell</span>(<span class="params">year</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(year);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发生请求加载数据</span></span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/countSell?year=&quot;</span> + year)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> sellDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;sellCharts&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> sellChart = echarts.<span class="title function_">init</span>(sellDom);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">xAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="string">&quot;category&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">data</span>: response.<span class="property">data</span>.<span class="property">xdata</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">yAxis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">type</span>: <span class="string">&quot;value&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: response.<span class="property">data</span>.<span class="property">ydata</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;bar&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">showBackground</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">backgroundStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">color</span>: <span class="string">&quot;rgba(180, 180, 180, 0.2)&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        option &amp;&amp; sellChart.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;&#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="day18"><a class="markdownIt-Anchor" href="#day18"></a> Day18</h2><h3 id="1实现员工信息统计"><a class="markdownIt-Anchor" href="#1实现员工信息统计"></a> 1.实现员工信息统计</h3><h4 id="后端实现年龄分布统计"><a class="markdownIt-Anchor" href="#后端实现年龄分布统计"></a> 后端实现（年龄分布统计）</h4><p><strong>UserMapper 接口添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现员工按照年龄段分布统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeAageMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>UserMapper.xml 定义 SQL</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 实现员工年龄段分布统计 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countEmployeeAageMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.CountResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">           <span class="keyword">CASE</span></span><br><span class="line">               <span class="keyword">WHEN</span> age <span class="keyword">between</span> <span class="number">18</span> <span class="keyword">and</span> <span class="number">25</span> <span class="keyword">THEN</span> <span class="string">&#x27;[18 TO 25]&#x27;</span></span><br><span class="line">               <span class="keyword">WHEN</span> age <span class="keyword">between</span> <span class="number">26</span> <span class="keyword">and</span> <span class="number">30</span> <span class="keyword">THEN</span> <span class="string">&#x27;[26 TO 30]&#x27;</span></span><br><span class="line">               <span class="keyword">WHEN</span> age <span class="keyword">between</span> <span class="number">31</span> <span class="keyword">and</span> <span class="number">35</span> <span class="keyword">THEN</span> <span class="string">&#x27;[31 TO 35]&#x27;</span></span><br><span class="line">               <span class="keyword">WHEN</span> age <span class="keyword">between</span> <span class="number">36</span> <span class="keyword">and</span> <span class="number">40</span> <span class="keyword">THEN</span> <span class="string">&#x27;[36 TO 40]&#x27;</span></span><br><span class="line">               <span class="keyword">WHEN</span> age <span class="keyword">between</span> <span class="number">41</span> <span class="keyword">and</span> <span class="number">45</span> <span class="keyword">THEN</span> <span class="string">&#x27;[41 TO 45]&#x27;</span></span><br><span class="line">               <span class="keyword">ELSE</span> <span class="string">&#x27;[56 TO 100]&#x27;</span></span><br><span class="line">           <span class="keyword">END</span> <span class="string">&#x27;name&#x27;</span></span><br><span class="line">    <span class="keyword">from</span> t_user</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> name</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>UserService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现员工按照年龄段分布统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeAageService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>UserServiceImpl 实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeAageService</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> userMapper.countEmployeeAageMapper();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>UserController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 处理员工年龄分布统计请求 */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countEmpAge&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmpAge</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> userService.countEmployeeAageService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="后端实现学历分布统计"><a class="markdownIt-Anchor" href="#后端实现学历分布统计"></a> 后端实现（学历分布统计）</h4><p>UserMapper 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现员工按照学历统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeEduMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>UserMapper.xml 定义 sql</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 定义sql统计员工学历分布 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countEmployeeEduMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.CountResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> edu name, <span class="built_in">count</span>(id) <span class="keyword">value</span> <span class="keyword">from</span> t_user <span class="keyword">group</span> <span class="keyword">by</span> edu</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p>UserService 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现员工学历分布统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeEduService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p>UserServiceImpl 实现方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmployeeEduService</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> userMapper.countEmployeeEduMapper();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>UserController 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 处理员工学历分布统计的请求 */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countEmpEdu&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countEmpEdu</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> userService.countEmployeeEduService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-28"><a class="markdownIt-Anchor" href="#前端实现-28"></a> 前端实现</h4><p><strong>在 menu 表中注册页面</strong></p><p><strong>实现员工信息统计页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>员工信息统计<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;countEmpAge&quot;</span>&gt;</span>年龄分布统计<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;countEmpEdu&quot;</span>&gt;</span>学历分布统计<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">hr</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;empInfo&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%;height: 100%&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生请求，统计年龄分部</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">countEmpAge</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/countEmpAge&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得显示echarts控件的dom</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> empDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;empInfo&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//创建echarts对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> ageEcharts = echarts.<span class="title function_">init</span>(empDom);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">top</span>: <span class="string">&quot;5%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">left</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">name</span>: <span class="string">&quot;员工年龄分部&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">padAngle</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">borderRadius</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">position</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">show</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontSize</span>: <span class="number">40</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        option &amp;&amp; ageEcharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;&#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//页面加载调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">countEmpAge</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数统计员工学历分布</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">countEmpEdu</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/countEmpEdu&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//实现echarts控件数据的渲染</span></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得显示echarts控件的dom</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> empDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;empInfo&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//创建echarts对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> eudEcharts = echarts.<span class="title function_">init</span>(empDom);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">top</span>: <span class="string">&quot;5%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">left</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">name</span>: <span class="string">&quot;员工学历分部&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">padAngle</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">borderRadius</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">position</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">show</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontSize</span>: <span class="number">40</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        option &amp;&amp; eudEcharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改 index.vue，注册页面</strong></p><h3 id="2实现投诉问题统计"><a class="markdownIt-Anchor" href="#2实现投诉问题统计"></a> 2.实现投诉问题统计</h3><h4 id="后端实现问题类型统计"><a class="markdownIt-Anchor" href="#后端实现问题类型统计"></a> 后端实现（问题类型统计）</h4><p><strong>AfterSalesMapper 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现投诉按照类型统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionTypeService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesMapper.xml 定义 sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countQuestionTypeMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.CountResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        sum <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">        concat(question, <span class="string">&#x27; : &#x27;</span>, <span class="keyword">TRUNCATE</span>(sum<span class="operator">/</span>total<span class="operator">*</span><span class="number">100</span>, <span class="number">2</span>), <span class="string">&#x27;%&#x27;</span>) <span class="string">&#x27;name&#x27;</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        (</span><br><span class="line">            <span class="keyword">select</span> question, <span class="built_in">count</span>(id) sum,</span><br><span class="line">            (<span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="keyword">from</span> t_after_sales) total <span class="keyword">from</span> t_after_sales</span><br><span class="line">            <span class="keyword">group</span> <span class="keyword">by</span> question</span><br><span class="line">        ) out_table</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>AfterSalesService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现投诉按照类型统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionTypeService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesServiceImpl 实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionTypeService</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> afterSalesMapper.countQuestionTypeMapper();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 处理投诉问题类型统计请求 */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countQuestionType&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionType</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> afterSalesService.countQuestionTypeService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="后端实现问题状态统计"><a class="markdownIt-Anchor" href="#后端实现问题状态统计"></a> 后端实现（问题状态统计）</h4><p><strong>AfterSalesMapper 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 按照处理状态进行投诉统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionStateMapper</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesMapper.xml 顶级 sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 定义sql按照投诉处理状态，进行统计 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countQuestionStateMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.CountResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span></span><br><span class="line">        sum <span class="string">&#x27;value&#x27;</span>,</span><br><span class="line">        concat(<span class="string">&#x27; [ &#x27;</span>, state, <span class="string">&#x27; ] &#x27;</span>, <span class="keyword">TRUNCATE</span>(sum<span class="operator">/</span>total<span class="operator">*</span><span class="number">100</span>, <span class="number">2</span>), <span class="string">&#x27;%&#x27;</span>) <span class="string">&#x27;name&#x27;</span></span><br><span class="line">    <span class="keyword">from</span></span><br><span class="line">        (</span><br><span class="line">            <span class="keyword">select</span> state, <span class="built_in">count</span>(id) sum,</span><br><span class="line">            (<span class="keyword">select</span> <span class="built_in">count</span>(id) <span class="keyword">from</span> t_after_sales) total</span><br><span class="line">            <span class="keyword">from</span> t_after_sales</span><br><span class="line">            <span class="keyword">group</span> <span class="keyword">by</span> state</span><br><span class="line">        ) out_table</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>AfterSalesService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 实现投诉按照处理状态统计 */</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionStateService</span><span class="params">()</span>;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesServiceImpl 实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionStateService</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> afterSalesMapper.countQuestionStateMapper();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>AfterSalesController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 处理投诉问题按照处理状态进行统计的请求 */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countQuestionState&quot;)</span></span><br><span class="line"><span class="keyword">public</span> List&lt;CountResult&gt; <span class="title function_">countQuestionState</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> afterSalesService.countQuestionStateService();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-29"><a class="markdownIt-Anchor" href="#前端实现-29"></a> 前端实现</h4><p><strong>在 menu 表中注册页面</strong></p><p><strong>实现投诉问题统计页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h2</span>&gt;</span>投诉统计<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;questionTypeCount&quot;</span>&gt;</span>投诉类型统计<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;success&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;questionStateCount&quot;</span>&gt;</span>回复状态统计<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;questionInfo&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width:100%;height: 100%&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生请求，加载投诉类型统计数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> * <span class="keyword">as</span> echarts <span class="keyword">from</span> <span class="string">&quot;echarts&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">questionTypeCount</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/countQuestionType&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得显示echarts控件的dom</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> questionDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;questionInfo&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//创建echarts对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> typeEcharts = echarts.<span class="title function_">init</span>(questionDom);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">top</span>: <span class="string">&quot;5%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">left</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">name</span>: <span class="string">&quot;投诉问题类型数据&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">padAngle</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">borderRadius</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">position</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">show</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontSize</span>: <span class="number">40</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        option &amp;&amp; typeEcharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//页面加载调用函数</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">questionTypeCount</span>();</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//定义函数发生按照回复状态进行统计的请求</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">function</span> <span class="title function_">questionStateCount</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/countQuestionState&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//获得dom对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> quesDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;questionInfo&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//初始化echarts对象</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> stateEcharts = echarts.<span class="title function_">init</span>(quesDom);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">var</span> option = &#123;</span></span><br><span class="line"><span class="language-javascript">          <span class="comment">//完成echarts控件渲染的配置</span></span></span><br><span class="line"><span class="language-javascript">          <span class="attr">tooltip</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">trigger</span>: <span class="string">&quot;item&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">legend</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">top</span>: <span class="string">&quot;5%&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">            <span class="attr">left</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">          &#125;,</span></span><br><span class="line"><span class="language-javascript">          <span class="attr">series</span>: [</span></span><br><span class="line"><span class="language-javascript">            &#123;</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">name</span>: <span class="string">&quot;回复状态统计&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">type</span>: <span class="string">&quot;pie&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">radius</span>: [<span class="string">&quot;40%&quot;</span>, <span class="string">&quot;70%&quot;</span>],</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">avoidLabelOverlap</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">padAngle</span>: <span class="number">5</span>,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">itemStyle</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">borderRadius</span>: <span class="number">10</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">position</span>: <span class="string">&quot;center&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">emphasis</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">label</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">show</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontSize</span>: <span class="number">40</span>,</span></span><br><span class="line"><span class="language-javascript">                  <span class="attr">fontWeight</span>: <span class="string">&quot;bold&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">                &#125;,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">labelLine</span>: &#123;</span></span><br><span class="line"><span class="language-javascript">                <span class="attr">show</span>: <span class="literal">false</span>,</span></span><br><span class="line"><span class="language-javascript">              &#125;,</span></span><br><span class="line"><span class="language-javascript">              <span class="attr">data</span>: response.<span class="property">data</span>,</span></span><br><span class="line"><span class="language-javascript">            &#125;,</span></span><br><span class="line"><span class="language-javascript">          ],</span></span><br><span class="line"><span class="language-javascript">        &#125;;</span></span><br><span class="line"><span class="language-javascript">        option &amp;&amp; stateEcharts.<span class="title function_">setOption</span>(option);</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改 index.vue，注册页面</strong></p><h3 id="3实现统计-12-个月销售量"><a class="markdownIt-Anchor" href="#3实现统计-12-个月销售量"></a> 3.实现统计 12 个月销售量</h3><h4 id="后端实现-28"><a class="markdownIt-Anchor" href="#后端实现-28"></a> 后端实现</h4><p><strong>OrderMapper 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*实现年12个月销售商品数量的统计*/</span></span><br><span class="line"> <span class="keyword">public</span> List&lt;SellResult&gt; <span class="title function_">countSellNumMapper</span><span class="params">(String year)</span>;</span><br></pre></td></tr></table></figure><p><strong>OrderMapper.xml 定义 sql</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="operator">&lt;</span><span class="operator">!</span><span class="comment">-- 实现某年12个月，每个月销售量的统计 --&gt;</span></span><br><span class="line"><span class="operator">&lt;</span><span class="keyword">select</span> id<span class="operator">=</span>&quot;countSellNumMapper&quot; resultType<span class="operator">=</span>&quot;com.erp.dto.SellResult&quot;<span class="operator">&gt;</span></span><br><span class="line">    <span class="keyword">select</span> <span class="keyword">month</span>(order_date) mth, <span class="built_in">sum</span>(num) mny <span class="keyword">from</span> t_order</span><br><span class="line">    <span class="keyword">where</span> <span class="keyword">year</span>(order_date)<span class="operator">=</span>#&#123;<span class="keyword">year</span>&#125;</span><br><span class="line">    <span class="keyword">group</span> <span class="keyword">by</span> mth</span><br><span class="line">    <span class="keyword">order</span> <span class="keyword">by</span> mth</span><br><span class="line"><span class="operator">&lt;</span><span class="operator">/</span><span class="keyword">select</span><span class="operator">&gt;</span></span><br></pre></td></tr></table></figure><p><strong>OrderService 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 统计年每个月销售商品的数量 */</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">querySellNumService</span><span class="params">(String year)</span>;</span><br></pre></td></tr></table></figure><p><strong>OrderServiceImpl 实现方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">querySellNumService</span><span class="params">(String year)</span> &#123;</span><br><span class="line">    <span class="comment">// 查询数据库</span></span><br><span class="line">    List&lt;SellResult&gt; sellResults = orderMapper.countSellNumMapper(year);</span><br><span class="line">    <span class="comment">// 创建List集合封装每年12个月</span></span><br><span class="line">    List&lt;String&gt; mths = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">    <span class="comment">// 创建List集合封装每个12个月的销售数量</span></span><br><span class="line">    List&lt;Double&gt; nums = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化集合</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> <span class="variable">x</span> <span class="operator">=</span> <span class="number">1</span>; x &lt;= <span class="number">12</span>; x++) &#123;</span><br><span class="line">        mths.add(x + <span class="string">&quot;月&quot;</span>);</span><br><span class="line">        nums.add((<span class="type">double</span>) <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 根据对应月份的具体的销售数量，覆盖默认数量0</span></span><br><span class="line">    <span class="keyword">for</span> (SellResult sr : sellResults) &#123;</span><br><span class="line">        <span class="keyword">if</span> (sr != <span class="literal">null</span>) &#123;</span><br><span class="line">            nums.set(sr.getMth() - <span class="number">1</span>, sr.getMny());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将响应数据放入Map集合</span></span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    result.put(<span class="string">&quot;xdata&quot;</span>, mths);</span><br><span class="line">    result.put(<span class="string">&quot;ydata&quot;</span>, nums);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>OrderController 添加方法</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 处理年12个月，每个月销售数量统计的请求 */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/countNum&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">countNum</span><span class="params">(String year)</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> orderService.querySellNumService(year);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-30"><a class="markdownIt-Anchor" href="#前端实现-30"></a> 前端实现</h4><p><strong>在 menu 表中注册页面</strong></p><p><strong>实现销售额统计页面</strong></p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">template</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- 后台主页布局 --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;common-layout&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-header</span> <span class="attr">class</span>=<span class="string">&quot;top&quot;</span>&gt;</span>ERP-欢乐斗地主小组<span class="tag">&lt;/<span class="name">el-header</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">el-container</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-aside</span> <span class="attr">width</span>=<span class="string">&quot;240px&quot;</span> <span class="attr">class</span>=<span class="string">&quot;left&quot;</span>&gt;</span></span><br><span class="line">          系统菜单</span><br><span class="line"></span><br><span class="line">          <span class="comment">&lt;!--添加Menu菜单组件--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">el-menu</span> <span class="attr">class</span>=<span class="string">&quot;el-menu-vertical-demo&quot;</span> @<span class="attr">select</span>=<span class="string">&quot;handlerSelect&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-sub-menu</span> <span class="attr">v-for</span>=<span class="string">&quot;menu in menus&quot;</span> <span class="attr">:index</span>=<span class="string">&quot;String(menu.id)&quot;</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">template</span> #<span class="attr">title</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">span</span>&gt;</span>&#123;&#123; menu.label &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">              <span class="tag">&lt;<span class="name">el-menu-item</span></span></span><br><span class="line"><span class="tag">                <span class="attr">v-for</span>=<span class="string">&quot;subMenu in menu.subMenus&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">:index</span>=<span class="string">&quot;String(subMenu.id)&quot;</span></span></span><br><span class="line"><span class="tag">              &gt;</span></span><br><span class="line">                &#123;&#123;subMenu.label&#125;&#125;</span><br><span class="line">              <span class="tag">&lt;/<span class="name">el-menu-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-sub-menu</span>&gt;</span></span><br><span class="line">          <span class="tag">&lt;/<span class="name">el-menu</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-aside</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-main</span> <span class="attr">class</span>=<span class="string">&quot;right&quot;</span>&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--通过点击左边菜单，动态显示不同组件 --&gt;</span></span><br><span class="line">          <span class="comment">&lt;!--           &lt;component :is=&quot;currentComponent&quot;&gt;&lt;/component&gt;--&gt;</span></span><br><span class="line">          <span class="tag">&lt;<span class="name">component</span> <span class="attr">:is</span>=<span class="string">&quot;currentComponent&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">component</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-main</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-container</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">setup</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddCustomer&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListCustomer</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListCustomer&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddSellJh&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListSellJh</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListSellJh&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListCustOrder</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListCustOrder&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListAfterSale</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListAfterSale&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">TreeDemo</span> <span class="keyword">from</span> <span class="string">&quot;@/views/TreeDemo&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AddMenus</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AddMenus&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">RoleManager</span> <span class="keyword">from</span> <span class="string">&quot;@/views/RoleManager&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">UserManager</span> <span class="keyword">from</span> <span class="string">&quot;@/views/UserManager&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">CategoryManager</span> <span class="keyword">from</span> <span class="string">&quot;@/views/CategoryManager&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ItemManager</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ItemManager&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">BuyListManager</span> <span class="keyword">from</span> <span class="string">&quot;@/views/BuyListManager&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">InStoreList</span> <span class="keyword">from</span> <span class="string">&quot;@/views/InStoreList&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListOutStore</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListOutStore&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">ListStore</span> <span class="keyword">from</span> <span class="string">&quot;@/views/ListStore&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">CustomerArea</span> <span class="keyword">from</span> <span class="string">&quot;@/views/CustomerArea&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">YearMonthCount</span> <span class="keyword">from</span> <span class="string">&quot;@/views/YearMonthCount&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">EmployeeCount</span> <span class="keyword">from</span> <span class="string">&quot;@/views/EmployeeCount&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">AfterSaleCount</span> <span class="keyword">from</span> <span class="string">&quot;@/views/AfterSaleCount&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> <span class="title class_">YearNumCount</span> <span class="keyword">from</span> <span class="string">&quot;@/views/YearNumCount&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> &#123; onMounted, ref &#125; <span class="keyword">from</span> <span class="string">&quot;vue&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明数组保存所有组件</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> views = [</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">AddCustomer</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListCustomer</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListAfterSale</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListCustOrder</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">AddSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">CustomerArea</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">YearMonthCount</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListSellJh</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">AddMenus</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">UserManager</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">RoleManager</span>,</span></span><br><span class="line"><span class="language-javascript">    ,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">TreeDemo</span>,</span></span><br><span class="line"><span class="language-javascript">    ,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">CategoryManager</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ItemManager</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">BuyListManager</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">InStoreList</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListOutStore</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">ListStore</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">EmployeeCount</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">AfterSaleCount</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="title class_">YearNumCount</span>,</span></span><br><span class="line"><span class="language-javascript">  ];</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明变量保存当前需要显示的组件名</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> currentComponent = <span class="title function_">ref</span>(views[<span class="number">0</span>]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//声明菜单对象集合数据</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> menus = <span class="title function_">ref</span>([]);</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">/*menu组件选中叶子节点触发的函数，参数index：菜单节点的index值，对应数据库菜单节点的id*/</span></span></span><br><span class="line"><span class="language-javascript">  <span class="keyword">const</span> handlerSelect = <span class="keyword">function</span> (<span class="params">id</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="variable language_">console</span>.<span class="title function_">log</span>(id);</span></span><br><span class="line"><span class="language-javascript">    <span class="comment">//发生ajax请求，加载组件下标</span></span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/compIndex?id=&quot;</span> + id)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//动态该currentComponent赋值,从组件集合views中获取的组件名字</span></span></span><br><span class="line"><span class="language-javascript">        currentComponent.<span class="property">value</span> = views[response.<span class="property">data</span>];</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript">  <span class="comment">//页面加载，发生ajax请求加载左侧菜单信息</span></span></span><br><span class="line"><span class="language-javascript">  <span class="title function_">onMounted</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    axios</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">get</span>(<span class="string">&quot;http://localhost:8081/listMenus&quot;</span>)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">then</span>(<span class="function">(<span class="params">response</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(response);</span></span><br><span class="line"><span class="language-javascript">        <span class="comment">//将响应的数据绑定到menus，实现数据渲染</span></span></span><br><span class="line"><span class="language-javascript">        menus.<span class="property">value</span> = response.<span class="property">data</span>;</span></span><br><span class="line"><span class="language-javascript">      &#125;)</span></span><br><span class="line"><span class="language-javascript">      .<span class="title function_">catch</span>(<span class="function">(<span class="params">error</span>) =&gt;</span> &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="variable language_">console</span>.<span class="title function_">log</span>(error);</span></span><br><span class="line"><span class="language-javascript">      &#125;);</span></span><br><span class="line"><span class="language-javascript">  &#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">scoped</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.top</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: azure;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">padding-top</span>: <span class="number">15px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.left</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: blanchedalmond;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">600px</span>;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css">  <span class="selector-class">.right</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">background-color</span>: cornsilk;</span></span><br><span class="line"><span class="language-css">  &#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><p><strong>修改 index.vue，注册页面</strong></p><h2 id="day22"><a class="markdownIt-Anchor" href="#day22"></a> Day22</h2><h3 id="1实现-session-会话跟踪"><a class="markdownIt-Anchor" href="#1实现-session-会话跟踪"></a> 1.实现 session 会话跟踪</h3><p><strong>为什么前后分离会导致 Session 失效？</strong></p><ol><li><strong>现象</strong>：在前后分离项目（如 Vue + Spring Boot）中，客户端每次向后端发送请求，后端都会创建一个全新的 Session 对象。这导致无法通过 Session 跟踪用户的登录状态等会话信息。</li><li><strong>根本原因</strong>：<ul><li>Session 机制依赖于 Cookie。服务器首次创建 Session 后，会将 Session ID 放在 Cookie 中返回给浏览器。</li><li>浏览器在后续请求中，会自动携带这个 Cookie，服务器通过 Cookie 中的 Session ID 找到对应的 Session。</li><li><strong>但在前后分离架构下</strong>，前端（如 <code>http://localhost:8080</code>）和后端（如 <code>http://localhost:8888</code>）属于<strong>跨域</strong>。出于安全策略，浏览器<strong>默认不会</strong>在跨域请求中发送 Cookie 等凭证信息。</li><li><strong>结果</strong>：后端收不到 Session ID，只能把每次请求都当作新客户端，从而创建新的 Session。</li></ul></li></ol><p><strong>解决方案：前后端协同，开启凭证（Cookie）传递</strong></p><p>要解决此问题，必须让浏览器在跨域请求时携带 Cookie，同时让服务器允许接收这个跨域的 Cookie。这需要前后端共同配置。</p><h4 id="后端实现-29"><a class="markdownIt-Anchor" href="#后端实现-29"></a> 后端实现</h4><p>放弃在每个 Controller 上写 <code>@CrossOrigin</code> 注解。通过 <code>WebMvcConfigurer</code> 实现全局配置，并通过配置文件管理 URL，实现与代码解耦。</p><p><strong>第一步：在 <code>application.properties</code> 中定义前端地址</strong></p><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 允许跨域的前端源地址，多个用逗号隔开</span></span><br><span class="line"><span class="attr">cors.allowed-origins</span>=<span class="string">http://localhost:8080,https://your.production.site</span></span><br></pre></td></tr></table></figure><p><strong>第二步：创建全局跨域配置类</strong></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CrossOriginConfig</span> <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 从配置文件动态读取允许的源</span></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;cors.allowed-origins&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String[] allowedOrigins;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>) <span class="comment">// 匹配所有接口</span></span><br><span class="line">                .allowedOrigins(allowedOrigins) <span class="comment">// 使用动态配置的源</span></span><br><span class="line">                .allowedMethods(<span class="string">&quot;GET&quot;</span>, <span class="string">&quot;POST&quot;</span>, <span class="string">&quot;PUT&quot;</span>, <span class="string">&quot;DELETE&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowCredentials(<span class="literal">true</span>); <span class="comment">// 核心：允许服务器处理凭证(Cookie)</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="前端实现-31"><a class="markdownIt-Anchor" href="#前端实现-31"></a> 前端实现</h4><p>在全局统一的 Axios 实例中进行配置，让所有请求自动携带凭证，无需改动任何业务组件。</p><p><strong>修改全局 Axios 实例 (<code>request.js</code> 或类似文件)</strong></p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&quot;axios&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建 axios 实例</span></span><br><span class="line"><span class="keyword">const</span> request = axios.<span class="title function_">create</span>(&#123;</span><br><span class="line">  <span class="comment">// baseURL, timeout等配置保持不变...</span></span><br><span class="line">  <span class="attr">baseURL</span>:</span><br><span class="line">    process.<span class="property">env</span>.<span class="property">NODE_ENV</span> === <span class="string">&quot;production&quot;</span> ? <span class="string">&quot;/api&quot;</span> : <span class="string">&quot;http://localhost:8888&quot;</span>,</span><br><span class="line">  <span class="attr">timeout</span>: <span class="number">5000</span>,</span><br><span class="line">  <span class="attr">withCredentials</span>: <span class="literal">true</span>, <span class="comment">// 核心：让所有请求自动携带Cookie</span></span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> request;</span><br></pre></td></tr></table></figure><hr><p><strong>一句话总结：后端配置 <code>allowCredentials(true)</code>，前端配置 <code>withCredentials: true</code>，并将具体 URL 写入配置文件中，实现代码与环境的完全分离。</strong></p><h3 id="2实现用户登录"><a class="markdownIt-Anchor" href="#2实现用户登录"></a> 2.实现用户登录</h3><p>暂时省略</p><h3 id="3-查询当前登录用户菜单"><a class="markdownIt-Anchor" href="#3-查询当前登录用户菜单"></a> 3 查询当前登录用户菜单</h3><h4 id="后端实现-30"><a class="markdownIt-Anchor" href="#后端实现-30"></a> 后端实现</h4><p>UserMapper 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/\*加载当前登录用户菜单信息\*/</span><br><span class="line">    <span class="keyword">public</span> List <span class="title function_">queryUserMenusMapper</span><span class="params">(Integer uid)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.2UserMapper.xml 定义 sql</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">         select distinct menus.\* from t_menus menus</span><br><span class="line">        inner join t_role_menu rm on menus.id=rm.mid</span><br><span class="line">        inner join t_user_role ur on rm.rid=ur.rid</span><br><span class="line">        where ur.uid=#&#123;uid&#125;    </span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.3UserService 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/\*加载左侧导航菜单，根据当前用户加载\*/</span><br><span class="line">    <span class="keyword">public</span> List <span class="title function_">queryUserMenusListService</span><span class="params">(Integer uid)</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.4UserServiceImpl 实现方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List <span class="title function_">queryUserMenusListService</span><span class="params">(Integer uid)</span> &#123;</span><br><span class="line">        <span class="type">List</span> <span class="variable">menus</span> <span class="operator">=</span> userMapper.queryUserMenusMapper(uid);</span><br><span class="line">        <span class="keyword">return</span> doListMenus(menus,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List <span class="title function_">doListMenus</span><span class="params">(List menus,Integer id)</span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//创建集合对象保存返回值</span></span><br><span class="line">        List result=<span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">        <span class="comment">//遍历menus集合获得每个菜单节点对象，m每个菜单节点对象</span></span><br><span class="line">        <span class="keyword">for</span>(Menus m:menus)&#123;</span><br><span class="line">            <span class="comment">//m菜单节点对象的父节点id，是否和传入id相等，如果相等说明当前遍历的节点m，是id对应的菜单节点的子节点</span></span><br><span class="line">            <span class="keyword">if</span>(m.getPid().equals(id))&#123;</span><br><span class="line"></span><br><span class="line">                MenusVo menusVo=<span class="keyword">new</span> <span class="title class_">MenusVo</span>();</span><br><span class="line">                BeanUtils.copyProperties(m,menusVo);</span><br><span class="line">                <span class="comment">//进行递归遍历</span></span><br><span class="line">                menusVo.setSubMenus(doListMenus(menus,m.getId()));</span><br><span class="line">                result.add(menusVo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.5UserController 添加方法</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/\*处理加载当前登录用户菜单的请求\*/</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/queryUserMenus&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> List <span class="title function_">queryUserMenus</span><span class="params">(HttpSession session)</span>&#123;</span><br><span class="line">        <span class="comment">//获得系统当前登录用户</span></span><br><span class="line">        User user= (User) session.getAttribute(<span class="string">&quot;online&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> userService.queryUserMenusListService(user.getId());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>4.6 修改 index.vue</p><h1 id="杂项"><a class="markdownIt-Anchor" href="#杂项"></a> 杂项</h1><h2 id="0配置编辑器提升编码体验"><a class="markdownIt-Anchor" href="#0配置编辑器提升编码体验"></a> 0.配置编辑器提升编码体验</h2><h3 id="格式化代码"><a class="markdownIt-Anchor" href="#格式化代码"></a> 格式化代码</h3><p>教程：<a target="_blank" rel="noopener" href="https://www.cnblogs.com/yourstars/p/14303346.html">VS Code 批量格式化文件</a></p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/hbuuid/p/11468578.html">IDEA 格式化项目中所有文件的方法</a></p><h3 id="自动导包"><a class="markdownIt-Anchor" href="#自动导包"></a> 自动导包</h3><p><a target="_blank" rel="noopener" href="https://www.quanxiaoha.com/idea/idea-auto-import-delete-pkg.html">IDEA 自动导包&amp;删除包（图文讲解）</a></p><h3 id="多文件搜索"><a class="markdownIt-Anchor" href="#多文件搜索"></a> 多文件搜索</h3><p>在写 java 代码的时候，经常需要找到某个实体类相关的 mapper，service 和 controller 代码</p><p>在 idea 中，可以双击<code>shift</code>按钮打开全局搜索，搜索该层级代码即可快速找到并打开相关代码文件</p><p><img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI0OCIgaGVpZ2h0PSI0OCIgdmlld0JveD0iMCAwIDI0IDI0Ij48Y2lyY2xlIGN4PSI0IiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgaWQ9InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAiIGF0dHJpYnV0ZU5hbWU9InIiIGJlZ2luPSIwO3N2Z1NwaW5uZXJzM0RvdHNTY2FsZTEuZW5kLTAuMjVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjxjaXJjbGUgY3g9IjEyIiBjeT0iMTIiIHI9IjMiIGZpbGw9ImN1cnJlbnRDb2xvciI+PGFuaW1hdGUgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNnMiIGR1cj0iMC43NXMiIHZhbHVlcz0iMzsuMjszIi8+PC9jaXJjbGU+PGNpcmNsZSBjeD0iMjAiIGN5PSIxMiIgcj0iMyIgZmlsbD0iY3VycmVudENvbG9yIj48YW5pbWF0ZSBpZD0ic3ZnU3Bpbm5lcnMzRG90c1NjYWxlMSIgYXR0cmlidXRlTmFtZT0iciIgYmVnaW49InN2Z1NwaW5uZXJzM0RvdHNTY2FsZTAuZW5kLTAuNDVzIiBkdXI9IjAuNzVzIiB2YWx1ZXM9IjM7LjI7MyIvPjwvY2lyY2xlPjwvc3ZnPg==" data-original="https://image.skyforever.top/blog/2025/10/94f9517cc59feef5c258514798a4165d.webp" alt="image-20250604094504379"></p><h2 id="1屏蔽某些不影响程序的警告"><a class="markdownIt-Anchor" href="#1屏蔽某些不影响程序的警告"></a> 1.屏蔽某些不影响程序的警告</h2><h3 id="前端"><a class="markdownIt-Anchor" href="#前端"></a> <strong>前端</strong></h3><h4 id="改变窗口大小时弹出黑框警告"><a class="markdownIt-Anchor" href="#改变窗口大小时弹出黑框警告"></a> 改变窗口大小时弹出黑框警告</h4><p>按照下面的教程在 main.js 里加代码就行</p><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/noah227/p/17654605.html">element-plus 的 el-select 报 ResizeObserver loop completed with undelivered notifications 错的一种可能原因及解决方案</a></p><h4 id="样式定义错误警告"><a class="markdownIt-Anchor" href="#样式定义错误警告"></a> 样式定义错误警告</h4><p>如果遇到以下报错</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">runtime-core.esm-bundler.js:238 [Vue warn]: Invalid prop: custom validator check failed <span class="keyword">for</span> prop <span class="string">&quot;pagerCount&quot;</span>.</span><br><span class="line">  at &lt;ElPagination small=<span class="string">&quot;&quot;</span> background=<span class="string">&quot;&quot;</span> page-size=10  ... &gt;</span><br></pre></td></tr></table></figure><p>需要看看相关定义是不是缺少属性值</p><p>例如我这里就是没有指定是 size 属性，而是直接写了 small 值</p><p>错误代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">  <span class="attr">small</span></span></span><br><span class="line"><span class="tag">  <span class="attr">background</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:pager-count</span>=<span class="string">&quot;7&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">current-change</span>=<span class="string">&quot;rolerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><p>正确代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">  <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">background</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:pager-count</span>=<span class="string">&quot;7&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:total</span>=<span class="string">&quot;total&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">current-change</span>=<span class="string">&quot;rolerPageChange&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><h4 id="invalid-prop-警告"><a class="markdownIt-Anchor" href="#invalid-prop-警告"></a> Invalid prop 警告</h4><p>遇到类似下面这种警告</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">runtime-core.esm-bundler.js:238 [Vue warn]: Invalid prop: custom validator check failed <span class="keyword">for</span> prop <span class="string">&quot;pagerCount&quot;</span>.</span><br><span class="line">at &lt;ElPagination size=<span class="string">&quot;small&quot;</span> background=<span class="string">&quot;&quot;</span> page-size=10 ... &gt;</span><br></pre></td></tr></table></figure><p>这是应为<code>pagerCount</code> 属性必须是 5 到 21 之间的奇数</p><p>例如下面这个位置，pager-count 必须为奇数</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">  <span class="attr">size</span>=<span class="string">&quot;small&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">background</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:pager-count</span>=<span class="string">&quot;7&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">layout</span>=<span class="string">&quot;prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">:total</span>=<span class="string">&quot;totalReplay&quot;</span></span></span><br><span class="line"><span class="tag">  <span class="attr">class</span>=<span class="string">&quot;mt-4&quot;</span></span></span><br><span class="line"><span class="tag">  @<span class="attr">current-change</span>=<span class="string">&quot;handlerReplayPageChange&quot;</span></span></span><br><span class="line"><span class="tag">/&gt;</span></span><br></pre></td></tr></table></figure><h3 id="后端"><a class="markdownIt-Anchor" href="#后端"></a> 后端</h3><h4 id="解决-mybatis-的-mapper-文件中错误"><a class="markdownIt-Anchor" href="#解决-mybatis-的-mapper-文件中错误"></a> 解决 mybatis 的 mapper 文件中错误</h4><p>报错提示：应为 ＜ statement ＞ 或 DELIMITER，得到 ‘id‘</p><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/m0_63902952/article/details/132406118">解决方法</a></p><hr><h2 id="2优化接口的定义"><a class="markdownIt-Anchor" href="#2优化接口的定义"></a> 2.优化接口的定义</h2><h4 id="后端优化"><a class="markdownIt-Anchor" href="#后端优化"></a> 后端优化</h4><p><strong>优化策略与辅助工具：</strong></p><p>在进行 Controller 精简时，引入以下辅助机制：</p><ol><li><p><strong>统一响应工具类 (<code>ResponseUtil</code>)</strong>：<br>创建一个工具类来生成标准的成功和失败响应体。这个类包含静态方法，用于构建包含 <code>code</code>（状态码）、<code>message</code>（/<code>msg</code>，提示信息）以及可选的 <code>data</code>（业务数据）字段的 <code>Map&lt;String, Object&gt;</code> 或自定义响应对象。这样避免在每个 Controller 方法中手动创建和填充 <code>HashMap</code>。</p><ul><li>我用的<code>ResponseUtil</code> 方法如下：</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.HashMap;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">ResponseUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY_CODE</span> <span class="operator">=</span> <span class="string">&quot;code&quot;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">String</span> <span class="variable">KEY_MESSAGE</span> <span class="operator">=</span> <span class="string">&quot;message&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">success</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(KEY_CODE, <span class="number">200</span>);</span><br><span class="line">        result.put(KEY_MESSAGE, message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> &lt;T&gt; Map&lt;String, Object&gt; <span class="title function_">success</span><span class="params">(String message, T data)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = success(message);</span><br><span class="line">        result.put(<span class="string">&quot;data&quot;</span>, data);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">error</span><span class="params">(<span class="type">int</span> code, String message)</span> &#123;</span><br><span class="line">        Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">        result.put(KEY_CODE, code);</span><br><span class="line">        result.put(KEY_MESSAGE, message);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 默认错误</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> Map&lt;String, Object&gt; <span class="title function_">error</span><span class="params">(String message)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> error(<span class="number">400</span>, message);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>全局异常处理 (<code>@ControllerAdvice</code> &amp; <code>@ExceptionHandler</code>)</strong>：<br>通过创建一个使用 <code>@ControllerAdvice</code> 注解的类，并结合 <code>@ExceptionHandler</code> 注解的方法，可以集中处理所有 Controller（或指定包下的 Controller）抛出的异常。这样做的好处是：</p><ul><li>Controller 方法中不再需要 <code>try-catch</code> 块来捕获通用异常。</li><li>统一了错误响应的格式。</li><li>便于统一记录错误日志。</li><li>可以针对不同类型的异常返回不同的 HTTP 状态码和错误信息。</li></ul><p>我用的全局异常处理代码：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.example.demo.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.example.demo.util.ResponseUtil;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.Logger;</span><br><span class="line"><span class="keyword">import</span> org.slf4j.LoggerFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ControllerAdvice;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ExceptionHandler;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.ResponseBody;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="meta">@ResponseBody</span> <span class="comment">//确保返回的是JSON</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHandler</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="type">Logger</span> <span class="variable">logger</span> <span class="operator">=</span> LoggerFactory.getLogger(GlobalExceptionHandler.class);</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line">    <span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">handleGlobalException</span><span class="params">(Exception e)</span> &#123;</span><br><span class="line">        logger.error(<span class="string">&quot;发生未捕获异常: &quot;</span>, e); <span class="comment">// 记录日志</span></span><br><span class="line">        <span class="keyword">return</span> ResponseUtil.error(<span class="number">500</span>, <span class="string">&quot;服务器内部错误，请稍后再试或联系管理员&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p><strong>Service 层承担业务逻辑</strong>：<br>确保所有业务相关的操作（即使是简单的 CRUD）都封装在 Service 层。Controller 的职责是接收 HTTP 请求，验证和转换参数（如果需要），调用相应的 Service 方法，然后根据 Service 的返回结果（或通过全局异常处理器）构建响应。这使得 Controller 保持“瘦”，业务逻辑也更易于复用和测试。</p></li></ol><p>现在，让我们看看 <code>OrderController</code> 在应用这些策略前后的代码对比。</p><div class="tag-plugin tabs" id="tab_1"><div class="nav-tabs"><div class="tab active"><a href="#tab_1-1">优化前</a></div><div class="tab"><a href="#tab_1-2">优化后</a></div></div><div class="tab-content"><div class="tab-pane active" id="tab_1-1"><p>在优化之前，<code>OrderController</code> 的每个方法都包含了手动创建响应 <code>Map</code> 以及 <code>try-catch</code> 块来处理异常和构建不同状态的响应。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 添加订单 */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/saveOrder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        orderService.save(order);</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;添加失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 删除订单 */</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/deleteOrder/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteOrder</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        orderService.removeById(id);</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除成功&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;删除失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 修改订单 */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/updateOrder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">    Map&lt;String, Object&gt; result = <span class="keyword">new</span> <span class="title class_">HashMap</span>&lt;&gt;();</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        orderService.updateById(order); <span class="comment">// MybatisPlus IService 方法返回 boolean</span></span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">200</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改成功&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        result.put(<span class="string">&quot;code&quot;</span>, <span class="number">400</span>);</span><br><span class="line">        result.put(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;修改失败&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></div><div class="tab-pane" id="tab_1-2"><p>应用了上述优化策略后，Controller 代码变得更加简洁和专注。</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 添加订单 */</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;/saveOrder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">saveOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">    <span class="comment">// Service 层 save 方法若失败会抛出异常，由全局异常处理器捕获</span></span><br><span class="line">    orderService.save(order);</span><br><span class="line">    <span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;添加成功&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 删除订单 */</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;/deleteOrder/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">deleteOrder</span><span class="params">(<span class="meta">@PathVariable</span> Integer id)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">removed</span> <span class="operator">=</span> orderService.removeById(id);</span><br><span class="line">    <span class="keyword">if</span> (removed) &#123;<span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;删除成功&quot;</span>);&#125;</span><br><span class="line">  	<span class="keyword">else</span> &#123;<span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;删除失败，订单可能不存在&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 修改订单 */</span></span><br><span class="line"><span class="meta">@PutMapping(&quot;/updateOrder&quot;)</span></span><br><span class="line"><span class="keyword">public</span> Map&lt;String, Object&gt; <span class="title function_">updateOrder</span><span class="params">(<span class="meta">@RequestBody</span> Order order)</span> &#123;</span><br><span class="line">    <span class="type">boolean</span> <span class="variable">updated</span> <span class="operator">=</span> orderService.updateById(order);</span><br><span class="line">    <span class="keyword">if</span> (updated) &#123;<span class="keyword">return</span> ResponseUtil.success(<span class="string">&quot;修改成功&quot;</span>);&#125;</span><br><span class="line">  <span class="keyword">else</span> &#123;<span class="keyword">return</span> ResponseUtil.error(<span class="number">400</span>, <span class="string">&quot;修改失败，订单可能不存在或数据无变更&quot;</span>);&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Controller 方法体大大缩减，逻辑更清晰。更专注于接收请求、调用 Service 和基于 Service 的直接业务结果（如 <code>boolean</code> 返回值）来构建响应。</p><ul><li><strong>统一处理</strong>：异常由<code>GlobalExceptionHandler</code> 统一处理，响应由<code>ResponseUtil</code> 统一构建。</li><li><strong>易于维护</strong>：修改响应格式或异常处理逻辑时，只需改动工具类或全局处理器。</li><li><strong>健壮性提升</strong>：对于 Service 层返回 <code>boolean</code> 的方法，优化后的代码能更明确地根据业务结果来判断成功或失败，并给出相应的提示。</li></ul></div></div></div><p>引入统一响应处理和全局异常捕获机制后，有效地精简 Controller 层的代码，使其职责更加单一，从而提高整个后端应用的开发效率和代码质量。对于那些 Service 方法本身就返回特定数据结构（如分页查询直接返回 <code>Map</code>）的接口，可以保持其原有返回，因为它们不一定适用标准的 <code>code/message</code> 包装。</p><h4 id="前端优化"><a class="markdownIt-Anchor" href="#前端优化"></a> 前端优化</h4><p>暂时省略</p><div class="tag-list"><a class="tag" href="/note/college/tags/%E8%BD%AF%E4%BB%B6%E5%BC%80%E5%8F%91/%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%AE%AD/">软件开发/项目实训</a></div></article><div class="article-footer"><section id="license"><div class="header"><span>许可协议</span></div><div class="body"><p>本文采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">署名-非商业性使用-相同方式共享 4.0 国际</a> 许可协议，转载请注明出处。</p></div></section><section id="share"><div class="header"><span>分享文章</span></div><div class="body"><div class="link"><input class="copy-area" readonly id="copy-link" value="http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0"></div><div class="social-wrap dis-select"><a class="social share-item wechat" onclick="util.toggle(&quot;qrcode-wechat&quot;)"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/b32ef3da1162a.svg"></a><a class="social share-item weibo" target="_blank" rel="external nofollow noopener noreferrer" href="https://service.weibo.com/share/share.php?url=http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0&title=ERP系统开发实训笔记 - Sky Blog&summary= ERP 系统开发实训笔记
笔记按照前后端的实现时间编写
 代码开源地址
前端：客户管理系统前端
后端：客户管理系统后端
 Day1 环境初始化
 后端搭建
 1.项目环境搭建
1）idea 初始化
类型选择 Maven，jdk 选 ..."><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/80c07e4dbb303.svg"></a><a class="social share-item email" href="mailto:?subject=ERP系统开发实训笔记 - Sky Blog&amp;body=http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/a1b00e20f425d.svg"></a><a class="social share-item link" onclick="util.copy(&quot;copy-link&quot;, &quot;复制成功&quot;)"><img src="https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/social/8411ed322ced6.svg"></a></div><div class="qrcode" id="qrcode-wechat" style="opacity:0;height:0"><img src="https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=http://skyforever.top/data/notebooks/ERP%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0"></div></div></section></div><div class="related-wrap md-text" id="comments"><section class="header cmt-title cap theme"><p>快来参与讨论吧~</p></section><section class="body cmt-body giscus"><svg class="loading" style="vertical-align:middle;fill:currentColor;overflow:hidden" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2709"><path d="M832 512c0-176-144-320-320-320V128c211.2 0 384 172.8 384 384h-64zM192 512c0 176 144 320 320 320v64C300.8 896 128 723.2 128 512h64z" p-id="2710"></path></svg><div id="giscus" src="https://giscus.app/client.js" data-repo="zhangwei43721/zhangwei43721.github.io" data-repo-id="R_kgDOOC101w" data-category="Announcements" data-category-id="DIC_kwDOOC10184Cv2Lm" data-mapping="pathname" data-strict="0" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="preferred_color_scheme" data-lang="zh-CN" data-loading="lazy" crossorigin="anonymous"></div></section></div><footer class="page-footer footnote"><hr><div class="text"><p>本站由 <a href="/">Skyforever</a> 使用 <a target="_blank" rel="noopener" href="https://github.com/xaoxuu/hexo-theme-stellar/tree/1.33.1">Stellar 1.33.1</a> 主题创建。<br>本博客所有文章除特别声明外，均采用 <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议，转载请注明出处。</p></div></footer><div class="main-mask" onclick="sidebar.dismiss()"></div></div><aside class="l_right"><div class="widgets"><widget class="widget-wrapper toc" id="data-toc" collapse="false"><div class="widget-header dis-select"><span class="name">本文目录</span><a class="cap-action" onclick="sidebar.toggleTOC()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></a></div><div class="widget-body"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#erp-%E7%B3%BB%E7%BB%9F%E5%BC%80%E5%8F%91%E5%AE%9E%E8%AE%AD%E7%AC%94%E8%AE%B0"><span class="toc-text">ERP 系统开发实训笔记</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%BC%80%E6%BA%90%E5%9C%B0%E5%9D%80"><span class="toc-text">代码开源地址</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day1-%E7%8E%AF%E5%A2%83%E5%88%9D%E5%A7%8B%E5%8C%96"><span class="toc-text">Day1 环境初始化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E6%90%AD%E5%BB%BA"><span class="toc-text">后端搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E9%A1%B9%E7%9B%AE%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-text">1.项目环境搭建</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="toc-text">2.配置数据库</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E7%94%A8-mybatiesx-%E7%94%9F%E6%88%90%E4%B8%89%E4%B8%AA%E5%B1%82%E7%BA%A7%E4%BB%A3%E7%A0%81"><span class="toc-text">3.用 mybatiesx 生成三个层级代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4%E5%86%99%E6%B5%8B%E8%AF%95%E4%BB%A3%E7%A0%81%E6%B5%8B%E8%AF%95%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E6%98%AF%E5%90%A6%E6%AD%A3%E5%B8%B8"><span class="toc-text">4.写测试代码测试增删改查是否正常</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5%E5%AE%9E%E7%8E%B0%E5%9F%BA%E6%9C%AC%E4%BB%A3%E7%A0%81"><span class="toc-text">5.实现基本代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E9%9D%A2%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88%E5%86%85%E5%AE%B9"><span class="toc-text">上面学了什么内容？</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#mybatis-plus-%E4%BB%A3%E7%A0%81%E7%94%A8%E6%B3%95"><span class="toc-text">MyBatis-Plus 代码用法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E4%BB%A3%E7%A0%81%E5%88%86%E5%B1%82%E8%A7%A3%E9%87%8A"><span class="toc-text">后端代码分层解释</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E6%90%AD%E5%BB%BA"><span class="toc-text">前端搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1%E5%AE%89%E8%A3%85-nodejs"><span class="toc-text">1.安装 Node.js</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2%E6%A0%B9%E6%8D%AE%E5%B7%A5%E7%A8%8B%E4%B8%8B%E9%9D%A2%E7%9A%84-readme-%E6%96%87%E6%A1%A3%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE"><span class="toc-text">2.根据工程下面的 readme 文档启动项目</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3%E9%85%8D%E7%BD%AE%E9%9C%80%E8%A6%81%E7%9A%84%E5%8C%85"><span class="toc-text">3.配置需要的包</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E9%9D%A2%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88%E5%86%85%E5%AE%B9-2"><span class="toc-text">上面学了什么内容？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day2-%E8%8F%9C%E5%8D%95%E5%8A%9F%E8%83%BD"><span class="toc-text">Day2 菜单功能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="toc-text">后端实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%B9%E5%89%8D%E7%AB%AF%E6%8F%90%E4%BE%9B-menu-%E5%8F%82%E6%95%B0"><span class="toc-text">对前端提供 menu 参数</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E6%8E%A5%E5%8F%A3%E4%BB%A3%E7%A0%81"><span class="toc-text">服务接口代码：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E5%AE%9E%E7%8E%B0%E4%BB%A3%E7%A0%81"><span class="toc-text">服务实现代码：</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E9%9D%A2%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88%E5%86%85%E5%AE%B9-3"><span class="toc-text">上面学了什么内容？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0"><span class="toc-text">前端实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BB%8E%E5%90%8E%E7%AB%AF%E8%8E%B7%E5%8F%96-menu-%E5%8F%82%E6%95%B0"><span class="toc-text">从后端获取 menu 参数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E9%9D%A2%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88%E5%86%85%E5%AE%B9-4"><span class="toc-text">上面学了什么内容？</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day3"><span class="toc-text">Day3</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E5%AE%A2%E6%88%B7%E4%BF%A1%E6%81%AF"><span class="toc-text">1 增删改查客户信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-2"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-2"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5%E9%94%80%E5%94%AE%E8%BF%87%E7%A8%8B%E4%BF%A1%E6%81%AF"><span class="toc-text">2 增删改查销售过程信息</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-3"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-3"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#day3-%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-text">Day3 学了什么</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day4"><span class="toc-text">Day4</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E7%BB%9F%E8%AE%A1%E6%AF%8F%E4%B8%AA%E5%AE%A2%E6%88%B7%E5%8E%86%E5%8F%B2%E6%B6%88%E8%B4%B9%E6%80%BB%E9%A2%9D"><span class="toc-text">1.统计每个客户历史消费总额</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E9%94%80%E5%94%AE%E8%BF%87%E7%A8%8B%E8%A1%A8%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">2.实现销售过程表的增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-4"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-4"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E9%94%80%E5%94%AE%E8%BF%87%E7%A8%8B%E9%A1%B5%E5%AE%A2%E6%88%B7-id-%E5%92%8C%E5%90%8D%E7%A7%B0%E6%98%A0%E5%B0%84"><span class="toc-text">3.销售过程页客户 id 和名称映射</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-5"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-5"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#day4-%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-text">Day4 学了什么</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day5"><span class="toc-text">Day5</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">1.实现订单数据增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-6"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-6"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E8%AE%A2%E5%8D%95%E6%95%B0%E6%8D%AE%E5%A4%9A%E6%9D%A1%E4%BB%B6%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2"><span class="toc-text">2.实现订单数据多条件分页查询</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-7"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-7"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E6%8A%95%E8%AF%89%E9%A1%B5%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%98%BE%E7%A4%BA"><span class="toc-text">3.实现客户投诉页的基本显示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-8"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-8"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#day5-%E5%AD%A6%E4%BA%86%E4%BB%80%E4%B9%88"><span class="toc-text">Day5 学了什么</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day6"><span class="toc-text">Day6</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%A2%E6%88%B7%E6%8A%95%E8%AF%89%E9%A1%B5%E6%B7%BB%E5%8A%A0%E5%A4%84%E7%90%86%E6%93%8D%E4%BD%9C"><span class="toc-text">1.客户投诉页添加处理操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-9"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-9"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%8A%A0%E8%BD%BD%E9%97%AE%E9%A2%98%E5%9B%9E%E5%A4%8D%E5%88%97%E8%A1%A8"><span class="toc-text">2.加载问题回复列表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-10"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-10"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3rbac-%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6"><span class="toc-text">3.RBAC 权限控制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-11"><span class="toc-text">后端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day7"><span class="toc-text">Day7</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0%E7%BE%8E%E5%8C%96%E4%B8%BB%E9%A1%B5"><span class="toc-text">0.美化主页</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E6%8E%A5%E5%8F%A3%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7-postman-%E7%9A%84%E5%AE%89%E8%A3%85%E5%92%8C%E4%BD%BF%E7%94%A8"><span class="toc-text">1.接口测试工具 Postman 的安装和使用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%AE%9E%E7%8E%B0%E7%B3%BB%E7%BB%9F%E8%8F%9C%E5%8D%95%E8%8A%82%E7%82%B9%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2"><span class="toc-text">2 实现系统菜单节点管理页面</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-12"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-11"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0%E8%8F%9C%E5%8D%95%E6%8B%96%E6%8B%BD%E6%94%B9%E5%8F%98%E9%A1%BA%E5%BA%8F%E5%92%8C%E7%88%B6%E5%AD%90%E5%85%B3%E7%B3%BB"><span class="toc-text">3.实现菜单拖拽改变顺序和父子关系</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-13"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-12"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E5%AE%9E%E7%8E%B0%E4%B8%BB%E9%A1%B5%E8%8F%9C%E5%8D%95%E5%90%8C%E6%AD%A5%E4%BF%AE%E6%94%B9"><span class="toc-text">4.实现主页菜单同步修改</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E5%89%8D%E7%AB%AF%E4%BB%A3%E7%A0%81"><span class="toc-text">修改前端代码</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day8"><span class="toc-text">Day8</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#0%E5%AE%9E%E7%8E%B0%E5%90%8E%E7%AB%AF%E5%AD%98-icon%E5%89%8D%E7%AB%AF%E6%98%BE%E7%A4%BA"><span class="toc-text">0.实现后端存 icon，前端显示</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-14"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-13"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E8%A7%92%E8%89%B2%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">1.实现角色增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-15"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-14"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E8%A7%92%E8%89%B2%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86"><span class="toc-text">2.实现角色权限管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-16"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-15"><span class="toc-text">前端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day9"><span class="toc-text">Day9</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A1%A5%E5%85%A8%E6%98%A8%E5%A4%A9%E7%9A%84%E9%80%BB%E8%BE%91"><span class="toc-text">补全昨天的逻辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day10"><span class="toc-text">Day10</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E7%AE%A1%E7%90%86%E9%A1%B5"><span class="toc-text">1.实现用户管理页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-17"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-16"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E7%94%A8-echarts-%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93%E5%9B%BE%E8%A1%A8"><span class="toc-text">2.用 Echarts 组件渲染图表</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-17"><span class="toc-text">前端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day11"><span class="toc-text">Day11</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E7%B1%BB%E5%88%AB%E7%AE%A1%E7%90%86%E9%A1%B5"><span class="toc-text">1.实现商品类别管理页</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E7%8E%B0"><span class="toc-text">数据库实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-18"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-18"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text"></span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day12-14-%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF%E7%AE%A1%E7%90%86"><span class="toc-text">Day12-14 实现商品信息管理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AE%9E%E7%8E%B0-2"><span class="toc-text">数据库实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-19"><span class="toc-text">后端实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-text">实现文件上传</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%89%8D%E7%AB%AF%E5%AD%97%E5%85%B8%E6%8E%A5%E5%8F%A3"><span class="toc-text">实现前端字典接口</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E5%AF%B9-item-%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">实现对 item 的增删改查</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0%E9%87%87%E8%B4%AD%E5%8A%9F%E8%83%BD"><span class="toc-text">实现采购功能</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-19"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day15"><span class="toc-text">Day15</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E9%87%87%E8%B4%AD%E7%AE%A1%E7%90%86"><span class="toc-text">1.实现采购管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-20"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-20"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E5%85%A5%E5%BA%93%E7%AE%A1%E7%90%86"><span class="toc-text">2.实现商品入库管理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-21"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-21"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0%E8%A1%A8%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA"><span class="toc-text">3.实现表的导入导出</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-22"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-22"><span class="toc-text">前端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day16"><span class="toc-text">Day16</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E5%85%A5%E5%BA%93%E5%8D%95%E5%88%97%E8%A1%A8%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">1.实现入库单列表增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-23"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-23"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E5%95%86%E5%93%81%E4%BF%A1%E6%81%AF%E9%A1%B5%E7%9A%84%E5%87%BA%E5%BA%93%E5%8A%9F%E8%83%BD"><span class="toc-text">2.实现商品信息页的出库功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-24"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-24"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0%E5%87%BA%E5%BA%93%E5%8D%95%E5%88%86%E9%A1%B5%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%87%BA%E5%BA%93%E7%A1%AE%E8%AE%A4"><span class="toc-text">3.实现出库单分页查询和出库确认</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-25"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-25"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E5%AE%9E%E7%8E%B0%E4%BB%93%E5%BA%93%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="toc-text">4.实现仓库数据增删改查</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-26"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-26"><span class="toc-text">前端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day17"><span class="toc-text">Day17</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E5%AE%A2%E6%88%B7%E5%9C%B0%E5%8C%BA%E5%88%86%E5%B8%83%E7%BB%9F%E8%AE%A1"><span class="toc-text">1.实现客户地区分布统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-27"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-27"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E5%B9%B4-%E6%9C%88%E9%94%80%E5%94%AE%E7%BB%9F%E8%AE%A1"><span class="toc-text">2.实现年-月销售统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E5%B9%B4%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现(年统计)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E6%9C%88%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现(月统计)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E6%AE%B5%E5%AE%9E%E7%8E%B0"><span class="toc-text">前段实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day18"><span class="toc-text">Day18</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0%E5%91%98%E5%B7%A5%E4%BF%A1%E6%81%AF%E7%BB%9F%E8%AE%A1"><span class="toc-text">1.实现员工信息统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E5%B9%B4%E9%BE%84%E5%88%86%E5%B8%83%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现（年龄分布统计）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E5%AD%A6%E5%8E%86%E5%88%86%E5%B8%83%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现（学历分布统计）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-28"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E6%8A%95%E8%AF%89%E9%97%AE%E9%A2%98%E7%BB%9F%E8%AE%A1"><span class="toc-text">2.实现投诉问题统计</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E9%97%AE%E9%A2%98%E7%B1%BB%E5%9E%8B%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现（问题类型统计）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0%E9%97%AE%E9%A2%98%E7%8A%B6%E6%80%81%E7%BB%9F%E8%AE%A1"><span class="toc-text">后端实现（问题状态统计）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-29"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E5%AE%9E%E7%8E%B0%E7%BB%9F%E8%AE%A1-12-%E4%B8%AA%E6%9C%88%E9%94%80%E5%94%AE%E9%87%8F"><span class="toc-text">3.实现统计 12 个月销售量</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-28"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-30"><span class="toc-text">前端实现</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#day22"><span class="toc-text">Day22</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E5%AE%9E%E7%8E%B0-session-%E4%BC%9A%E8%AF%9D%E8%B7%9F%E8%B8%AA"><span class="toc-text">1.实现 session 会话跟踪</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-29"><span class="toc-text">后端实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E5%AE%9E%E7%8E%B0-31"><span class="toc-text">前端实现</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E5%AE%9E%E7%8E%B0%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95"><span class="toc-text">2.实现用户登录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E6%9F%A5%E8%AF%A2%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E7%94%A8%E6%88%B7%E8%8F%9C%E5%8D%95"><span class="toc-text">3 查询当前登录用户菜单</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E5%AE%9E%E7%8E%B0-30"><span class="toc-text">后端实现</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%82%E9%A1%B9"><span class="toc-text">杂项</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#0%E9%85%8D%E7%BD%AE%E7%BC%96%E8%BE%91%E5%99%A8%E6%8F%90%E5%8D%87%E7%BC%96%E7%A0%81%E4%BD%93%E9%AA%8C"><span class="toc-text">0.配置编辑器提升编码体验</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E4%BB%A3%E7%A0%81"><span class="toc-text">格式化代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%87%AA%E5%8A%A8%E5%AF%BC%E5%8C%85"><span class="toc-text">自动导包</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E6%96%87%E4%BB%B6%E6%90%9C%E7%B4%A2"><span class="toc-text">多文件搜索</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1%E5%B1%8F%E8%94%BD%E6%9F%90%E4%BA%9B%E4%B8%8D%E5%BD%B1%E5%93%8D%E7%A8%8B%E5%BA%8F%E7%9A%84%E8%AD%A6%E5%91%8A"><span class="toc-text">1.屏蔽某些不影响程序的警告</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF"><span class="toc-text">前端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%94%B9%E5%8F%98%E7%AA%97%E5%8F%A3%E5%A4%A7%E5%B0%8F%E6%97%B6%E5%BC%B9%E5%87%BA%E9%BB%91%E6%A1%86%E8%AD%A6%E5%91%8A"><span class="toc-text">改变窗口大小时弹出黑框警告</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B7%E5%BC%8F%E5%AE%9A%E4%B9%89%E9%94%99%E8%AF%AF%E8%AD%A6%E5%91%8A"><span class="toc-text">样式定义错误警告</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#invalid-prop-%E8%AD%A6%E5%91%8A"><span class="toc-text">Invalid prop 警告</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF"><span class="toc-text">后端</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%A3%E5%86%B3-mybatis-%E7%9A%84-mapper-%E6%96%87%E4%BB%B6%E4%B8%AD%E9%94%99%E8%AF%AF"><span class="toc-text">解决 mybatis 的 mapper 文件中错误</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E4%BC%98%E5%8C%96%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%AE%9A%E4%B9%89"><span class="toc-text">2.优化接口的定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%90%8E%E7%AB%AF%E4%BC%98%E5%8C%96"><span class="toc-text">后端优化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%89%8D%E7%AB%AF%E4%BC%98%E5%8C%96"><span class="toc-text">前端优化</span></a></li></ol></li></ol></li></ol></div><div class="widget-footer"><a class="top" onclick="util.scrollTop()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5"><path stroke-linejoin="round" d="m9 15.5l3-3l3 3m-6-4l3-3l3 3"/><path d="M7 3.338A9.95 9.95 0 0 1 12 2c5.523 0 10 4.477 10 10s-4.477 10-10 10S2 17.523 2 12c0-1.821.487-3.53 1.338-5"/></g></svg><span>回到顶部</span></a><a class="buttom" onclick="util.scrollComment()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="1.5" d="M8 10.5h8M8 14h5.5M17 3.338A9.95 9.95 0 0 0 12 2C6.477 2 2 6.477 2 12c0 1.6.376 3.112 1.043 4.453c.178.356.237.763.134 1.148l-.595 2.226a1.3 1.3 0 0 0 1.591 1.592l2.226-.596a1.63 1.63 0 0 1 1.149.133A9.96 9.96 0 0 0 12 22c5.523 0 10-4.477 10-10c0-1.821-.487-3.53-1.338-5"/></svg><span>参与讨论</span></a></div></widget></div></aside><div class="float-panel"><button type="button" style="display:none" class="laptop-only rightbar-toggle mobile" onclick="sidebar.rightbar()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6h11m-11 6h11m-11 6h11M4 6h1v4m-1 0h2m0 8H4c0-1 2-2 2-3s-1-1.5-2-1"/></svg></button> <button type="button" style="display:none" class="mobile-only leftbar-toggle mobile" onclick="sidebar.leftbar()"><svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="1.5"><path d="M2 11c0-3.771 0-5.657 1.172-6.828C4.343 3 6.229 3 10 3h4c3.771 0 5.657 0 6.828 1.172C22 5.343 22 7.229 22 11v2c0 3.771 0 5.657-1.172 6.828C19.657 21 17.771 21 14 21h-4c-3.771 0-5.657 0-6.828-1.172C2 18.657 2 16.771 2 13z"/><path id="sep" stroke-linecap="round" d="M5.5 10h6m-5 4h4m4.5 7V3"/></g></svg></button></div></div><div class="scripts"><script>window.canonical={originalHost:null,officialHosts:["localhost"],encoded:""};let ctx={date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前"},root:"/",tag_plugins:{chat:Object.assign({api:"https://siteinfo.listentothewind.cn/api/v1"})},search:{}};if((ctx.search.service="local_search")==ctx.search.service){let e=Object.assign({},'{"field":"all","path":"/search.json","content":true,"skip_search":null,"sort":"-date"}');ctx.search[ctx.search.service]=e}let def={avatar:"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/avatar/round/3442075.svg",cover:"https://gcore.jsdelivr.net/gh/cdn-x/placeholder@1.0.12/cover/76b86c0226ffd.svg",loading:"https://api.iconify.design/eos-icons:three-dots-loading.svg?color=%231cd0fd"},deps={jquery:"https://gcore.jsdelivr.net/npm/jquery@3.7/dist/jquery.min.js",marked:"https://gcore.jsdelivr.net/npm/marked@13.0/lib/marked.umd.min.js",lazyload:"/%5Bobject%20Object%5D"}</script><script>function RunItem(){function o(e,t){this.name=t||e.name,this.run=()=>{try{e()}catch(e){console.log(e)}}}this.list=[],this.start=()=>{for(var e=0;e<this.list.length;e++)this.list[e].run()},this.push=(e,t,r=!0)=>{let i=e,s=new o(i=r?()=>{utils.requestAnimationFrame(e)}:i,t);this.list.push(s)},this.remove=t=>{for(let e=0;e<this.list.length;e++)this.list[e].name==t&&this.list.splice(e,1)}}let utils={css:(e,t,r,i)=>{var s,o,a=window.document,n=a.createElement("link"),l=(o=t||(s=(a.body||a.getElementsByTagName("head")[0]).childNodes)[s.length-1],a.styleSheets);if(i)for(var d in i)i.hasOwnProperty(d)&&n.setAttribute(d,i[d]);n.rel="stylesheet",n.href=e,n.media="only x",function e(t){if(a.body)return t();setTimeout(function(){e(t)})}(function(){o.parentNode.insertBefore(n,t?o:o.nextSibling)});function u(e){for(var t=n.href,r=l.length;r--;)if(l[r].href===t)return e();setTimeout(function(){u(e)})}function h(){n.addEventListener&&n.removeEventListener("load",h),n.media=r||"all"}return n.addEventListener&&n.addEventListener("load",h),n.onloadcssdefined=u,u(h),n},js:(s,o)=>new Promise((t,e)=>{var r=document.createElement("script");if(s.startsWith("/")&&(s=ctx.root+s.substring(1)),r.src=s,o)for(var i of Object.keys(o))r[i]=o[i];else r.async=!0;r.onerror=e,r.onload=r.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(r.onload=r.onreadystatechange=null,t())},document.head.appendChild(r)}),jq:e=>{"undefined"==typeof jQuery?utils.js(deps.jquery).then(e):e()},onLoading:e=>{e&&$(e).append('<div class="loading-wrap"><svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" stroke-opacity=".3" d="M12 3C16.9706 3 21 7.02944 21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="1.3s" values="60;0"/></path><path stroke-dasharray="15" stroke-dashoffset="15" d="M12 3C16.9706 3 21 7.02944 21 12"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.3s" values="15;0"/><animateTransform attributeName="transform" dur="1.5s" repeatCount="indefinite" type="rotate" values="0 12 12;360 12 12"/></path></g></svg></div>')},onLoadSuccess:e=>{e&&$(e).find(".loading-wrap").remove()},onLoadFailure:e=>{e&&($(e).find(".loading-wrap svg").remove(),$(e).find(".loading-wrap").append('<svg xmlns="http://www.w3.org/2000/svg" width="2em" height="2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path stroke-dasharray="60" stroke-dashoffset="60" d="M12 3L21 20H3L12 3Z"><animate fill="freeze" attributeName="stroke-dashoffset" dur="0.5s" values="60;0"/></path><path stroke-dasharray="6" stroke-dashoffset="6" d="M12 10V14"><animate fill="freeze" attributeName="stroke-dashoffset" begin="0.6s" dur="0.2s" values="6;0"/></path></g><circle cx="12" cy="17" r="1" fill="currentColor" fill-opacity="0"><animate fill="freeze" attributeName="fill-opacity" begin="0.8s" dur="0.4s" values="0;1"/></circle></svg>'),$(e).find(".loading-wrap").addClass("error"))},request:(a,e,n,l)=>{let d=0;return new Promise((i,s)=>{let o=()=>{utils.onLoading?.(a);let t=!1,r=setTimeout(()=>{t=!0,console.warn("[request] 超时:",e),3<=++d?(utils.onLoadFailure?.(a),l?.(),s("请求超时")):setTimeout(o,1e3)},5e3);fetch(e).then(e=>{if(!t){if(clearTimeout(r),e.ok)return e;throw new Error("响应失败")}}).then(e=>{t||(utils.onLoadSuccess?.(a),n(e),i(e))}).catch(e=>{clearTimeout(r),console.warn("[request] 错误:",e),3<=++d?(utils.onLoadFailure?.(a),l?.(),s(e)):setTimeout(o,1e3)})};o()})},requestWithoutLoading:(e,a={},n=2,l=5e3)=>new Promise((r,i)=>{let s=0,o=()=>{let t=setTimeout(()=>{++s>n?i("timeout"):o()},l);fetch(e,a).then(e=>{if(clearTimeout(t),!e.ok)throw new Error("bad response");r(e)}).catch(e=>{clearTimeout(t),++s>n?i(e):setTimeout(o,500)})};o()}),requestAnimationFrame:e=>{window.requestAnimationFrame||(window.requestAnimationFrame=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame),window.requestAnimationFrame(e)},dark:{}};utils.dark.method={toggle:new RunItem},utils.dark=Object.assign(utils.dark,{push:utils.dark.method.toggle.push})</script><script>let sidebar={leftbar:()=>{l_body&&(l_body.toggleAttribute("leftbar"),l_body.removeAttribute("rightbar"))},rightbar:()=>{l_body&&(l_body.toggleAttribute("rightbar"),l_body.removeAttribute("leftbar"))},dismiss:()=>{l_body&&(l_body.removeAttribute("leftbar"),l_body.removeAttribute("rightbar"))},toggleTOC:()=>{document.querySelector("#data-toc").classList.toggle("collapse")}}</script><script>(()=>{var e;for(e of document.querySelectorAll(".tag-subtree.parent-tag > a > .tag-switcher-wrapper"))e.addEventListener("click",e=>{e.target.closest(".tag-subtree.parent-tag").classList.toggle("expanded"),e.preventDefault()});var t=new URLSearchParams(window.location.search).get("tag");if(t){let e=document.querySelector(`.tag-subtree[data-tag="${t}"]`);if(e)for(e.querySelector("a").classList.add("active");e;)e.classList.add("expanded"),e=e.parentElement.closest(".tag-subtree.parent-tag")}})()</script><script async src="https://gcore.jsdelivr.net/npm/vanilla-lazyload@19.1/dist/lazyload.min.js"></script><script>window.lazyLoadOptions={elements_selector:".lazy",callback_loaded:e=>{e.classList.add("loaded");e=e.closest(".lazy-box")?.querySelector(".lazy-icon");e&&e.remove()}},window.addEventListener("LazyLoad::Initialized",function(e){window.lazyLoadInstance=e.detail.instance},!1),document.addEventListener("DOMContentLoaded",function(){window.lazyLoadInstance?.update()}),window.wrapLazyloadImages=e=>{(e="string"==typeof e?document.querySelector(e):e)&&(e.querySelectorAll("img").forEach(e=>{var a,t,d;e.classList.contains("lazy")||(d=e.getAttribute("src"))&&((a=document.createElement("div")).className="lazy-box",(t=e.cloneNode()).removeAttribute("src"),t.setAttribute("data-src",d),t.classList.add("lazy"),(d=document.createElement("div")).className="lazy-icon",def.loading&&(d.style.backgroundImage=`url("${def.loading}")`),a.appendChild(t),a.appendChild(d),e.replaceWith(a))}),window.lazyLoadInstance?.update)&&window.lazyLoadInstance.update()}</script><script src="/js/main.js?v=1.33.1" defer></script><script>let applyTheme=e=>{"auto"===e?document.documentElement.removeAttribute("data-theme"):document.documentElement.setAttribute("data-theme",e)},applyThemeToGiscus=e=>{var t=document.getElementById("giscus"),t=(t&&t.setAttribute("data-theme",e),document.querySelector("#comments > section.giscus > iframe"));t&&(e=t.src.replace(/theme=[\w]+/,"theme="+e),t.src=e)},switchTheme=()=>{let e;switch(document.documentElement.getAttribute("data-theme")){case"light":e="dark";break;case"dark":e="auto";break;default:e="light"}applyTheme(e),window.localStorage.setItem("Stellar.theme",e),utils.dark.mode="auto"===e?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":e,utils.dark.method.toggle.start(),hud?.toast?.({light:"切换到浅色模式",dark:"切换到深色模式",auto:"切换到跟随系统配色"}[e])};(()=>{var e=window.localStorage.getItem("Stellar.theme");null!==e?applyTheme(e):utils.dark.mode=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",utils.dark.method.toggle.start()})()</script><script type="module">const el = document.querySelector('#comments #giscus');
  util.viewportLazyload(el, load_discus, false);

  function load_discus() {
    if (!el) return;
    try {
        el.innerHTML = '';
      } catch (error) {
        console.error(error);
      }
      const script = document.createElement('script');
      script.async = true;
      for (const key of Object.keys(el.attributes)) {
        const attr = el.attributes[key];
        if (['class', 'id'].includes(attr.name) === false) {
          script.setAttribute(attr.name, attr.value);
        }
      }
      el.appendChild(script);
  }</script><script defer>window.addEventListener("DOMContentLoaded",e=>{ctx.services=Object.assign({},JSON.parse('{"mdrender":{"js":"/js/services/mdrender.js"},"siteinfo":{"js":"/js/services/siteinfo.js","api":null},"ghinfo":{"js":"/js/services/ghinfo.js"},"rating":{"js":"/js/services/rating.js","api":"https://star-vote.xaox.cc/api/rating"},"vote":{"js":"/js/services/vote.js","api":"https://star-vote.xaox.cc/api/vote"},"sites":{"js":"/js/services/sites.js"},"friends":{"js":"/js/services/friends.js"},"friends_and_posts":{"js":"/js/services/friends_and_posts.js"},"timeline":{"js":"/js/services/timeline.js"},"fcircle":{"js":"/js/services/fcircle.js"},"weibo":{"js":"/js/services/weibo.js"},"memos":{"js":"/js/services/memos.js"},"voice":{"js":"/js/plugins/voice.js"},"video":{"js":"/js/plugins/video.js"},"download-file":{"js":"/js/plugins/download-file.js"},"twikoo":{"js":"/js/services/twikoo_latest_comment.js"},"waline":{"js":"/js/services/waline_latest_comment.js"},"artalk":{"js":"/js/services/artalk_latest_comment.js"},"giscus":{"js":"/js/services/giscus_latest_comment.js"},"contributors":{"edit_this_page":{"_posts/":null,"wiki/stellar/":"https://github.com/xaoxuu/hexo-theme-stellar-docs/blob/main/"},"js":"/js/services/contributors.js"}}'));for(let s of Object.keys(ctx.services)){let e=ctx.services[s].js;"siteinfo"==s?(ctx.cardlinks=document.querySelectorAll("a.link-card[cardlink]"),0<ctx.cardlinks?.length&&utils.js(e,{defer:!0}).then(function(){setCardLink(ctx.cardlinks)})):"voice"==s?(ctx.voiceAudios=document.querySelectorAll(".voice>audio"),0<ctx.voiceAudios?.length&&utils.js(e,{defer:!0}).then(function(){createVoiceDom(ctx.voiceAudios)})):"video"==s?(ctx.videos=document.querySelectorAll(".video>video"),0<ctx.videos?.length&&utils.js(e,{defer:!0}).then(function(){videoEvents(ctx.videos)})):"download-file"==s?(ctx.files=document.querySelectorAll(".file"),0<ctx.files?.length&&utils.js(e,{defer:!0}).then(function(){downloadFileEvent(ctx.files)})):0<document.getElementsByClassName("ds-"+s)?.length&&utils.jq(()=>{s,utils.js(deps.marked).then(function(){utils.js(e,{defer:!0})})})}let o=document.querySelectorAll(".chat .status-bar .time");var s,t;function i(){for(let e=0;e<o.length;++e){var s=o[e],t=new Date,i=t.getHours(),t=t.getMinutes();s.innerHTML=n(i)+":"+n(t)}}function n(e){return e<10?"0"+e:e}0<o.length&&(i(),s=(new Date).getSeconds(),t=setInterval(function(){i(),clearInterval(t),setInterval(i,6e4)},1e3*(60-s)));let c=new IntersectionObserver((e,t)=>{e.filter(e=>e.isIntersecting).sort((e,s)=>e.intersectionRect.y!==s.intersectionRect.y?e.intersectionRect.y-s.intersectionRect.y:e.intersectionRect.x-s.intersectionRect.x).forEach((e,s)=>{t.unobserve(e.target),setTimeout(()=>{e.target.classList.add("quote-blink"),setTimeout(()=>{e.target.classList.remove("quote-blink")},1e3)},Math.max(100,16)*(s+1))})}),r=document.querySelectorAll(".chat .talk .quote");r.forEach(i=>{i.addEventListener("click",function(){var e,s,t=document.getElementById("quote-"+i.getAttribute("quotedCellTag"));t&&(s=(e=t.parentElement).clientHeight/2,t.offsetTop>s-t.clientHeight/2?e.scrollTo({top:t.offsetTop-s+t.clientHeight/2,behavior:"smooth"}):e.scrollTo({top:0,behavior:"smooth"}),c.observe(t))})})})</script><script>window.addEventListener("DOMContentLoaded",e=>{ctx.search={path:"/search.json"},utils.js("/js/search/local-search.js",{defer:!0})})</script><script>window.FPConfig={delay:0,ignoreKeywords:[],maxRPS:5,hoverDelay:25}</script><script defer src="https://gcore.jsdelivr.net/npm/flying-pages@2/flying-pages.min.js"></script><script>ctx.fancybox={selector:'.md-text img[alt]:not([alt="icon"]):not([alt="cover"])',css:"https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.css",js:"https://gcore.jsdelivr.net/npm/@fancyapps/ui@5.0/dist/fancybox/fancybox.umd.js"};var selector="[data-fancybox]:not(.error), .with-fancybox .atk-content img:not([atk-emoticon])",needFancybox=(ctx.fancybox.selector&&(selector+=", "+ctx.fancybox.selector),0!==document.querySelectorAll(selector).length);if(!needFancybox){let t=document.getElementsByClassName("ds-memos"),e=(null!=t&&0<t.length&&(needFancybox=!0),document.getElementsByClassName("with-fancybox"));null!=e&&0<e.length&&(needFancybox=!0)}needFancybox&&(utils.css(ctx.fancybox.css),utils.js(ctx.fancybox.js,{defer:!0}).then(function(){Fancybox.bind(selector,{hideScrollbar:!1,Thumbs:{autoStart:!1},caption:(t,e)=>e.triggerEl.alt||e.triggerEl.dataset.caption||null})}))</script><script>window.addEventListener("DOMContentLoaded",e=>{let t=document.getElementById("swiper-api");null!=t&&(utils.css("https://unpkg.com/swiper@10.3/swiper-bundle.min.css"),utils.js("https://unpkg.com/swiper@10.3/swiper-bundle.min.js",{defer:!0}).then(function(){var e=t.getAttribute("effect")||"";new Swiper(".swiper#swiper-api",{slidesPerView:"auto",spaceBetween:8,centeredSlides:!0,effect:e,rewind:!0,pagination:{el:".swiper-pagination",clickable:!0},navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}})}))})</script><link rel="stylesheet" href="https://gcore.jsdelivr.net/npm/katex@0.16/dist/katex.min.css"><script defer src="https://gcore.jsdelivr.net/npm/mermaid@v9/dist/mermaid.min.js"></script><script>window.addEventListener("DOMContentLoaded",e=>{var a={startOnLoad:!0,theme:window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"neutral",logLevel:3,themeVariables:{darkMode:!0},flowchart:{useMaxWidth:!1,htmlLabels:!0,curve:"linear"},gantt:{axisFormat:"%Y/%m/%d"},sequence:{actorMargin:50}};mermaid.initialize(a)})</script><script>document.addEventListener("DOMContentLoaded",function(){window.codeElements=document.querySelectorAll(".code"),0<window.codeElements.length&&(ctx.copycode={default_text:"Copy",success_text:"Copied",toast:"复制成功"},utils.js("/js/plugins/copycode.js"))})</script><script>var _hmt=_hmt||[];(()=>{var e=document.createElement("script"),t=(e.src="https://hm.baidu.com/hm.js?b5a2afc20b06445af155f3af37777902",document.getElementsByTagName("script")[0]);t.parentNode.insertBefore(e,t)})()</script><script>((e,t,n,r,a,c)=>{e[n]=e[n]||function(){(e[n].q=e[n].q||[]).push(arguments)},(a=t.createElement(r)).async=1,a.src="https://www.clarity.ms/tag/rp0i6z4yyg",(c=t.getElementsByTagName(r)[0]).parentNode.insertBefore(a,c)})(window,document,"clarity","script")</script></div>
        <style>
            [bg-lazy] {
                background-image: none !important;
                background-color: #eee !important;
            }
        </style>
        <script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                preloadRatio: 3,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z\d\-\.\+]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(t.test(e.href)||r.test(e.href))&&(e.href=a.dataset.original)})});</script><script>(r=>{r.imageLazyLoadSetting.processImages=t;var a=r.imageLazyLoadSetting.isSPA,o=r.imageLazyLoadSetting.preloadRatio||1,d=i();function i(){var t=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")),e=Array.prototype.slice.call(document.querySelectorAll("[bg-lazy]"));return t.concat(e)}function t(t){(a||t)&&(d=i());for(var e,n=0;n<d.length;n++)0<=(e=(e=d[n]).getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(r.innerHeight*o||document.documentElement.clientHeight*o)&&(()=>{var t,e,a,o,i=d[n];e=function(){d=d.filter(function(t){return i!==t}),r.imageLazyLoadSetting.onImageLoaded&&r.imageLazyLoadSetting.onImageLoaded(i)},(t=i).dataset.loaded||(t.hasAttribute("bg-lazy")?(t.removeAttribute("bg-lazy"),e&&e()):(a=new Image,o=t.getAttribute("data-original"),a.onload=function(){t.src=o,t.removeAttribute("data-original"),t.setAttribute("data-loaded",!0),e&&e()},a.onerror=function(){t.removeAttribute("data-original"),t.setAttribute("data-loaded",!1),t.src=o},t.src!==o&&(a.src=o)))})()}function e(){clearTimeout(t.tId),t.tId=setTimeout(t,500)}t(),document.addEventListener("scroll",e),r.addEventListener("resize",e),r.addEventListener("orientationchange",e)})(this);</script></body></html>